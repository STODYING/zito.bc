(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();class Td{routes={};defaultRoute=null;addRoute(e,t){this.routes[e]=t}setDefault(e){this.defaultRoute=e}navigate(e){window.history.pushState({},"",e),this.handleRoute()}handleRoute(){const e=window.location.pathname,t=this.routes[e];t?t():this.defaultRoute&&this.defaultRoute()}init(){this.handleRoute(),window.addEventListener("popstate",()=>{this.handleRoute()}),document.addEventListener("click",e=>{const s=e.target.closest("a[data-link]");if(s){e.preventDefault();const r=s.getAttribute("href");r&&this.navigate(r)}})}}const ue=new Td;class xd{state={user:null,userData:null,isLoading:!0,isLoggedIn:!1};listeners=[];getState(){return{...this.state}}setState(e){this.state={...this.state,...e},this.notify()}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}notify(){this.listeners.forEach(e=>e(this.state))}}const Ne=new xd,Ad=()=>{};var Ha={};const _l=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Rd=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const o=n[t++];e[s++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){const o=n[t++],a=n[t++],l=n[t++],h=((r&7)<<18|(o&63)<<12|(a&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(h>>10)),e[s++]=String.fromCharCode(56320+(h&1023))}else{const o=n[t++],a=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(o&63)<<6|a&63)}}return e.join("")},vl={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const o=n[r],a=r+1<n.length,l=a?n[r+1]:0,h=r+2<n.length,d=h?n[r+2]:0,p=o>>2,_=(o&3)<<4|l>>4;let E=(l&15)<<2|d>>6,A=d&63;h||(A=64,a||(E=64)),s.push(t[p],t[_],t[E],t[A])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(_l(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Rd(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const o=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const d=r<n.length?t[n.charAt(r)]:64;++r;const _=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||l==null||d==null||_==null)throw new Sd;const E=o<<2|l>>4;if(s.push(E),d!==64){const A=l<<4&240|d>>2;if(s.push(A),_!==64){const C=d<<6&192|_;s.push(C)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Sd extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Pd=function(n){const e=_l(n);return vl.encodeByteArray(e,!0)},Xs=function(n){return Pd(n).replace(/\./g,"")},bl=function(n){try{return vl.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Cd(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const kd=()=>Cd().__FIREBASE_DEFAULTS__,Vd=()=>{if(typeof process>"u"||typeof Ha>"u")return;const n=Ha.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Dd=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&bl(n[1]);return e&&JSON.parse(e)},gr=()=>{try{return Ad()||kd()||Vd()||Dd()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},El=n=>gr()?.emulatorHosts?.[n],Nd=n=>{const e=El(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},wl=()=>gr()?.config,Il=n=>gr()?.[`_${n}`];class Od{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}function mn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Tl(n){return(await fetch(n,{credentials:"include"})).ok}function Ld(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",r=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Xs(JSON.stringify(t)),Xs(JSON.stringify(a)),""].join(".")}const Hn={};function Md(){const n={prod:[],emulator:[]};for(const e of Object.keys(Hn))Hn[e]?n.emulator.push(e):n.prod.push(e);return n}function Fd(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Wa=!1;function xl(n,e){if(typeof window>"u"||typeof document>"u"||!mn(window.location.host)||Hn[n]===e||Hn[n]||Wa)return;Hn[n]=e;function t(E){return`__firebase__banner__${E}`}const s="__firebase__banner",o=Md().prod.length>0;function a(){const E=document.getElementById(s);E&&E.remove()}function l(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function h(E,A){E.setAttribute("width","24"),E.setAttribute("id",A),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function d(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{Wa=!0,a()},E}function p(E,A){E.setAttribute("id",A),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function _(){const E=Fd(s),A=t("text"),C=document.getElementById(A)||document.createElement("span"),D=t("learnmore"),k=document.getElementById(D)||document.createElement("a"),O=t("preprendIcon"),z=document.getElementById(O)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const W=E.element;l(W),p(k,D);const Ee=d();h(z,O),W.append(z,C,k,Ee),document.body.appendChild(W)}o?(C.innerText="Preview backend disconnected.",z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}function ve(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ud(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ve())}function Bd(){const n=gr()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function zd(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function jd(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function qd(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $d(){const n=ve();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Hd(){return!Bd()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Wd(){try{return typeof indexedDB=="object"}catch{return!1}}function Gd(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const Kd="FirebaseError";class st extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=Kd,Object.setPrototypeOf(this,st.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,us.prototype.create)}}class us{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],a=o?Qd(o,s):"Error",l=`${this.serviceName}: ${a} (${r}).`;return new st(r,l,s)}}function Qd(n,e){return n.replace(Jd,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const Jd=/\{\$([^}]+)}/g;function Xd(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function zt(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const o=n[r],a=e[r];if(Ga(o)&&Ga(a)){if(!zt(o,a))return!1}else if(o!==a)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function Ga(n){return n!==null&&typeof n=="object"}function hs(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Un(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,o]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(o)}}),e}function Bn(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Yd(n,e){const t=new Zd(n,e);return t.subscribe.bind(t)}class Zd{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let r;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");ef(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:s},r.next===void 0&&(r.next=ci),r.error===void 0&&(r.error=ci),r.complete===void 0&&(r.complete=ci);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ef(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ci(){}function be(n){return n&&n._delegate?n._delegate:n}class jt{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Mt="[DEFAULT]";class tf{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new Od;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sf(e))try{this.getOrInitializeService({instanceIdentifier:Mt})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:r});s.resolve(o)}catch{}}}}clearInstance(e=Mt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Mt){return this.instances.has(e)}getOptions(e=Mt){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[o,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);s===l&&a.resolve(r)}return r}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const o=this.instances.get(s);return o&&e(o,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:nf(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Mt){return this.component?this.component.multipleInstances?e:Mt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function nf(n){return n===Mt?void 0:n}function sf(n){return n.instantiationMode==="EAGER"}class rf{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new tf(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var q;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(q||(q={}));const of={debug:q.DEBUG,verbose:q.VERBOSE,info:q.INFO,warn:q.WARN,error:q.ERROR,silent:q.SILENT},af=q.INFO,cf={[q.DEBUG]:"log",[q.VERBOSE]:"log",[q.INFO]:"info",[q.WARN]:"warn",[q.ERROR]:"error"},lf=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=cf[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Gi{constructor(e){this.name=e,this._logLevel=af,this._logHandler=lf,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in q))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?of[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,q.DEBUG,...e),this._logHandler(this,q.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,q.VERBOSE,...e),this._logHandler(this,q.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,q.INFO,...e),this._logHandler(this,q.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,q.WARN,...e),this._logHandler(this,q.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,q.ERROR,...e),this._logHandler(this,q.ERROR,...e)}}const uf=(n,e)=>e.some(t=>n instanceof t);let Ka,Qa;function hf(){return Ka||(Ka=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function df(){return Qa||(Qa=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Al=new WeakMap,Ei=new WeakMap,Rl=new WeakMap,li=new WeakMap,Ki=new WeakMap;function ff(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(mt(n.result)),r()},a=()=>{s(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Al.set(t,n)}).catch(()=>{}),Ki.set(e,n),e}function pf(n){if(Ei.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),r()},a=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});Ei.set(n,e)}let wi={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ei.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Rl.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return mt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function mf(n){wi=n(wi)}function gf(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(ui(this),e,...t);return Rl.set(s,e.sort?e.sort():[e]),mt(s)}:df().includes(n)?function(...e){return n.apply(ui(this),e),mt(Al.get(this))}:function(...e){return mt(n.apply(ui(this),e))}}function yf(n){return typeof n=="function"?gf(n):(n instanceof IDBTransaction&&pf(n),uf(n,hf())?new Proxy(n,wi):n)}function mt(n){if(n instanceof IDBRequest)return ff(n);if(li.has(n))return li.get(n);const e=yf(n);return e!==n&&(li.set(n,e),Ki.set(e,n)),e}const ui=n=>Ki.get(n);function _f(n,e,{blocked:t,upgrade:s,blocking:r,terminated:o}={}){const a=indexedDB.open(n,e),l=mt(a);return s&&a.addEventListener("upgradeneeded",h=>{s(mt(a.result),h.oldVersion,h.newVersion,mt(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),l.then(h=>{o&&h.addEventListener("close",()=>o()),r&&h.addEventListener("versionchange",d=>r(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const vf=["get","getKey","getAll","getAllKeys","count"],bf=["put","add","delete","clear"],hi=new Map;function Ja(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(hi.get(e))return hi.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=bf.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||vf.includes(t)))return;const o=async function(a,...l){const h=this.transaction(a,r?"readwrite":"readonly");let d=h.store;return s&&(d=d.index(l.shift())),(await Promise.all([d[t](...l),r&&h.done]))[0]};return hi.set(e,o),o}mf(n=>({...n,get:(e,t,s)=>Ja(e,t)||n.get(e,t,s),has:(e,t)=>!!Ja(e,t)||n.has(e,t)}));class Ef{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(wf(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function wf(n){return n.getComponent()?.type==="VERSION"}const Ii="@firebase/app",Xa="0.14.6";const Ye=new Gi("@firebase/app"),If="@firebase/app-compat",Tf="@firebase/analytics-compat",xf="@firebase/analytics",Af="@firebase/app-check-compat",Rf="@firebase/app-check",Sf="@firebase/auth",Pf="@firebase/auth-compat",Cf="@firebase/database",kf="@firebase/data-connect",Vf="@firebase/database-compat",Df="@firebase/functions",Nf="@firebase/functions-compat",Of="@firebase/installations",Lf="@firebase/installations-compat",Mf="@firebase/messaging",Ff="@firebase/messaging-compat",Uf="@firebase/performance",Bf="@firebase/performance-compat",zf="@firebase/remote-config",jf="@firebase/remote-config-compat",qf="@firebase/storage",$f="@firebase/storage-compat",Hf="@firebase/firestore",Wf="@firebase/ai",Gf="@firebase/firestore-compat",Kf="firebase",Qf="12.6.0";const Ti="[DEFAULT]",Jf={[Ii]:"fire-core",[If]:"fire-core-compat",[xf]:"fire-analytics",[Tf]:"fire-analytics-compat",[Rf]:"fire-app-check",[Af]:"fire-app-check-compat",[Sf]:"fire-auth",[Pf]:"fire-auth-compat",[Cf]:"fire-rtdb",[kf]:"fire-data-connect",[Vf]:"fire-rtdb-compat",[Df]:"fire-fn",[Nf]:"fire-fn-compat",[Of]:"fire-iid",[Lf]:"fire-iid-compat",[Mf]:"fire-fcm",[Ff]:"fire-fcm-compat",[Uf]:"fire-perf",[Bf]:"fire-perf-compat",[zf]:"fire-rc",[jf]:"fire-rc-compat",[qf]:"fire-gcs",[$f]:"fire-gcs-compat",[Hf]:"fire-fst",[Gf]:"fire-fst-compat",[Wf]:"fire-vertex","fire-js":"fire-js",[Kf]:"fire-js-all"};const Ys=new Map,Xf=new Map,xi=new Map;function Ya(n,e){try{n.container.addComponent(e)}catch(t){Ye.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function cn(n){const e=n.name;if(xi.has(e))return Ye.debug(`There were multiple attempts to register component ${e}.`),!1;xi.set(e,n);for(const t of Ys.values())Ya(t,n);for(const t of Xf.values())Ya(t,n);return!0}function Qi(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Pe(n){return n==null?!1:n.settings!==void 0}const Yf={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},gt=new us("app","Firebase",Yf);class Zf{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new jt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw gt.create("app-deleted",{appName:this._name})}}const gn=Qf;function Sl(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:Ti,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw gt.create("bad-app-name",{appName:String(r)});if(t||(t=wl()),!t)throw gt.create("no-options");const o=Ys.get(r);if(o){if(zt(t,o.options)&&zt(s,o.config))return o;throw gt.create("duplicate-app",{appName:r})}const a=new rf(r);for(const h of xi.values())a.addComponent(h);const l=new Zf(t,s,a);return Ys.set(r,l),l}function Pl(n=Ti){const e=Ys.get(n);if(!e&&n===Ti&&wl())return Sl();if(!e)throw gt.create("no-app",{appName:n});return e}function yt(n,e,t){let s=Jf[n]??n;t&&(s+=`-${t}`);const r=s.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const a=[`Unable to register library "${s}" with version "${e}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ye.warn(a.join(" "));return}cn(new jt(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const ep="firebase-heartbeat-database",tp=1,Zn="firebase-heartbeat-store";let di=null;function Cl(){return di||(di=_f(ep,tp,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Zn)}catch(t){console.warn(t)}}}}).catch(n=>{throw gt.create("idb-open",{originalErrorMessage:n.message})})),di}async function np(n){try{const t=(await Cl()).transaction(Zn),s=await t.objectStore(Zn).get(kl(n));return await t.done,s}catch(e){if(e instanceof st)Ye.warn(e.message);else{const t=gt.create("idb-get",{originalErrorMessage:e?.message});Ye.warn(t.message)}}}async function Za(n,e){try{const s=(await Cl()).transaction(Zn,"readwrite");await s.objectStore(Zn).put(e,kl(n)),await s.done}catch(t){if(t instanceof st)Ye.warn(t.message);else{const s=gt.create("idb-set",{originalErrorMessage:t?.message});Ye.warn(s.message)}}}function kl(n){return`${n.name}!${n.options.appId}`}const sp=1024,rp=30;class ip{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ap(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=ec();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:t}),this._heartbeatsCache.heartbeats.length>rp){const r=cp(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ye.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=ec(),{heartbeatsToSend:t,unsentEntries:s}=op(this._heartbeatsCache.heartbeats),r=Xs(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Ye.warn(e),""}}}function ec(){return new Date().toISOString().substring(0,10)}function op(n,e=sp){const t=[];let s=n.slice();for(const r of n){const o=t.find(a=>a.agent===r.agent);if(o){if(o.dates.push(r.date),tc(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),tc(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class ap{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Wd()?Gd().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await np(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Za(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Za(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function tc(n){return Xs(JSON.stringify({version:2,heartbeats:n})).length}function cp(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}function lp(n){cn(new jt("platform-logger",e=>new Ef(e),"PRIVATE")),cn(new jt("heartbeat",e=>new ip(e),"PRIVATE")),yt(Ii,Xa,n),yt(Ii,Xa,"esm2020"),yt("fire-js","")}lp("");var up="firebase",hp="12.7.0";yt(up,hp,"app");function Vl(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const dp=Vl,Dl=new us("auth","Firebase",Vl());const Zs=new Gi("@firebase/auth");function fp(n,...e){Zs.logLevel<=q.WARN&&Zs.warn(`Auth (${gn}): ${n}`,...e)}function zs(n,...e){Zs.logLevel<=q.ERROR&&Zs.error(`Auth (${gn}): ${n}`,...e)}function Ve(n,...e){throw Xi(n,...e)}function Oe(n,...e){return Xi(n,...e)}function Ji(n,e,t){const s={...dp(),[e]:t};return new us("auth","Firebase",s).create(e,{appName:n.name})}function Xe(n){return Ji(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pp(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Ve(n,"argument-error"),Ji(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Xi(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return Dl.create(n,...e)}function M(n,e,...t){if(!n)throw Xi(e,...t)}function Qe(n){const e="INTERNAL ASSERTION FAILED: "+n;throw zs(e),new Error(e)}function Ze(n,e){n||Qe(e)}function Ai(){return typeof self<"u"&&self.location?.href||""}function mp(){return nc()==="http:"||nc()==="https:"}function nc(){return typeof self<"u"&&self.location?.protocol||null}function gp(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(mp()||jd()||"connection"in navigator)?navigator.onLine:!0}function yp(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class ds{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ze(t>e,"Short delay should be less than long delay!"),this.isMobile=Ud()||qd()}get(){return gp()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Yi(n,e){Ze(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Nl{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Qe("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Qe("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Qe("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const _p={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const vp=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bp=new ds(3e4,6e4);function At(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Rt(n,e,t,s,r={}){return Ol(n,r,async()=>{let o={},a={};s&&(e==="GET"?a=s:o={body:JSON.stringify(s)});const l=hs({key:n.config.apiKey,...a}).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:h,...o};return zd()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&mn(n.emulatorConfig.host)&&(d.credentials="include"),Nl.fetch()(await Ll(n,n.config.apiHost,t,l),d)})}async function Ol(n,e,t){n._canInitEmulator=!1;const s={..._p,...e};try{const r=new wp(n),o=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw Os(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const l=o.ok?a.errorMessage:a.error.message,[h,d]=l.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Os(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw Os(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw Os(n,"user-disabled",a);const p=s[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Ji(n,p,d);Ve(n,p)}}catch(r){if(r instanceof st)throw r;Ve(n,"network-request-failed",{message:String(r)})}}async function fs(n,e,t,s,r={}){const o=await Rt(n,e,t,s,r);return"mfaPendingCredential"in o&&Ve(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function Ll(n,e,t,s){const r=`${e}${t}?${s}`,o=n,a=o.config.emulator?Yi(n.config,r):`${n.config.apiScheme}://${r}`;return vp.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}function Ep(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class wp{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(Oe(this.auth,"network-request-failed")),bp.get())})}}function Os(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const r=Oe(n,e,s);return r.customData._tokenResponse=t,r}function sc(n){return n!==void 0&&n.enterprise!==void 0}class Ip{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Ep(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Tp(n,e){return Rt(n,"GET","/v2/recaptchaConfig",At(n,e))}async function xp(n,e){return Rt(n,"POST","/v1/accounts:delete",e)}async function er(n,e){return Rt(n,"POST","/v1/accounts:lookup",e)}function Wn(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ap(n,e=!1){const t=be(n),s=await t.getIdToken(e),r=Zi(s);M(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const o=typeof r.firebase=="object"?r.firebase:void 0,a=o?.sign_in_provider;return{claims:r,token:s,authTime:Wn(fi(r.auth_time)),issuedAtTime:Wn(fi(r.iat)),expirationTime:Wn(fi(r.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}function fi(n){return Number(n)*1e3}function Zi(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return zs("JWT malformed, contained fewer than 3 sections"),null;try{const r=bl(t);return r?JSON.parse(r):(zs("Failed to decode base64 JWT payload"),null)}catch(r){return zs("Caught error parsing JWT payload as JSON",r?.toString()),null}}function rc(n){const e=Zi(n);return M(e,"internal-error"),M(typeof e.exp<"u","internal-error"),M(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function es(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof st&&Rp(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function Rp({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Sp{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ri{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wn(this.lastLoginAt),this.creationTime=Wn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function tr(n){const e=n.auth,t=await n.getIdToken(),s=await es(n,er(e,{idToken:t}));M(s?.users.length,e,"internal-error");const r=s.users[0];n._notifyReloadListener(r);const o=r.providerUserInfo?.length?Ml(r.providerUserInfo):[],a=Cp(n.providerData,o),l=n.isAnonymous,h=!(n.email&&r.passwordHash)&&!a?.length,d=l?h:!1,p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Ri(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(n,p)}async function Pp(n){const e=be(n);await tr(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Cp(n,e){return[...n.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function Ml(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function kp(n,e){const t=await Ol(n,{},async()=>{const s=hs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,a=await Ll(n,r,"/v1/token",`key=${o}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:l,body:s};return n.emulatorConfig&&mn(n.emulatorConfig.host)&&(h.credentials="include"),Nl.fetch()(a,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Vp(n,e){return Rt(n,"POST","/v2/accounts:revokeToken",At(n,e))}class sn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){M(e.idToken,"internal-error"),M(typeof e.idToken<"u","internal-error"),M(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):rc(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){M(e.length!==0,"internal-error");const t=rc(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(M(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:r,expiresIn:o}=await kp(e,t);this.updateTokensAndExpiration(s,r,Number(o))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:r,expirationTime:o}=t,a=new sn;return s&&(M(typeof s=="string","internal-error",{appName:e}),a.refreshToken=s),r&&(M(typeof r=="string","internal-error",{appName:e}),a.accessToken=r),o&&(M(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new sn,this.toJSON())}_performRefresh(){return Qe("not implemented")}}function ut(n,e){M(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class De{constructor({uid:e,auth:t,stsTokenManager:s,...r}){this.providerId="firebase",this.proactiveRefresh=new Sp(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Ri(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await es(this,this.stsTokenManager.getToken(this.auth,e));return M(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Ap(this,e)}reload(){return Pp(this)}_assign(e){this!==e&&(M(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new De({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){M(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await tr(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Pe(this.auth.app))return Promise.reject(Xe(this.auth));const e=await this.getIdToken();return await es(this,xp(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,r=t.email??void 0,o=t.phoneNumber??void 0,a=t.photoURL??void 0,l=t.tenantId??void 0,h=t._redirectEventId??void 0,d=t.createdAt??void 0,p=t.lastLoginAt??void 0,{uid:_,emailVerified:E,isAnonymous:A,providerData:C,stsTokenManager:D}=t;M(_&&D,e,"internal-error");const k=sn.fromJSON(this.name,D);M(typeof _=="string",e,"internal-error"),ut(s,e.name),ut(r,e.name),M(typeof E=="boolean",e,"internal-error"),M(typeof A=="boolean",e,"internal-error"),ut(o,e.name),ut(a,e.name),ut(l,e.name),ut(h,e.name),ut(d,e.name),ut(p,e.name);const O=new De({uid:_,auth:e,email:r,emailVerified:E,displayName:s,isAnonymous:A,photoURL:a,phoneNumber:o,tenantId:l,stsTokenManager:k,createdAt:d,lastLoginAt:p});return C&&Array.isArray(C)&&(O.providerData=C.map(z=>({...z}))),h&&(O._redirectEventId=h),O}static async _fromIdTokenResponse(e,t,s=!1){const r=new sn;r.updateFromServerResponse(t);const o=new De({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await tr(o),o}static async _fromGetAccountInfoResponse(e,t,s){const r=t.users[0];M(r.localId!==void 0,"internal-error");const o=r.providerUserInfo!==void 0?Ml(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!o?.length,l=new sn;l.updateFromIdToken(s);const h=new De({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:a}),d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Ri(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!o?.length};return Object.assign(h,d),h}}const ic=new Map;function Je(n){Ze(n instanceof Function,"Expected a class definition");let e=ic.get(n);return e?(Ze(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ic.set(n,e),e)}class Fl{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Fl.type="NONE";const oc=Fl;function js(n,e,t){return`firebase:${n}:${e}:${t}`}class rn{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:r,name:o}=this.auth;this.fullUserKey=js(this.userKey,r.apiKey,o),this.fullPersistenceKey=js("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await er(this.auth,{idToken:e}).catch(()=>{});return t?De._fromGetAccountInfoResponse(this.auth,t,e):null}return De._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new rn(Je(oc),e,s);const r=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=r[0]||Je(oc);const a=js(s,e.config.apiKey,e.name);let l=null;for(const d of t)try{const p=await d._get(a);if(p){let _;if(typeof p=="string"){const E=await er(e,{idToken:p}).catch(()=>{});if(!E)break;_=await De._fromGetAccountInfoResponse(e,E,p)}else _=De._fromJSON(e,p);d!==o&&(l=_),o=d;break}}catch{}const h=r.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new rn(o,e,s):(o=h[0],l&&await o._set(a,l.toJSON()),await Promise.all(t.map(async d=>{if(d!==o)try{await d._remove(a)}catch{}})),new rn(o,e,s))}}function ac(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(jl(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ul(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($l(e))return"Blackberry";if(Hl(e))return"Webos";if(Bl(e))return"Safari";if((e.includes("chrome/")||zl(e))&&!e.includes("edge/"))return"Chrome";if(ql(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if(s?.length===2)return s[1]}return"Other"}function Ul(n=ve()){return/firefox\//i.test(n)}function Bl(n=ve()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function zl(n=ve()){return/crios\//i.test(n)}function jl(n=ve()){return/iemobile/i.test(n)}function ql(n=ve()){return/android/i.test(n)}function $l(n=ve()){return/blackberry/i.test(n)}function Hl(n=ve()){return/webos/i.test(n)}function eo(n=ve()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Dp(n=ve()){return eo(n)&&!!window.navigator?.standalone}function Np(){return $d()&&document.documentMode===10}function Wl(n=ve()){return eo(n)||ql(n)||Hl(n)||$l(n)||/windows phone/i.test(n)||jl(n)}function Gl(n,e=[]){let t;switch(n){case"Browser":t=ac(ve());break;case"Worker":t=`${ac(ve())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${gn}/${s}`}class Op{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=o=>new Promise((a,l)=>{try{const h=e(o);a(h)}catch(h){l(h)}});s.onAbort=t,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function Lp(n,e={}){return Rt(n,"GET","/v2/passwordPolicy",At(n,e))}const Mp=6;class Fp{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Mp,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}class Up{constructor(e,t,s,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cc(this),this.idTokenSubscription=new cc(this),this.beforeStateQueue=new Op(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Dl,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Je(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await rn.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await er(this,{idToken:e}),s=await De._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Pe(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,a=s?._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&l?.user&&(s=l.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return M(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await tr(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=yp()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Pe(this.app))return Promise.reject(Xe(this));const t=e?be(e):null;return t&&M(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&M(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Pe(this.app)?Promise.reject(Xe(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Pe(this.app)?Promise.reject(Xe(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Je(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Lp(this),t=new Fp(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new us("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await Vp(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Je(e)||this._popupRedirectResolver;M(t,this,"argument-error"),this.redirectPersistenceManager=await rn.create(this,[Je(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,r){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(M(l,this,"internal-error"),l.then(()=>{a||o(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,s,r);return()=>{a=!0,h()}}else{const h=e.addObserver(t);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return M(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Gl(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(Pe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&fp(`Error while retrieving App Check token: ${e.error}`),e?.token}}function St(n){return be(n)}class cc{constructor(e){this.auth=e,this.observer=null,this.addObserver=Yd(t=>this.observer=t)}get next(){return M(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let yr={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Bp(n){yr=n}function Kl(n){return yr.loadJS(n)}function zp(){return yr.recaptchaEnterpriseScript}function jp(){return yr.gapiScript}function qp(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class $p{constructor(){this.enterprise=new Hp}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Hp{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Wp="recaptcha-enterprise",Ql="NO_RECAPTCHA";class Gp{constructor(e){this.type=Wp,this.auth=St(e)}async verify(e="verify",t=!1){async function s(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(a,l)=>{Tp(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new Ip(h);return o.tenantId==null?o._agentRecaptchaConfig=d:o._tenantRecaptchaConfigs[o.tenantId]=d,a(d.siteKey)}}).catch(h=>{l(h)})})}function r(o,a,l){const h=window.grecaptcha;sc(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(d=>{a(d)}).catch(()=>{a(Ql)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new $p().execute("siteKey",{action:"verify"}):new Promise((o,a)=>{s(this.auth).then(l=>{if(!t&&sc(window.grecaptcha))r(l,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let h=zp();h.length!==0&&(h+=l),Kl(h).then(()=>{r(l,o,a)}).catch(d=>{a(d)})}}).catch(l=>{a(l)})})}}async function lc(n,e,t,s=!1,r=!1){const o=new Gp(n);let a;if(r)a=Ql;else try{a=await o.verify(t)}catch{a=await o.verify(t,!0)}const l={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const h=l.phoneEnrollmentInfo.phoneNumber,d=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const h=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return s?Object.assign(l,{captchaResp:a}):Object.assign(l,{captchaResponse:a}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Si(n,e,t,s,r){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await lc(n,e,t,t==="getOobCode");return s(n,o)}else return s(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await lc(n,e,t,t==="getOobCode");return s(n,a)}else return Promise.reject(o)})}function Kp(n,e){const t=Qi(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),o=t.getOptions();if(zt(o,e??{}))return r;Ve(r,"already-initialized")}return t.initialize({options:e})}function Qp(n,e){const t=e?.persistence||[],s=(Array.isArray(t)?t:[t]).map(Je);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e?.popupRedirectResolver)}function Jp(n,e,t){const s=St(n);M(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,o=Jl(e),{host:a,port:l}=Xp(e),h=l===null?"":`:${l}`,d={url:`${o}//${a}${h}/`},p=Object.freeze({host:a,port:l,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){M(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),M(zt(d,s.config.emulator)&&zt(p,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=d,s.emulatorConfig=p,s.settings.appVerificationDisabledForTesting=!0,mn(a)?(Tl(`${o}//${a}${h}`),xl("Auth",!0)):Yp()}function Jl(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Xp(n){const e=Jl(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const o=r[1];return{host:o,port:uc(s.substr(o.length+1))}}else{const[o,a]=s.split(":");return{host:o,port:uc(a)}}}function uc(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Yp(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class to{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Qe("not implemented")}_getIdTokenResponse(e){return Qe("not implemented")}_linkToIdToken(e,t){return Qe("not implemented")}_getReauthenticationResolver(e){return Qe("not implemented")}}async function Zp(n,e){return Rt(n,"POST","/v1/accounts:signUp",e)}async function em(n,e){return fs(n,"POST","/v1/accounts:signInWithPassword",At(n,e))}async function tm(n,e){return fs(n,"POST","/v1/accounts:signInWithEmailLink",At(n,e))}async function nm(n,e){return fs(n,"POST","/v1/accounts:signInWithEmailLink",At(n,e))}class ts extends to{constructor(e,t,s,r=null){super("password",s),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new ts(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new ts(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Si(e,t,"signInWithPassword",em);case"emailLink":return tm(e,{email:this._email,oobCode:this._password});default:Ve(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Si(e,s,"signUpPassword",Zp);case"emailLink":return nm(e,{idToken:t,email:this._email,oobCode:this._password});default:Ve(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function on(n,e){return fs(n,"POST","/v1/accounts:signInWithIdp",At(n,e))}const sm="http://localhost";class et extends to{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new et(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ve("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,...o}=t;if(!s||!r)return null;const a=new et(s,r);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return on(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,on(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,on(e,t)}buildRequest(){const e={requestUri:sm,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=hs(t)}return e}}function rm(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function im(n){const e=Un(Bn(n)).link,t=e?Un(Bn(e)).deep_link_id:null,s=Un(Bn(n)).deep_link_id;return(s?Un(Bn(s)).link:null)||s||t||e||n}class no{constructor(e){const t=Un(Bn(e)),s=t.apiKey??null,r=t.oobCode??null,o=rm(t.mode??null);M(s&&r&&o,"argument-error"),this.apiKey=s,this.operation=o,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=im(e);try{return new no(t)}catch{return null}}}class yn{constructor(){this.providerId=yn.PROVIDER_ID}static credential(e,t){return ts._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=no.parseLink(t);return M(s,"argument-error"),ts._fromEmailAndCode(e,s.code,s.tenantId)}}yn.PROVIDER_ID="password";yn.EMAIL_PASSWORD_SIGN_IN_METHOD="password";yn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class so{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class _n extends so{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Gn extends _n{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return M("providerId"in t&&"signInMethod"in t,"argument-error"),et._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return M(e.idToken||e.accessToken,"argument-error"),et._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return Gn.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Gn.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:r,pendingToken:o,nonce:a,providerId:l}=e;if(!s&&!r&&!t&&!o||!l)return null;try{return new Gn(l)._credential({idToken:t,accessToken:s,nonce:a,pendingToken:o})}catch{return null}}}class ht extends _n{constructor(){super("facebook.com")}static credential(e){return et._fromParams({providerId:ht.PROVIDER_ID,signInMethod:ht.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ht.credentialFromTaggedObject(e)}static credentialFromError(e){return ht.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ht.credential(e.oauthAccessToken)}catch{return null}}}ht.FACEBOOK_SIGN_IN_METHOD="facebook.com";ht.PROVIDER_ID="facebook.com";class Ke extends _n{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return et._fromParams({providerId:Ke.PROVIDER_ID,signInMethod:Ke.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ke.credentialFromTaggedObject(e)}static credentialFromError(e){return Ke.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Ke.credential(t,s)}catch{return null}}}Ke.GOOGLE_SIGN_IN_METHOD="google.com";Ke.PROVIDER_ID="google.com";class dt extends _n{constructor(){super("github.com")}static credential(e){return et._fromParams({providerId:dt.PROVIDER_ID,signInMethod:dt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return dt.credentialFromTaggedObject(e)}static credentialFromError(e){return dt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return dt.credential(e.oauthAccessToken)}catch{return null}}}dt.GITHUB_SIGN_IN_METHOD="github.com";dt.PROVIDER_ID="github.com";class ft extends _n{constructor(){super("twitter.com")}static credential(e,t){return et._fromParams({providerId:ft.PROVIDER_ID,signInMethod:ft.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ft.credentialFromTaggedObject(e)}static credentialFromError(e){return ft.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return ft.credential(t,s)}catch{return null}}}ft.TWITTER_SIGN_IN_METHOD="twitter.com";ft.PROVIDER_ID="twitter.com";async function om(n,e){return fs(n,"POST","/v1/accounts:signUp",At(n,e))}class qt{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,r=!1){const o=await De._fromIdTokenResponse(e,s,r),a=hc(s);return new qt({user:o,providerId:a,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const r=hc(s);return new qt({user:e,providerId:r,_tokenResponse:s,operationType:t})}}function hc(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class nr extends st{constructor(e,t,s,r){super(t.code,t.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,nr.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,r){return new nr(e,t,s,r)}}function Xl(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?nr._fromErrorAndOperation(n,o,e,s):o})}async function am(n,e,t=!1){const s=await es(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return qt._forOperation(n,"link",s)}async function cm(n,e,t=!1){const{auth:s}=n;if(Pe(s.app))return Promise.reject(Xe(s));const r="reauthenticate";try{const o=await es(n,Xl(s,r,e,n),t);M(o.idToken,s,"internal-error");const a=Zi(o.idToken);M(a,s,"internal-error");const{sub:l}=a;return M(n.uid===l,s,"user-mismatch"),qt._forOperation(n,r,o)}catch(o){throw o?.code==="auth/user-not-found"&&Ve(s,"user-mismatch"),o}}async function Yl(n,e,t=!1){if(Pe(n.app))return Promise.reject(Xe(n));const s="signIn",r=await Xl(n,s,e),o=await qt._fromIdTokenResponse(n,s,r);return t||await n._updateCurrentUser(o.user),o}async function lm(n,e){return Yl(St(n),e)}async function Zl(n){const e=St(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function um(n,e,t){if(Pe(n.app))return Promise.reject(Xe(n));const s=St(n),a=await Si(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",om).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&Zl(n),h}),l=await qt._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(l.user),l}function hm(n,e,t){return Pe(n.app)?Promise.reject(Xe(n)):lm(be(n),yn.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&Zl(n),s})}function dm(n,e,t,s){return be(n).onIdTokenChanged(e,t,s)}function fm(n,e,t){return be(n).beforeAuthStateChanged(e,t)}function pm(n,e,t,s){return be(n).onAuthStateChanged(e,t,s)}function mm(n){return be(n).signOut()}const sr="__sak";class eu{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(sr,"1"),this.storage.removeItem(sr),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const gm=1e3,ym=10;class tu extends eu{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Wl(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),r=this.localCache[t];s!==r&&e(t,r,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,l,h)=>{this.notifyListeners(a,h)});return}const s=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const a=this.storage.getItem(s);!t&&this.localCache[s]===a||this.notifyListeners(s,a)},o=this.storage.getItem(s);Np()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,ym):r()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},gm)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}tu.type="LOCAL";const _m=tu;class nu extends eu{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}nu.type="SESSION";const su=nu;function vm(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class _r{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const s=new _r(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:r,data:o}=t.data,a=this.handlersMap[r];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const l=Array.from(a).map(async d=>d(t.origin,o)),h=await vm(l);t.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}_r.receivers=[];function ro(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}class bm{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,a;return new Promise((l,h)=>{const d=ro("",20);r.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},s);a={messageChannel:r,onMessage(_){const E=_;if(E.data.eventId===d)switch(E.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),l(E.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Be(){return window}function Em(n){Be().location.href=n}function ru(){return typeof Be().WorkerGlobalScope<"u"&&typeof Be().importScripts=="function"}async function wm(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Im(){return navigator?.serviceWorker?.controller||null}function Tm(){return ru()?self:null}const iu="firebaseLocalStorageDb",xm=1,rr="firebaseLocalStorage",ou="fbase_key";class ps{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function vr(n,e){return n.transaction([rr],e?"readwrite":"readonly").objectStore(rr)}function Am(){const n=indexedDB.deleteDatabase(iu);return new ps(n).toPromise()}function Pi(){const n=indexedDB.open(iu,xm);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(rr,{keyPath:ou})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(rr)?e(s):(s.close(),await Am(),e(await Pi()))})})}async function dc(n,e,t){const s=vr(n,!0).put({[ou]:e,value:t});return new ps(s).toPromise()}async function Rm(n,e){const t=vr(n,!1).get(e),s=await new ps(t).toPromise();return s===void 0?null:s.value}function fc(n,e){const t=vr(n,!0).delete(e);return new ps(t).toPromise()}const Sm=800,Pm=3;class au{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Pi(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>Pm)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ru()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_r._getInstance(Tm()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await wm(),!this.activeServiceWorker)return;this.sender=new bm(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Im()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Pi();return await dc(e,sr,"1"),await fc(e,sr),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>dc(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>Rm(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>fc(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const o=vr(r,!1).getAll();return new ps(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:o}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(o)&&(this.notifyListeners(r,o),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Sm)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}au.type="LOCAL";const Cm=au;new ds(3e4,6e4);function cu(n,e){return e?Je(e):(M(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class io extends to{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return on(e,this._buildIdpRequest())}_linkToIdToken(e,t){return on(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return on(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function km(n){return Yl(n.auth,new io(n),n.bypassAuthState)}function Vm(n){const{auth:e,user:t}=n;return M(t,e,"internal-error"),cm(t,new io(n),n.bypassAuthState)}async function Dm(n){const{auth:e,user:t}=n;return M(t,e,"internal-error"),am(t,new io(n),n.bypassAuthState)}class lu{constructor(e,t,s,r,o=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:r,tenantId:o,error:a,type:l}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:t,sessionId:s,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return km;case"linkViaPopup":case"linkViaRedirect":return Dm;case"reauthViaPopup":case"reauthViaRedirect":return Vm;default:Ve(this.auth,"internal-error")}}resolve(e){Ze(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ze(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Nm=new ds(2e3,1e4);async function uu(n,e,t){if(Pe(n.app))return Promise.reject(Oe(n,"operation-not-supported-in-this-environment"));const s=St(n);pp(n,e,so);const r=cu(s,t);return new Ft(s,"signInViaPopup",e,r).executeNotNull()}class Ft extends lu{constructor(e,t,s,r,o){super(e,t,r,o),this.provider=s,this.authWindow=null,this.pollId=null,Ft.currentPopupAction&&Ft.currentPopupAction.cancel(),Ft.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return M(e,this.auth,"internal-error"),e}async onExecution(){Ze(this.filter.length===1,"Popup operations only handle one event");const e=ro();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Oe(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Oe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ft.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Oe(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Nm.get())};e()}}Ft.currentPopupAction=null;const Om="pendingRedirect",qs=new Map;class Lm extends lu{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=qs.get(this.auth._key());if(!e){try{const s=await Mm(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}qs.set(this.auth._key(),e)}return this.bypassAuthState||qs.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Mm(n,e){const t=Bm(e),s=Um(n);if(!await s._isAvailable())return!1;const r=await s._get(t)==="true";return await s._remove(t),r}function Fm(n,e){qs.set(n._key(),e)}function Um(n){return Je(n._redirectPersistence)}function Bm(n){return js(Om,n.config.apiKey,n.name)}async function zm(n,e,t=!1){if(Pe(n.app))return Promise.reject(Xe(n));const s=St(n),r=cu(s,e),a=await new Lm(s,r,t).execute();return a&&!t&&(delete a.user._redirectEventId,await s._persistUserIfCurrent(a.user),await s._setRedirectUser(null,e)),a}const jm=600*1e3;class qm{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$m(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!hu(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Oe(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=jm&&this.cachedEventUids.clear(),this.cachedEventUids.has(pc(e))}saveEventToCache(e){this.cachedEventUids.add(pc(e)),this.lastProcessedEventTime=Date.now()}}function pc(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function hu({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function $m(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hu(n);default:return!1}}async function Hm(n,e={}){return Rt(n,"GET","/v1/projects",e)}const Wm=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Gm=/^https?/;async function Km(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Hm(n);for(const t of e)try{if(Qm(t))return}catch{}Ve(n,"unauthorized-domain")}function Qm(n){const e=Ai(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===s}if(!Gm.test(t))return!1;if(Wm.test(n))return s===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}const Jm=new ds(3e4,6e4);function mc(){const n=Be().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Xm(n){return new Promise((e,t)=>{function s(){mc(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mc(),t(Oe(n,"network-request-failed"))},timeout:Jm.get()})}if(Be().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Be().gapi?.load)s();else{const r=qp("iframefcb");return Be()[r]=()=>{gapi.load?s():t(Oe(n,"network-request-failed"))},Kl(`${jp()}?onload=${r}`).catch(o=>t(o))}}).catch(e=>{throw $s=null,e})}let $s=null;function Ym(n){return $s=$s||Xm(n),$s}const Zm=new ds(5e3,15e3),eg="__/auth/iframe",tg="emulator/auth/iframe",ng={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sg=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function rg(n){const e=n.config;M(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Yi(e,tg):`https://${n.config.authDomain}/${eg}`,s={apiKey:e.apiKey,appName:n.name,v:gn},r=sg.get(n.config.apiHost);r&&(s.eid=r);const o=n._getFrameworks();return o.length&&(s.fw=o.join(",")),`${t}?${hs(s).slice(1)}`}async function ig(n){const e=await Ym(n),t=Be().gapi;return M(t,n,"internal-error"),e.open({where:document.body,url:rg(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ng,dontclear:!0},s=>new Promise(async(r,o)=>{await s.restyle({setHideOnLeave:!1});const a=Oe(n,"network-request-failed"),l=Be().setTimeout(()=>{o(a)},Zm.get());function h(){Be().clearTimeout(l),r(s)}s.ping(h).then(h,()=>{o(a)})}))}const og={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ag=500,cg=600,lg="_blank",ug="http://localhost";class gc{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function hg(n,e,t,s=ag,r=cg){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let l="";const h={...og,width:s.toString(),height:r.toString(),top:o,left:a},d=ve().toLowerCase();t&&(l=zl(d)?lg:t),Ul(d)&&(e=e||ug,h.scrollbars="yes");const p=Object.entries(h).reduce((E,[A,C])=>`${E}${A}=${C},`,"");if(Dp(d)&&l!=="_self")return dg(e||"",l),new gc(null);const _=window.open(e||"",l,p);M(_,n,"popup-blocked");try{_.focus()}catch{}return new gc(_)}function dg(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}const fg="__/auth/handler",pg="emulator/auth/handler",mg=encodeURIComponent("fac");async function yc(n,e,t,s,r,o){M(n.config.authDomain,n,"auth-domain-config-required"),M(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:gn,eventId:r};if(e instanceof so){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Xd(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,_]of Object.entries({}))a[p]=_}if(e instanceof _n){const p=e.getScopes().filter(_=>_!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);const l=a;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const h=await n._getAppCheckToken(),d=h?`#${mg}=${encodeURIComponent(h)}`:"";return`${gg(n)}?${hs(l).slice(1)}${d}`}function gg({config:n}){return n.emulator?Yi(n,pg):`https://${n.authDomain}/${fg}`}const pi="webStorageSupport";class yg{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=su,this._completeRedirectFn=zm,this._overrideRedirectResult=Fm}async _openPopup(e,t,s,r){Ze(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await yc(e,t,s,Ai(),r);return hg(e,o,ro())}async _openRedirect(e,t,s,r){await this._originValidation(e);const o=await yc(e,t,s,Ai(),r);return Em(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(Ze(o,"If manager is not set, promise should be"),o)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await ig(e),s=new qm(e);return t.register("authEvent",r=>(M(r?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(pi,{type:pi},r=>{const o=r?.[0]?.[pi];o!==void 0&&t(!!o),Ve(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Km(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Wl()||Bl()||eo()}}const _g=yg;var _c="@firebase/auth",vc="1.12.0";class vg{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){M(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function bg(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Eg(n){cn(new jt("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=s.options;M(a&&!a.includes(":"),"invalid-api-key",{appName:s.name});const h={apiKey:a,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Gl(n)},d=new Up(s,r,o,h);return Qp(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),cn(new jt("auth-internal",e=>{const t=St(e.getProvider("auth").getImmediate());return(s=>new vg(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),yt(_c,vc,bg(n)),yt(_c,vc,"esm2020")}const wg=300,Ig=Il("authIdTokenMaxAge")||wg;let bc=null;const Tg=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>Ig)return;const r=t?.token;bc!==r&&(bc=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function xg(n=Pl()){const e=Qi(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Kp(n,{popupRedirectResolver:_g,persistence:[Cm,_m,su]}),s=Il("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(s,location.origin);if(location.origin===o.origin){const a=Tg(o.toString());fm(t,a,()=>a(t.currentUser)),dm(t,l=>a(l))}}const r=El("auth");return r&&Jp(t,`http://${r}`),t}function Ag(){return document.getElementsByTagName("head")?.[0]??document}Bp({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=r=>{const o=Oe("internal-error");o.customData=r,t(o)},s.type="text/javascript",s.charset="UTF-8",Ag().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Eg("Browser");var Ec=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var _t,du;(function(){var n;function e(b,m){function y(){}y.prototype=m.prototype,b.F=m.prototype,b.prototype=new y,b.prototype.constructor=b,b.D=function(w,v,T){for(var g=Array(arguments.length-2),xe=2;xe<arguments.length;xe++)g[xe-2]=arguments[xe];return m.prototype[v].apply(w,g)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(b,m,y){y||(y=0);const w=Array(16);if(typeof m=="string")for(var v=0;v<16;++v)w[v]=m.charCodeAt(y++)|m.charCodeAt(y++)<<8|m.charCodeAt(y++)<<16|m.charCodeAt(y++)<<24;else for(v=0;v<16;++v)w[v]=m[y++]|m[y++]<<8|m[y++]<<16|m[y++]<<24;m=b.g[0],y=b.g[1],v=b.g[2];let T=b.g[3],g;g=m+(T^y&(v^T))+w[0]+3614090360&4294967295,m=y+(g<<7&4294967295|g>>>25),g=T+(v^m&(y^v))+w[1]+3905402710&4294967295,T=m+(g<<12&4294967295|g>>>20),g=v+(y^T&(m^y))+w[2]+606105819&4294967295,v=T+(g<<17&4294967295|g>>>15),g=y+(m^v&(T^m))+w[3]+3250441966&4294967295,y=v+(g<<22&4294967295|g>>>10),g=m+(T^y&(v^T))+w[4]+4118548399&4294967295,m=y+(g<<7&4294967295|g>>>25),g=T+(v^m&(y^v))+w[5]+1200080426&4294967295,T=m+(g<<12&4294967295|g>>>20),g=v+(y^T&(m^y))+w[6]+2821735955&4294967295,v=T+(g<<17&4294967295|g>>>15),g=y+(m^v&(T^m))+w[7]+4249261313&4294967295,y=v+(g<<22&4294967295|g>>>10),g=m+(T^y&(v^T))+w[8]+1770035416&4294967295,m=y+(g<<7&4294967295|g>>>25),g=T+(v^m&(y^v))+w[9]+2336552879&4294967295,T=m+(g<<12&4294967295|g>>>20),g=v+(y^T&(m^y))+w[10]+4294925233&4294967295,v=T+(g<<17&4294967295|g>>>15),g=y+(m^v&(T^m))+w[11]+2304563134&4294967295,y=v+(g<<22&4294967295|g>>>10),g=m+(T^y&(v^T))+w[12]+1804603682&4294967295,m=y+(g<<7&4294967295|g>>>25),g=T+(v^m&(y^v))+w[13]+4254626195&4294967295,T=m+(g<<12&4294967295|g>>>20),g=v+(y^T&(m^y))+w[14]+2792965006&4294967295,v=T+(g<<17&4294967295|g>>>15),g=y+(m^v&(T^m))+w[15]+1236535329&4294967295,y=v+(g<<22&4294967295|g>>>10),g=m+(v^T&(y^v))+w[1]+4129170786&4294967295,m=y+(g<<5&4294967295|g>>>27),g=T+(y^v&(m^y))+w[6]+3225465664&4294967295,T=m+(g<<9&4294967295|g>>>23),g=v+(m^y&(T^m))+w[11]+643717713&4294967295,v=T+(g<<14&4294967295|g>>>18),g=y+(T^m&(v^T))+w[0]+3921069994&4294967295,y=v+(g<<20&4294967295|g>>>12),g=m+(v^T&(y^v))+w[5]+3593408605&4294967295,m=y+(g<<5&4294967295|g>>>27),g=T+(y^v&(m^y))+w[10]+38016083&4294967295,T=m+(g<<9&4294967295|g>>>23),g=v+(m^y&(T^m))+w[15]+3634488961&4294967295,v=T+(g<<14&4294967295|g>>>18),g=y+(T^m&(v^T))+w[4]+3889429448&4294967295,y=v+(g<<20&4294967295|g>>>12),g=m+(v^T&(y^v))+w[9]+568446438&4294967295,m=y+(g<<5&4294967295|g>>>27),g=T+(y^v&(m^y))+w[14]+3275163606&4294967295,T=m+(g<<9&4294967295|g>>>23),g=v+(m^y&(T^m))+w[3]+4107603335&4294967295,v=T+(g<<14&4294967295|g>>>18),g=y+(T^m&(v^T))+w[8]+1163531501&4294967295,y=v+(g<<20&4294967295|g>>>12),g=m+(v^T&(y^v))+w[13]+2850285829&4294967295,m=y+(g<<5&4294967295|g>>>27),g=T+(y^v&(m^y))+w[2]+4243563512&4294967295,T=m+(g<<9&4294967295|g>>>23),g=v+(m^y&(T^m))+w[7]+1735328473&4294967295,v=T+(g<<14&4294967295|g>>>18),g=y+(T^m&(v^T))+w[12]+2368359562&4294967295,y=v+(g<<20&4294967295|g>>>12),g=m+(y^v^T)+w[5]+4294588738&4294967295,m=y+(g<<4&4294967295|g>>>28),g=T+(m^y^v)+w[8]+2272392833&4294967295,T=m+(g<<11&4294967295|g>>>21),g=v+(T^m^y)+w[11]+1839030562&4294967295,v=T+(g<<16&4294967295|g>>>16),g=y+(v^T^m)+w[14]+4259657740&4294967295,y=v+(g<<23&4294967295|g>>>9),g=m+(y^v^T)+w[1]+2763975236&4294967295,m=y+(g<<4&4294967295|g>>>28),g=T+(m^y^v)+w[4]+1272893353&4294967295,T=m+(g<<11&4294967295|g>>>21),g=v+(T^m^y)+w[7]+4139469664&4294967295,v=T+(g<<16&4294967295|g>>>16),g=y+(v^T^m)+w[10]+3200236656&4294967295,y=v+(g<<23&4294967295|g>>>9),g=m+(y^v^T)+w[13]+681279174&4294967295,m=y+(g<<4&4294967295|g>>>28),g=T+(m^y^v)+w[0]+3936430074&4294967295,T=m+(g<<11&4294967295|g>>>21),g=v+(T^m^y)+w[3]+3572445317&4294967295,v=T+(g<<16&4294967295|g>>>16),g=y+(v^T^m)+w[6]+76029189&4294967295,y=v+(g<<23&4294967295|g>>>9),g=m+(y^v^T)+w[9]+3654602809&4294967295,m=y+(g<<4&4294967295|g>>>28),g=T+(m^y^v)+w[12]+3873151461&4294967295,T=m+(g<<11&4294967295|g>>>21),g=v+(T^m^y)+w[15]+530742520&4294967295,v=T+(g<<16&4294967295|g>>>16),g=y+(v^T^m)+w[2]+3299628645&4294967295,y=v+(g<<23&4294967295|g>>>9),g=m+(v^(y|~T))+w[0]+4096336452&4294967295,m=y+(g<<6&4294967295|g>>>26),g=T+(y^(m|~v))+w[7]+1126891415&4294967295,T=m+(g<<10&4294967295|g>>>22),g=v+(m^(T|~y))+w[14]+2878612391&4294967295,v=T+(g<<15&4294967295|g>>>17),g=y+(T^(v|~m))+w[5]+4237533241&4294967295,y=v+(g<<21&4294967295|g>>>11),g=m+(v^(y|~T))+w[12]+1700485571&4294967295,m=y+(g<<6&4294967295|g>>>26),g=T+(y^(m|~v))+w[3]+2399980690&4294967295,T=m+(g<<10&4294967295|g>>>22),g=v+(m^(T|~y))+w[10]+4293915773&4294967295,v=T+(g<<15&4294967295|g>>>17),g=y+(T^(v|~m))+w[1]+2240044497&4294967295,y=v+(g<<21&4294967295|g>>>11),g=m+(v^(y|~T))+w[8]+1873313359&4294967295,m=y+(g<<6&4294967295|g>>>26),g=T+(y^(m|~v))+w[15]+4264355552&4294967295,T=m+(g<<10&4294967295|g>>>22),g=v+(m^(T|~y))+w[6]+2734768916&4294967295,v=T+(g<<15&4294967295|g>>>17),g=y+(T^(v|~m))+w[13]+1309151649&4294967295,y=v+(g<<21&4294967295|g>>>11),g=m+(v^(y|~T))+w[4]+4149444226&4294967295,m=y+(g<<6&4294967295|g>>>26),g=T+(y^(m|~v))+w[11]+3174756917&4294967295,T=m+(g<<10&4294967295|g>>>22),g=v+(m^(T|~y))+w[2]+718787259&4294967295,v=T+(g<<15&4294967295|g>>>17),g=y+(T^(v|~m))+w[9]+3951481745&4294967295,b.g[0]=b.g[0]+m&4294967295,b.g[1]=b.g[1]+(v+(g<<21&4294967295|g>>>11))&4294967295,b.g[2]=b.g[2]+v&4294967295,b.g[3]=b.g[3]+T&4294967295}s.prototype.v=function(b,m){m===void 0&&(m=b.length);const y=m-this.blockSize,w=this.C;let v=this.h,T=0;for(;T<m;){if(v==0)for(;T<=y;)r(this,b,T),T+=this.blockSize;if(typeof b=="string"){for(;T<m;)if(w[v++]=b.charCodeAt(T++),v==this.blockSize){r(this,w),v=0;break}}else for(;T<m;)if(w[v++]=b[T++],v==this.blockSize){r(this,w),v=0;break}}this.h=v,this.o+=m},s.prototype.A=function(){var b=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);b[0]=128;for(var m=1;m<b.length-8;++m)b[m]=0;m=this.o*8;for(var y=b.length-8;y<b.length;++y)b[y]=m&255,m/=256;for(this.v(b),b=Array(16),m=0,y=0;y<4;++y)for(let w=0;w<32;w+=8)b[m++]=this.g[y]>>>w&255;return b};function o(b,m){var y=l;return Object.prototype.hasOwnProperty.call(y,b)?y[b]:y[b]=m(b)}function a(b,m){this.h=m;const y=[];let w=!0;for(let v=b.length-1;v>=0;v--){const T=b[v]|0;w&&T==m||(y[v]=T,w=!1)}this.g=y}var l={};function h(b){return-128<=b&&b<128?o(b,function(m){return new a([m|0],m<0?-1:0)}):new a([b|0],b<0?-1:0)}function d(b){if(isNaN(b)||!isFinite(b))return _;if(b<0)return k(d(-b));const m=[];let y=1;for(let w=0;b>=y;w++)m[w]=b/y|0,y*=4294967296;return new a(m,0)}function p(b,m){if(b.length==0)throw Error("number format error: empty string");if(m=m||10,m<2||36<m)throw Error("radix out of range: "+m);if(b.charAt(0)=="-")return k(p(b.substring(1),m));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');const y=d(Math.pow(m,8));let w=_;for(let T=0;T<b.length;T+=8){var v=Math.min(8,b.length-T);const g=parseInt(b.substring(T,T+v),m);v<8?(v=d(Math.pow(m,v)),w=w.j(v).add(d(g))):(w=w.j(y),w=w.add(d(g)))}return w}var _=h(0),E=h(1),A=h(16777216);n=a.prototype,n.m=function(){if(D(this))return-k(this).m();let b=0,m=1;for(let y=0;y<this.g.length;y++){const w=this.i(y);b+=(w>=0?w:4294967296+w)*m,m*=4294967296}return b},n.toString=function(b){if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(C(this))return"0";if(D(this))return"-"+k(this).toString(b);const m=d(Math.pow(b,6));var y=this;let w="";for(;;){const v=Ee(y,m).g;y=O(y,v.j(m));let T=((y.g.length>0?y.g[0]:y.h)>>>0).toString(b);if(y=v,C(y))return T+w;for(;T.length<6;)T="0"+T;w=T+w}},n.i=function(b){return b<0?0:b<this.g.length?this.g[b]:this.h};function C(b){if(b.h!=0)return!1;for(let m=0;m<b.g.length;m++)if(b.g[m]!=0)return!1;return!0}function D(b){return b.h==-1}n.l=function(b){return b=O(this,b),D(b)?-1:C(b)?0:1};function k(b){const m=b.g.length,y=[];for(let w=0;w<m;w++)y[w]=~b.g[w];return new a(y,~b.h).add(E)}n.abs=function(){return D(this)?k(this):this},n.add=function(b){const m=Math.max(this.g.length,b.g.length),y=[];let w=0;for(let v=0;v<=m;v++){let T=w+(this.i(v)&65535)+(b.i(v)&65535),g=(T>>>16)+(this.i(v)>>>16)+(b.i(v)>>>16);w=g>>>16,T&=65535,g&=65535,y[v]=g<<16|T}return new a(y,y[y.length-1]&-2147483648?-1:0)};function O(b,m){return b.add(k(m))}n.j=function(b){if(C(this)||C(b))return _;if(D(this))return D(b)?k(this).j(k(b)):k(k(this).j(b));if(D(b))return k(this.j(k(b)));if(this.l(A)<0&&b.l(A)<0)return d(this.m()*b.m());const m=this.g.length+b.g.length,y=[];for(var w=0;w<2*m;w++)y[w]=0;for(w=0;w<this.g.length;w++)for(let v=0;v<b.g.length;v++){const T=this.i(w)>>>16,g=this.i(w)&65535,xe=b.i(v)>>>16,kt=b.i(v)&65535;y[2*w+2*v]+=g*kt,z(y,2*w+2*v),y[2*w+2*v+1]+=T*kt,z(y,2*w+2*v+1),y[2*w+2*v+1]+=g*xe,z(y,2*w+2*v+1),y[2*w+2*v+2]+=T*xe,z(y,2*w+2*v+2)}for(b=0;b<m;b++)y[b]=y[2*b+1]<<16|y[2*b];for(b=m;b<2*m;b++)y[b]=0;return new a(y,0)};function z(b,m){for(;(b[m]&65535)!=b[m];)b[m+1]+=b[m]>>>16,b[m]&=65535,m++}function W(b,m){this.g=b,this.h=m}function Ee(b,m){if(C(m))throw Error("division by zero");if(C(b))return new W(_,_);if(D(b))return m=Ee(k(b),m),new W(k(m.g),k(m.h));if(D(m))return m=Ee(b,k(m)),new W(k(m.g),m.h);if(b.g.length>30){if(D(b)||D(m))throw Error("slowDivide_ only works with positive integers.");for(var y=E,w=m;w.l(b)<=0;)y=Te(y),w=Te(w);var v=ce(y,1),T=ce(w,1);for(w=ce(w,2),y=ce(y,2);!C(w);){var g=T.add(w);g.l(b)<=0&&(v=v.add(y),T=g),w=ce(w,1),y=ce(y,1)}return m=O(b,v.j(m)),new W(v,m)}for(v=_;b.l(m)>=0;){for(y=Math.max(1,Math.floor(b.m()/m.m())),w=Math.ceil(Math.log(y)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),T=d(y),g=T.j(m);D(g)||g.l(b)>0;)y-=w,T=d(y),g=T.j(m);C(T)&&(T=E),v=v.add(T),b=O(b,g)}return new W(v,b)}n.B=function(b){return Ee(this,b).h},n.and=function(b){const m=Math.max(this.g.length,b.g.length),y=[];for(let w=0;w<m;w++)y[w]=this.i(w)&b.i(w);return new a(y,this.h&b.h)},n.or=function(b){const m=Math.max(this.g.length,b.g.length),y=[];for(let w=0;w<m;w++)y[w]=this.i(w)|b.i(w);return new a(y,this.h|b.h)},n.xor=function(b){const m=Math.max(this.g.length,b.g.length),y=[];for(let w=0;w<m;w++)y[w]=this.i(w)^b.i(w);return new a(y,this.h^b.h)};function Te(b){const m=b.g.length+1,y=[];for(let w=0;w<m;w++)y[w]=b.i(w)<<1|b.i(w-1)>>>31;return new a(y,b.h)}function ce(b,m){const y=m>>5;m%=32;const w=b.g.length-y,v=[];for(let T=0;T<w;T++)v[T]=m>0?b.i(T+y)>>>m|b.i(T+y+1)<<32-m:b.i(T+y);return new a(v,b.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,du=s,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,_t=a}).apply(typeof Ec<"u"?Ec:typeof self<"u"?self:typeof window<"u"?window:{});var Ls=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var fu,zn,pu,Hs,Ci,mu,gu,yu;(function(){var n,e=Object.defineProperty;function t(i){i=[typeof globalThis=="object"&&globalThis,i,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ls=="object"&&Ls];for(var c=0;c<i.length;++c){var u=i[c];if(u&&u.Math==Math)return u}throw Error("Cannot find global object")}var s=t(this);function r(i,c){if(c)e:{var u=s;i=i.split(".");for(var f=0;f<i.length-1;f++){var I=i[f];if(!(I in u))break e;u=u[I]}i=i[i.length-1],f=u[i],c=c(f),c!=f&&c!=null&&e(u,i,{configurable:!0,writable:!0,value:c})}}r("Symbol.dispose",function(i){return i||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(i){return i||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(i){return i||function(c){var u=[],f;for(f in c)Object.prototype.hasOwnProperty.call(c,f)&&u.push([f,c[f]]);return u}});var o=o||{},a=this||self;function l(i){var c=typeof i;return c=="object"&&i!=null||c=="function"}function h(i,c,u){return i.call.apply(i.bind,arguments)}function d(i,c,u){return d=h,d.apply(null,arguments)}function p(i,c){var u=Array.prototype.slice.call(arguments,1);return function(){var f=u.slice();return f.push.apply(f,arguments),i.apply(this,f)}}function _(i,c){function u(){}u.prototype=c.prototype,i.Z=c.prototype,i.prototype=new u,i.prototype.constructor=i,i.Ob=function(f,I,x){for(var P=Array(arguments.length-2),j=2;j<arguments.length;j++)P[j-2]=arguments[j];return c.prototype[I].apply(f,P)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?i=>i&&AsyncContext.Snapshot.wrap(i):i=>i;function A(i){const c=i.length;if(c>0){const u=Array(c);for(let f=0;f<c;f++)u[f]=i[f];return u}return[]}function C(i,c){for(let f=1;f<arguments.length;f++){const I=arguments[f];var u=typeof I;if(u=u!="object"?u:I?Array.isArray(I)?"array":u:"null",u=="array"||u=="object"&&typeof I.length=="number"){u=i.length||0;const x=I.length||0;i.length=u+x;for(let P=0;P<x;P++)i[u+P]=I[P]}else i.push(I)}}class D{constructor(c,u){this.i=c,this.j=u,this.h=0,this.g=null}get(){let c;return this.h>0?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function k(i){a.setTimeout(()=>{throw i},0)}function O(){var i=b;let c=null;return i.g&&(c=i.g,i.g=i.g.next,i.g||(i.h=null),c.next=null),c}class z{constructor(){this.h=this.g=null}add(c,u){const f=W.get();f.set(c,u),this.h?this.h.next=f:this.g=f,this.h=f}}var W=new D(()=>new Ee,i=>i.reset());class Ee{constructor(){this.next=this.g=this.h=null}set(c,u){this.h=c,this.g=u,this.next=null}reset(){this.next=this.g=this.h=null}}let Te,ce=!1,b=new z,m=()=>{const i=Promise.resolve(void 0);Te=()=>{i.then(y)}};function y(){for(var i;i=O();){try{i.h.call(i.g)}catch(u){k(u)}var c=W;c.j(i),c.h<100&&(c.h++,i.next=c.g,c.g=i)}ce=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function v(i,c){this.type=i,this.g=this.target=c,this.defaultPrevented=!1}v.prototype.h=function(){this.defaultPrevented=!0};var T=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var i=!1,c=Object.defineProperty({},"passive",{get:function(){i=!0}});try{const u=()=>{};a.addEventListener("test",u,c),a.removeEventListener("test",u,c)}catch{}return i})();function g(i){return/^[\s\xa0]*$/.test(i)}function xe(i,c){v.call(this,i?i.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,i&&this.init(i,c)}_(xe,v),xe.prototype.init=function(i,c){const u=this.type=i.type,f=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;this.target=i.target||i.srcElement,this.g=c,c=i.relatedTarget,c||(u=="mouseover"?c=i.fromElement:u=="mouseout"&&(c=i.toElement)),this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType=i.pointerType,this.state=i.state,this.i=i,i.defaultPrevented&&xe.Z.h.call(this)},xe.prototype.h=function(){xe.Z.h.call(this);const i=this.i;i.preventDefault?i.preventDefault():i.returnValue=!1};var kt="closure_listenable_"+(Math.random()*1e6|0),Wh=0;function Gh(i,c,u,f,I){this.listener=i,this.proxy=null,this.src=c,this.type=u,this.capture=!!f,this.ha=I,this.key=++Wh,this.da=this.fa=!1}function bs(i){i.da=!0,i.listener=null,i.proxy=null,i.src=null,i.ha=null}function Es(i,c,u){for(const f in i)c.call(u,i[f],f,i)}function Kh(i,c){for(const u in i)c.call(void 0,i[u],u,i)}function $o(i){const c={};for(const u in i)c[u]=i[u];return c}const Ho="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Wo(i,c){let u,f;for(let I=1;I<arguments.length;I++){f=arguments[I];for(u in f)i[u]=f[u];for(let x=0;x<Ho.length;x++)u=Ho[x],Object.prototype.hasOwnProperty.call(f,u)&&(i[u]=f[u])}}function ws(i){this.src=i,this.g={},this.h=0}ws.prototype.add=function(i,c,u,f,I){const x=i.toString();i=this.g[x],i||(i=this.g[x]=[],this.h++);const P=Ur(i,c,f,I);return P>-1?(c=i[P],u||(c.fa=!1)):(c=new Gh(c,this.src,x,!!f,I),c.fa=u,i.push(c)),c};function Fr(i,c){const u=c.type;if(u in i.g){var f=i.g[u],I=Array.prototype.indexOf.call(f,c,void 0),x;(x=I>=0)&&Array.prototype.splice.call(f,I,1),x&&(bs(c),i.g[u].length==0&&(delete i.g[u],i.h--))}}function Ur(i,c,u,f){for(let I=0;I<i.length;++I){const x=i[I];if(!x.da&&x.listener==c&&x.capture==!!u&&x.ha==f)return I}return-1}var Br="closure_lm_"+(Math.random()*1e6|0),zr={};function Go(i,c,u,f,I){if(Array.isArray(c)){for(let x=0;x<c.length;x++)Go(i,c[x],u,f,I);return null}return u=Jo(u),i&&i[kt]?i.J(c,u,l(f)?!!f.capture:!1,I):Qh(i,c,u,!1,f,I)}function Qh(i,c,u,f,I,x){if(!c)throw Error("Invalid event type");const P=l(I)?!!I.capture:!!I;let j=qr(i);if(j||(i[Br]=j=new ws(i)),u=j.add(c,u,f,P,x),u.proxy)return u;if(f=Jh(),u.proxy=f,f.src=i,f.listener=u,i.addEventListener)T||(I=P),I===void 0&&(I=!1),i.addEventListener(c.toString(),f,I);else if(i.attachEvent)i.attachEvent(Qo(c.toString()),f);else if(i.addListener&&i.removeListener)i.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return u}function Jh(){function i(u){return c.call(i.src,i.listener,u)}const c=Xh;return i}function Ko(i,c,u,f,I){if(Array.isArray(c))for(var x=0;x<c.length;x++)Ko(i,c[x],u,f,I);else f=l(f)?!!f.capture:!!f,u=Jo(u),i&&i[kt]?(i=i.i,x=String(c).toString(),x in i.g&&(c=i.g[x],u=Ur(c,u,f,I),u>-1&&(bs(c[u]),Array.prototype.splice.call(c,u,1),c.length==0&&(delete i.g[x],i.h--)))):i&&(i=qr(i))&&(c=i.g[c.toString()],i=-1,c&&(i=Ur(c,u,f,I)),(u=i>-1?c[i]:null)&&jr(u))}function jr(i){if(typeof i!="number"&&i&&!i.da){var c=i.src;if(c&&c[kt])Fr(c.i,i);else{var u=i.type,f=i.proxy;c.removeEventListener?c.removeEventListener(u,f,i.capture):c.detachEvent?c.detachEvent(Qo(u),f):c.addListener&&c.removeListener&&c.removeListener(f),(u=qr(c))?(Fr(u,i),u.h==0&&(u.src=null,c[Br]=null)):bs(i)}}}function Qo(i){return i in zr?zr[i]:zr[i]="on"+i}function Xh(i,c){if(i.da)i=!0;else{c=new xe(c,this);const u=i.listener,f=i.ha||i.src;i.fa&&jr(i),i=u.call(f,c)}return i}function qr(i){return i=i[Br],i instanceof ws?i:null}var $r="__closure_events_fn_"+(Math.random()*1e9>>>0);function Jo(i){return typeof i=="function"?i:(i[$r]||(i[$r]=function(c){return i.handleEvent(c)}),i[$r])}function me(){w.call(this),this.i=new ws(this),this.M=this,this.G=null}_(me,w),me.prototype[kt]=!0,me.prototype.removeEventListener=function(i,c,u,f){Ko(this,i,c,u,f)};function we(i,c){var u,f=i.G;if(f)for(u=[];f;f=f.G)u.push(f);if(i=i.M,f=c.type||c,typeof c=="string")c=new v(c,i);else if(c instanceof v)c.target=c.target||i;else{var I=c;c=new v(f,i),Wo(c,I)}I=!0;let x,P;if(u)for(P=u.length-1;P>=0;P--)x=c.g=u[P],I=Is(x,f,!0,c)&&I;if(x=c.g=i,I=Is(x,f,!0,c)&&I,I=Is(x,f,!1,c)&&I,u)for(P=0;P<u.length;P++)x=c.g=u[P],I=Is(x,f,!1,c)&&I}me.prototype.N=function(){if(me.Z.N.call(this),this.i){var i=this.i;for(const c in i.g){const u=i.g[c];for(let f=0;f<u.length;f++)bs(u[f]);delete i.g[c],i.h--}}this.G=null},me.prototype.J=function(i,c,u,f){return this.i.add(String(i),c,!1,u,f)},me.prototype.K=function(i,c,u,f){return this.i.add(String(i),c,!0,u,f)};function Is(i,c,u,f){if(c=i.i.g[String(c)],!c)return!0;c=c.concat();let I=!0;for(let x=0;x<c.length;++x){const P=c[x];if(P&&!P.da&&P.capture==u){const j=P.listener,re=P.ha||P.src;P.fa&&Fr(i.i,P),I=j.call(re,f)!==!1&&I}}return I&&!f.defaultPrevented}function Yh(i,c){if(typeof i!="function")if(i&&typeof i.handleEvent=="function")i=d(i.handleEvent,i);else throw Error("Invalid listener argument");return Number(c)>2147483647?-1:a.setTimeout(i,c||0)}function Xo(i){i.g=Yh(()=>{i.g=null,i.i&&(i.i=!1,Xo(i))},i.l);const c=i.h;i.h=null,i.m.apply(null,c)}class Zh extends w{constructor(c,u){super(),this.m=c,this.l=u,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Xo(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function In(i){w.call(this),this.h=i,this.g={}}_(In,w);var Yo=[];function Zo(i){Es(i.g,function(c,u){this.g.hasOwnProperty(u)&&jr(c)},i),i.g={}}In.prototype.N=function(){In.Z.N.call(this),Zo(this)},In.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Hr=a.JSON.stringify,ed=a.JSON.parse,td=class{stringify(i){return a.JSON.stringify(i,void 0)}parse(i){return a.JSON.parse(i,void 0)}};function ea(){}function ta(){}var Tn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Wr(){v.call(this,"d")}_(Wr,v);function Gr(){v.call(this,"c")}_(Gr,v);var Vt={},na=null;function Ts(){return na=na||new me}Vt.Ia="serverreachability";function sa(i){v.call(this,Vt.Ia,i)}_(sa,v);function xn(i){const c=Ts();we(c,new sa(c))}Vt.STAT_EVENT="statevent";function ra(i,c){v.call(this,Vt.STAT_EVENT,i),this.stat=c}_(ra,v);function Ie(i){const c=Ts();we(c,new ra(c,i))}Vt.Ja="timingevent";function ia(i,c){v.call(this,Vt.Ja,i),this.size=c}_(ia,v);function An(i,c){if(typeof i!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){i()},c)}function Rn(){this.g=!0}Rn.prototype.ua=function(){this.g=!1};function nd(i,c,u,f,I,x){i.info(function(){if(i.g)if(x){var P="",j=x.split("&");for(let Q=0;Q<j.length;Q++){var re=j[Q].split("=");if(re.length>1){const le=re[0];re=re[1];const Me=le.split("_");P=Me.length>=2&&Me[1]=="type"?P+(le+"="+re+"&"):P+(le+"=redacted&")}}}else P=null;else P=x;return"XMLHTTP REQ ("+f+") [attempt "+I+"]: "+c+`
`+u+`
`+P})}function sd(i,c,u,f,I,x,P){i.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+I+"]: "+c+`
`+u+`
`+x+" "+P})}function Jt(i,c,u,f){i.info(function(){return"XMLHTTP TEXT ("+c+"): "+id(i,u)+(f?" "+f:"")})}function rd(i,c){i.info(function(){return"TIMEOUT: "+c})}Rn.prototype.info=function(){};function id(i,c){if(!i.g)return c;if(!c)return null;try{const x=JSON.parse(c);if(x){for(i=0;i<x.length;i++)if(Array.isArray(x[i])){var u=x[i];if(!(u.length<2)){var f=u[1];if(Array.isArray(f)&&!(f.length<1)){var I=f[0];if(I!="noop"&&I!="stop"&&I!="close")for(let P=1;P<f.length;P++)f[P]=""}}}}return Hr(x)}catch{return c}}var xs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},oa={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},aa;function Kr(){}_(Kr,ea),Kr.prototype.g=function(){return new XMLHttpRequest},aa=new Kr;function Sn(i){return encodeURIComponent(String(i))}function od(i){var c=1;i=i.split(":");const u=[];for(;c>0&&i.length;)u.push(i.shift()),c--;return i.length&&u.push(i.join(":")),u}function rt(i,c,u,f){this.j=i,this.i=c,this.l=u,this.S=f||1,this.V=new In(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ca}function ca(){this.i=null,this.g="",this.h=!1}var la={},Qr={};function Jr(i,c,u){i.M=1,i.A=Rs(Le(c)),i.u=u,i.R=!0,ua(i,null)}function ua(i,c){i.F=Date.now(),As(i),i.B=Le(i.A);var u=i.B,f=i.S;Array.isArray(f)||(f=[String(f)]),Ia(u.i,"t",f),i.C=0,u=i.j.L,i.h=new ca,i.g=za(i.j,u?c:null,!i.u),i.P>0&&(i.O=new Zh(d(i.Y,i,i.g),i.P)),c=i.V,u=i.g,f=i.ba;var I="readystatechange";Array.isArray(I)||(I&&(Yo[0]=I.toString()),I=Yo);for(let x=0;x<I.length;x++){const P=Go(u,I[x],f||c.handleEvent,!1,c.h||c);if(!P)break;c.g[P.key]=P}c=i.J?$o(i.J):{},i.u?(i.v||(i.v="POST"),c["Content-Type"]="application/x-www-form-urlencoded",i.g.ea(i.B,i.v,i.u,c)):(i.v="GET",i.g.ea(i.B,i.v,null,c)),xn(),nd(i.i,i.v,i.B,i.l,i.S,i.u)}rt.prototype.ba=function(i){i=i.target;const c=this.O;c&&at(i)==3?c.j():this.Y(i)},rt.prototype.Y=function(i){try{if(i==this.g)e:{const j=at(this.g),re=this.g.ya(),Q=this.g.ca();if(!(j<3)&&(j!=3||this.g&&(this.h.h||this.g.la()||Ca(this.g)))){this.K||j!=4||re==7||(re==8||Q<=0?xn(3):xn(2)),Xr(this);var c=this.g.ca();this.X=c;var u=ad(this);if(this.o=c==200,sd(this.i,this.v,this.B,this.l,this.S,j,c),this.o){if(this.U&&!this.L){t:{if(this.g){var f,I=this.g;if((f=I.g?I.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!g(f)){var x=f;break t}}x=null}if(i=x)Jt(this.i,this.l,i,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Yr(this,i);else{this.o=!1,this.m=3,Ie(12),Dt(this),Pn(this);break e}}if(this.R){i=!0;let le;for(;!this.K&&this.C<u.length;)if(le=cd(this,u),le==Qr){j==4&&(this.m=4,Ie(14),i=!1),Jt(this.i,this.l,null,"[Incomplete Response]");break}else if(le==la){this.m=4,Ie(15),Jt(this.i,this.l,u,"[Invalid Chunk]"),i=!1;break}else Jt(this.i,this.l,le,null),Yr(this,le);if(ha(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),j!=4||u.length!=0||this.h.h||(this.m=1,Ie(16),i=!1),this.o=this.o&&i,!i)Jt(this.i,this.l,u,"[Invalid Chunked Response]"),Dt(this),Pn(this);else if(u.length>0&&!this.W){this.W=!0;var P=this.j;P.g==this&&P.aa&&!P.P&&(P.j.info("Great, no buffering proxy detected. Bytes received: "+u.length),oi(P),P.P=!0,Ie(11))}}else Jt(this.i,this.l,u,null),Yr(this,u);j==4&&Dt(this),this.o&&!this.K&&(j==4?Ma(this.j,this):(this.o=!1,As(this)))}else wd(this.g),c==400&&u.indexOf("Unknown SID")>0?(this.m=3,Ie(12)):(this.m=0,Ie(13)),Dt(this),Pn(this)}}}catch{}};function ad(i){if(!ha(i))return i.g.la();const c=Ca(i.g);if(c==="")return"";let u="";const f=c.length,I=at(i.g)==4;if(!i.h.i){if(typeof TextDecoder>"u")return Dt(i),Pn(i),"";i.h.i=new a.TextDecoder}for(let x=0;x<f;x++)i.h.h=!0,u+=i.h.i.decode(c[x],{stream:!(I&&x==f-1)});return c.length=0,i.h.g+=u,i.C=0,i.h.g}function ha(i){return i.g?i.v=="GET"&&i.M!=2&&i.j.Aa:!1}function cd(i,c){var u=i.C,f=c.indexOf(`
`,u);return f==-1?Qr:(u=Number(c.substring(u,f)),isNaN(u)?la:(f+=1,f+u>c.length?Qr:(c=c.slice(f,f+u),i.C=f+u,c)))}rt.prototype.cancel=function(){this.K=!0,Dt(this)};function As(i){i.T=Date.now()+i.H,da(i,i.H)}function da(i,c){if(i.D!=null)throw Error("WatchDog timer not null");i.D=An(d(i.aa,i),c)}function Xr(i){i.D&&(a.clearTimeout(i.D),i.D=null)}rt.prototype.aa=function(){this.D=null;const i=Date.now();i-this.T>=0?(rd(this.i,this.B),this.M!=2&&(xn(),Ie(17)),Dt(this),this.m=2,Pn(this)):da(this,this.T-i)};function Pn(i){i.j.I==0||i.K||Ma(i.j,i)}function Dt(i){Xr(i);var c=i.O;c&&typeof c.dispose=="function"&&c.dispose(),i.O=null,Zo(i.V),i.g&&(c=i.g,i.g=null,c.abort(),c.dispose())}function Yr(i,c){try{var u=i.j;if(u.I!=0&&(u.g==i||Zr(u.h,i))){if(!i.L&&Zr(u.h,i)&&u.I==3){try{var f=u.Ba.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var I=f;if(I[0]==0){e:if(!u.v){if(u.g)if(u.g.F+3e3<i.F)Vs(u),Cs(u);else break e;ii(u),Ie(18)}}else u.xa=I[1],0<u.xa-u.K&&I[2]<37500&&u.F&&u.A==0&&!u.C&&(u.C=An(d(u.Va,u),6e3));ma(u.h)<=1&&u.ta&&(u.ta=void 0)}else Ot(u,11)}else if((i.L||u.g==i)&&Vs(u),!g(c))for(I=u.Ba.g.parse(c),c=0;c<I.length;c++){let Q=I[c];const le=Q[0];if(!(le<=u.K))if(u.K=le,Q=Q[1],u.I==2)if(Q[0]=="c"){u.M=Q[1],u.ba=Q[2];const Me=Q[3];Me!=null&&(u.ka=Me,u.j.info("VER="+u.ka));const Lt=Q[4];Lt!=null&&(u.za=Lt,u.j.info("SVER="+u.za));const ct=Q[5];ct!=null&&typeof ct=="number"&&ct>0&&(f=1.5*ct,u.O=f,u.j.info("backChannelRequestTimeoutMs_="+f)),f=u;const lt=i.g;if(lt){const Ns=lt.g?lt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ns){var x=f.h;x.g||Ns.indexOf("spdy")==-1&&Ns.indexOf("quic")==-1&&Ns.indexOf("h2")==-1||(x.j=x.l,x.g=new Set,x.h&&(ei(x,x.h),x.h=null))}if(f.G){const ai=lt.g?lt.g.getResponseHeader("X-HTTP-Session-Id"):null;ai&&(f.wa=ai,J(f.J,f.G,ai))}}u.I=3,u.l&&u.l.ra(),u.aa&&(u.T=Date.now()-i.F,u.j.info("Handshake RTT: "+u.T+"ms")),f=u;var P=i;if(f.na=Ba(f,f.L?f.ba:null,f.W),P.L){ga(f.h,P);var j=P,re=f.O;re&&(j.H=re),j.D&&(Xr(j),As(j)),f.g=P}else Oa(f);u.i.length>0&&ks(u)}else Q[0]!="stop"&&Q[0]!="close"||Ot(u,7);else u.I==3&&(Q[0]=="stop"||Q[0]=="close"?Q[0]=="stop"?Ot(u,7):ri(u):Q[0]!="noop"&&u.l&&u.l.qa(Q),u.A=0)}}xn(4)}catch{}}var ld=class{constructor(i,c){this.g=i,this.map=c}};function fa(i){this.l=i||10,a.PerformanceNavigationTiming?(i=a.performance.getEntriesByType("navigation"),i=i.length>0&&(i[0].nextHopProtocol=="hq"||i[0].nextHopProtocol=="h2")):i=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=i?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function pa(i){return i.h?!0:i.g?i.g.size>=i.j:!1}function ma(i){return i.h?1:i.g?i.g.size:0}function Zr(i,c){return i.h?i.h==c:i.g?i.g.has(c):!1}function ei(i,c){i.g?i.g.add(c):i.h=c}function ga(i,c){i.h&&i.h==c?i.h=null:i.g&&i.g.has(c)&&i.g.delete(c)}fa.prototype.cancel=function(){if(this.i=ya(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const i of this.g.values())i.cancel();this.g.clear()}};function ya(i){if(i.h!=null)return i.i.concat(i.h.G);if(i.g!=null&&i.g.size!==0){let c=i.i;for(const u of i.g.values())c=c.concat(u.G);return c}return A(i.i)}var _a=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ud(i,c){if(i){i=i.split("&");for(let u=0;u<i.length;u++){const f=i[u].indexOf("=");let I,x=null;f>=0?(I=i[u].substring(0,f),x=i[u].substring(f+1)):I=i[u],c(I,x?decodeURIComponent(x.replace(/\+/g," ")):"")}}}function it(i){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let c;i instanceof it?(this.l=i.l,Cn(this,i.j),this.o=i.o,this.g=i.g,kn(this,i.u),this.h=i.h,ti(this,Ta(i.i)),this.m=i.m):i&&(c=String(i).match(_a))?(this.l=!1,Cn(this,c[1]||"",!0),this.o=Vn(c[2]||""),this.g=Vn(c[3]||"",!0),kn(this,c[4]),this.h=Vn(c[5]||"",!0),ti(this,c[6]||"",!0),this.m=Vn(c[7]||"")):(this.l=!1,this.i=new Nn(null,this.l))}it.prototype.toString=function(){const i=[];var c=this.j;c&&i.push(Dn(c,va,!0),":");var u=this.g;return(u||c=="file")&&(i.push("//"),(c=this.o)&&i.push(Dn(c,va,!0),"@"),i.push(Sn(u).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u=this.u,u!=null&&i.push(":",String(u))),(u=this.h)&&(this.g&&u.charAt(0)!="/"&&i.push("/"),i.push(Dn(u,u.charAt(0)=="/"?fd:dd,!0))),(u=this.i.toString())&&i.push("?",u),(u=this.m)&&i.push("#",Dn(u,md)),i.join("")},it.prototype.resolve=function(i){const c=Le(this);let u=!!i.j;u?Cn(c,i.j):u=!!i.o,u?c.o=i.o:u=!!i.g,u?c.g=i.g:u=i.u!=null;var f=i.h;if(u)kn(c,i.u);else if(u=!!i.h){if(f.charAt(0)!="/")if(this.g&&!this.h)f="/"+f;else{var I=c.h.lastIndexOf("/");I!=-1&&(f=c.h.slice(0,I+1)+f)}if(I=f,I==".."||I==".")f="";else if(I.indexOf("./")!=-1||I.indexOf("/.")!=-1){f=I.lastIndexOf("/",0)==0,I=I.split("/");const x=[];for(let P=0;P<I.length;){const j=I[P++];j=="."?f&&P==I.length&&x.push(""):j==".."?((x.length>1||x.length==1&&x[0]!="")&&x.pop(),f&&P==I.length&&x.push("")):(x.push(j),f=!0)}f=x.join("/")}else f=I}return u?c.h=f:u=i.i.toString()!=="",u?ti(c,Ta(i.i)):u=!!i.m,u&&(c.m=i.m),c};function Le(i){return new it(i)}function Cn(i,c,u){i.j=u?Vn(c,!0):c,i.j&&(i.j=i.j.replace(/:$/,""))}function kn(i,c){if(c){if(c=Number(c),isNaN(c)||c<0)throw Error("Bad port number "+c);i.u=c}else i.u=null}function ti(i,c,u){c instanceof Nn?(i.i=c,gd(i.i,i.l)):(u||(c=Dn(c,pd)),i.i=new Nn(c,i.l))}function J(i,c,u){i.i.set(c,u)}function Rs(i){return J(i,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),i}function Vn(i,c){return i?c?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function Dn(i,c,u){return typeof i=="string"?(i=encodeURI(i).replace(c,hd),u&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function hd(i){return i=i.charCodeAt(0),"%"+(i>>4&15).toString(16)+(i&15).toString(16)}var va=/[#\/\?@]/g,dd=/[#\?:]/g,fd=/[#\?]/g,pd=/[#\?@]/g,md=/#/g;function Nn(i,c){this.h=this.g=null,this.i=i||null,this.j=!!c}function Nt(i){i.g||(i.g=new Map,i.h=0,i.i&&ud(i.i,function(c,u){i.add(decodeURIComponent(c.replace(/\+/g," ")),u)}))}n=Nn.prototype,n.add=function(i,c){Nt(this),this.i=null,i=Xt(this,i);let u=this.g.get(i);return u||this.g.set(i,u=[]),u.push(c),this.h+=1,this};function ba(i,c){Nt(i),c=Xt(i,c),i.g.has(c)&&(i.i=null,i.h-=i.g.get(c).length,i.g.delete(c))}function Ea(i,c){return Nt(i),c=Xt(i,c),i.g.has(c)}n.forEach=function(i,c){Nt(this),this.g.forEach(function(u,f){u.forEach(function(I){i.call(c,I,f,this)},this)},this)};function wa(i,c){Nt(i);let u=[];if(typeof c=="string")Ea(i,c)&&(u=u.concat(i.g.get(Xt(i,c))));else for(i=Array.from(i.g.values()),c=0;c<i.length;c++)u=u.concat(i[c]);return u}n.set=function(i,c){return Nt(this),this.i=null,i=Xt(this,i),Ea(this,i)&&(this.h-=this.g.get(i).length),this.g.set(i,[c]),this.h+=1,this},n.get=function(i,c){return i?(i=wa(this,i),i.length>0?String(i[0]):c):c};function Ia(i,c,u){ba(i,c),u.length>0&&(i.i=null,i.g.set(Xt(i,c),A(u)),i.h+=u.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const i=[],c=Array.from(this.g.keys());for(let f=0;f<c.length;f++){var u=c[f];const I=Sn(u);u=wa(this,u);for(let x=0;x<u.length;x++){let P=I;u[x]!==""&&(P+="="+Sn(u[x])),i.push(P)}}return this.i=i.join("&")};function Ta(i){const c=new Nn;return c.i=i.i,i.g&&(c.g=new Map(i.g),c.h=i.h),c}function Xt(i,c){return c=String(c),i.j&&(c=c.toLowerCase()),c}function gd(i,c){c&&!i.j&&(Nt(i),i.i=null,i.g.forEach(function(u,f){const I=f.toLowerCase();f!=I&&(ba(this,f),Ia(this,I,u))},i)),i.j=c}function yd(i,c){const u=new Rn;if(a.Image){const f=new Image;f.onload=p(ot,u,"TestLoadImage: loaded",!0,c,f),f.onerror=p(ot,u,"TestLoadImage: error",!1,c,f),f.onabort=p(ot,u,"TestLoadImage: abort",!1,c,f),f.ontimeout=p(ot,u,"TestLoadImage: timeout",!1,c,f),a.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=i}else c(!1)}function _d(i,c){const u=new Rn,f=new AbortController,I=setTimeout(()=>{f.abort(),ot(u,"TestPingServer: timeout",!1,c)},1e4);fetch(i,{signal:f.signal}).then(x=>{clearTimeout(I),x.ok?ot(u,"TestPingServer: ok",!0,c):ot(u,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(I),ot(u,"TestPingServer: error",!1,c)})}function ot(i,c,u,f,I){try{I&&(I.onload=null,I.onerror=null,I.onabort=null,I.ontimeout=null),f(u)}catch{}}function vd(){this.g=new td}function ni(i){this.i=i.Sb||null,this.h=i.ab||!1}_(ni,ea),ni.prototype.g=function(){return new Ss(this.i,this.h)};function Ss(i,c){me.call(this),this.H=i,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(Ss,me),n=Ss.prototype,n.open=function(i,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=i,this.D=c,this.readyState=1,Ln(this)},n.send=function(i){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const c={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};i&&(c.body=i),(this.H||a).fetch(new Request(this.D,c)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,On(this)),this.readyState=0},n.Pa=function(i){if(this.g&&(this.l=i,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=i.headers,this.readyState=2,Ln(this)),this.g&&(this.readyState=3,Ln(this),this.g)))if(this.responseType==="arraybuffer")i.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in i){if(this.j=i.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xa(this)}else i.text().then(this.Oa.bind(this),this.ga.bind(this))};function xa(i){i.j.read().then(i.Ma.bind(i)).catch(i.ga.bind(i))}n.Ma=function(i){if(this.g){if(this.o&&i.value)this.response.push(i.value);else if(!this.o){var c=i.value?i.value:new Uint8Array(0);(c=this.B.decode(c,{stream:!i.done}))&&(this.response=this.responseText+=c)}i.done?On(this):Ln(this),this.readyState==3&&xa(this)}},n.Oa=function(i){this.g&&(this.response=this.responseText=i,On(this))},n.Na=function(i){this.g&&(this.response=i,On(this))},n.ga=function(){this.g&&On(this)};function On(i){i.readyState=4,i.l=null,i.j=null,i.B=null,Ln(i)}n.setRequestHeader=function(i,c){this.A.append(i,c)},n.getResponseHeader=function(i){return this.h&&this.h.get(i.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const i=[],c=this.h.entries();for(var u=c.next();!u.done;)u=u.value,i.push(u[0]+": "+u[1]),u=c.next();return i.join(`\r
`)};function Ln(i){i.onreadystatechange&&i.onreadystatechange.call(i)}Object.defineProperty(Ss.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(i){this.m=i?"include":"same-origin"}});function Aa(i){let c="";return Es(i,function(u,f){c+=f,c+=":",c+=u,c+=`\r
`}),c}function si(i,c,u){e:{for(f in u){var f=!1;break e}f=!0}f||(u=Aa(u),typeof i=="string"?u!=null&&Sn(u):J(i,c,u))}function ee(i){me.call(this),this.headers=new Map,this.L=i||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(ee,me);var bd=/^https?$/i,Ed=["POST","PUT"];n=ee.prototype,n.Fa=function(i){this.H=i},n.ea=function(i,c,u,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+i);c=c?c.toUpperCase():"GET",this.D=i,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():aa.g(),this.g.onreadystatechange=E(d(this.Ca,this));try{this.B=!0,this.g.open(c,String(i),!0),this.B=!1}catch(x){Ra(this,x);return}if(i=u||"",u=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var I in f)u.set(I,f[I]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(const x of f.keys())u.set(x,f.get(x));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(u.keys()).find(x=>x.toLowerCase()=="content-type"),I=a.FormData&&i instanceof a.FormData,!(Array.prototype.indexOf.call(Ed,c,void 0)>=0)||f||I||u.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[x,P]of u)this.g.setRequestHeader(x,P);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(i),this.v=!1}catch(x){Ra(this,x)}};function Ra(i,c){i.h=!1,i.g&&(i.j=!0,i.g.abort(),i.j=!1),i.l=c,i.o=5,Sa(i),Ps(i)}function Sa(i){i.A||(i.A=!0,we(i,"complete"),we(i,"error"))}n.abort=function(i){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=i||7,we(this,"complete"),we(this,"abort"),Ps(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ps(this,!0)),ee.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Pa(this):this.Xa())},n.Xa=function(){Pa(this)};function Pa(i){if(i.h&&typeof o<"u"){if(i.v&&at(i)==4)setTimeout(i.Ca.bind(i),0);else if(we(i,"readystatechange"),at(i)==4){i.h=!1;try{const x=i.ca();e:switch(x){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var u;if(!(u=c)){var f;if(f=x===0){let P=String(i.D).match(_a)[1]||null;!P&&a.self&&a.self.location&&(P=a.self.location.protocol.slice(0,-1)),f=!bd.test(P?P.toLowerCase():"")}u=f}if(u)we(i,"complete"),we(i,"success");else{i.o=6;try{var I=at(i)>2?i.g.statusText:""}catch{I=""}i.l=I+" ["+i.ca()+"]",Sa(i)}}finally{Ps(i)}}}}function Ps(i,c){if(i.g){i.m&&(clearTimeout(i.m),i.m=null);const u=i.g;i.g=null,c||we(i,"ready");try{u.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function at(i){return i.g?i.g.readyState:0}n.ca=function(){try{return at(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(i){if(this.g){var c=this.g.responseText;return i&&c.indexOf(i)==0&&(c=c.substring(i.length)),ed(c)}};function Ca(i){try{if(!i.g)return null;if("response"in i.g)return i.g.response;switch(i.F){case"":case"text":return i.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in i.g)return i.g.mozResponseArrayBuffer}return null}catch{return null}}function wd(i){const c={};i=(i.g&&at(i)>=2&&i.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<i.length;f++){if(g(i[f]))continue;var u=od(i[f]);const I=u[0];if(u=u[1],typeof u!="string")continue;u=u.trim();const x=c[I]||[];c[I]=x,x.push(u)}Kh(c,function(f){return f.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Mn(i,c,u){return u&&u.internalChannelParams&&u.internalChannelParams[i]||c}function ka(i){this.za=0,this.i=[],this.j=new Rn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Mn("failFast",!1,i),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Mn("baseRetryDelayMs",5e3,i),this.Za=Mn("retryDelaySeedMs",1e4,i),this.Ta=Mn("forwardChannelMaxRetries",2,i),this.va=Mn("forwardChannelRequestTimeoutMs",2e4,i),this.ma=i&&i.xmlHttpFactory||void 0,this.Ua=i&&i.Rb||void 0,this.Aa=i&&i.useFetchStreams||!1,this.O=void 0,this.L=i&&i.supportsCrossDomainXhr||!1,this.M="",this.h=new fa(i&&i.concurrentRequestLimit),this.Ba=new vd,this.S=i&&i.fastHandshake||!1,this.R=i&&i.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=i&&i.Pb||!1,i&&i.ua&&this.j.ua(),i&&i.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&i&&i.detectBufferingProxy||!1,this.ia=void 0,i&&i.longPollingTimeout&&i.longPollingTimeout>0&&(this.ia=i.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ka.prototype,n.ka=8,n.I=1,n.connect=function(i,c,u,f){Ie(0),this.W=i,this.H=c||{},u&&f!==void 0&&(this.H.OSID=u,this.H.OAID=f),this.F=this.X,this.J=Ba(this,null,this.W),ks(this)};function ri(i){if(Va(i),i.I==3){var c=i.V++,u=Le(i.J);if(J(u,"SID",i.M),J(u,"RID",c),J(u,"TYPE","terminate"),Fn(i,u),c=new rt(i,i.j,c),c.M=2,c.A=Rs(Le(u)),u=!1,a.navigator&&a.navigator.sendBeacon)try{u=a.navigator.sendBeacon(c.A.toString(),"")}catch{}!u&&a.Image&&(new Image().src=c.A,u=!0),u||(c.g=za(c.j,null),c.g.ea(c.A)),c.F=Date.now(),As(c)}Ua(i)}function Cs(i){i.g&&(oi(i),i.g.cancel(),i.g=null)}function Va(i){Cs(i),i.v&&(a.clearTimeout(i.v),i.v=null),Vs(i),i.h.cancel(),i.m&&(typeof i.m=="number"&&a.clearTimeout(i.m),i.m=null)}function ks(i){if(!pa(i.h)&&!i.m){i.m=!0;var c=i.Ea;Te||m(),ce||(Te(),ce=!0),b.add(c,i),i.D=0}}function Id(i,c){return ma(i.h)>=i.h.j-(i.m?1:0)?!1:i.m?(i.i=c.G.concat(i.i),!0):i.I==1||i.I==2||i.D>=(i.Sa?0:i.Ta)?!1:(i.m=An(d(i.Ea,i,c),Fa(i,i.D)),i.D++,!0)}n.Ea=function(i){if(this.m)if(this.m=null,this.I==1){if(!i){this.V=Math.floor(Math.random()*1e5),i=this.V++;const I=new rt(this,this.j,i);let x=this.o;if(this.U&&(x?(x=$o(x),Wo(x,this.U)):x=this.U),this.u!==null||this.R||(I.J=x,x=null),this.S)e:{for(var c=0,u=0;u<this.i.length;u++){t:{var f=this.i[u];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,c>4096){c=u;break e}if(c===4096||u===this.i.length-1){c=u+1;break e}}c=1e3}else c=1e3;c=Na(this,I,c),u=Le(this.J),J(u,"RID",i),J(u,"CVER",22),this.G&&J(u,"X-HTTP-Session-Id",this.G),Fn(this,u),x&&(this.R?c="headers="+Sn(Aa(x))+"&"+c:this.u&&si(u,this.u,x)),ei(this.h,I),this.Ra&&J(u,"TYPE","init"),this.S?(J(u,"$req",c),J(u,"SID","null"),I.U=!0,Jr(I,u,null)):Jr(I,u,c),this.I=2}}else this.I==3&&(i?Da(this,i):this.i.length==0||pa(this.h)||Da(this))};function Da(i,c){var u;c?u=c.l:u=i.V++;const f=Le(i.J);J(f,"SID",i.M),J(f,"RID",u),J(f,"AID",i.K),Fn(i,f),i.u&&i.o&&si(f,i.u,i.o),u=new rt(i,i.j,u,i.D+1),i.u===null&&(u.J=i.o),c&&(i.i=c.G.concat(i.i)),c=Na(i,u,1e3),u.H=Math.round(i.va*.5)+Math.round(i.va*.5*Math.random()),ei(i.h,u),Jr(u,f,c)}function Fn(i,c){i.H&&Es(i.H,function(u,f){J(c,f,u)}),i.l&&Es({},function(u,f){J(c,f,u)})}function Na(i,c,u){u=Math.min(i.i.length,u);const f=i.l?d(i.l.Ka,i.l,i):null;e:{var I=i.i;let j=-1;for(;;){const re=["count="+u];j==-1?u>0?(j=I[0].g,re.push("ofs="+j)):j=0:re.push("ofs="+j);let Q=!0;for(let le=0;le<u;le++){var x=I[le].g;const Me=I[le].map;if(x-=j,x<0)j=Math.max(0,I[le].g-100),Q=!1;else try{x="req"+x+"_"||"";try{var P=Me instanceof Map?Me:Object.entries(Me);for(const[Lt,ct]of P){let lt=ct;l(ct)&&(lt=Hr(ct)),re.push(x+Lt+"="+encodeURIComponent(lt))}}catch(Lt){throw re.push(x+"type="+encodeURIComponent("_badmap")),Lt}}catch{f&&f(Me)}}if(Q){P=re.join("&");break e}}P=void 0}return i=i.i.splice(0,u),c.G=i,P}function Oa(i){if(!i.g&&!i.v){i.Y=1;var c=i.Da;Te||m(),ce||(Te(),ce=!0),b.add(c,i),i.A=0}}function ii(i){return i.g||i.v||i.A>=3?!1:(i.Y++,i.v=An(d(i.Da,i),Fa(i,i.A)),i.A++,!0)}n.Da=function(){if(this.v=null,La(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var i=4*this.T;this.j.info("BP detection timer enabled: "+i),this.B=An(d(this.Wa,this),i)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ie(10),Cs(this),La(this))};function oi(i){i.B!=null&&(a.clearTimeout(i.B),i.B=null)}function La(i){i.g=new rt(i,i.j,"rpc",i.Y),i.u===null&&(i.g.J=i.o),i.g.P=0;var c=Le(i.na);J(c,"RID","rpc"),J(c,"SID",i.M),J(c,"AID",i.K),J(c,"CI",i.F?"0":"1"),!i.F&&i.ia&&J(c,"TO",i.ia),J(c,"TYPE","xmlhttp"),Fn(i,c),i.u&&i.o&&si(c,i.u,i.o),i.O&&(i.g.H=i.O);var u=i.g;i=i.ba,u.M=1,u.A=Rs(Le(c)),u.u=null,u.R=!0,ua(u,i)}n.Va=function(){this.C!=null&&(this.C=null,Cs(this),ii(this),Ie(19))};function Vs(i){i.C!=null&&(a.clearTimeout(i.C),i.C=null)}function Ma(i,c){var u=null;if(i.g==c){Vs(i),oi(i),i.g=null;var f=2}else if(Zr(i.h,c))u=c.G,ga(i.h,c),f=1;else return;if(i.I!=0){if(c.o)if(f==1){u=c.u?c.u.length:0,c=Date.now()-c.F;var I=i.D;f=Ts(),we(f,new ia(f,u)),ks(i)}else Oa(i);else if(I=c.m,I==3||I==0&&c.X>0||!(f==1&&Id(i,c)||f==2&&ii(i)))switch(u&&u.length>0&&(c=i.h,c.i=c.i.concat(u)),I){case 1:Ot(i,5);break;case 4:Ot(i,10);break;case 3:Ot(i,6);break;default:Ot(i,2)}}}function Fa(i,c){let u=i.Qa+Math.floor(Math.random()*i.Za);return i.isActive()||(u*=2),u*c}function Ot(i,c){if(i.j.info("Error code "+c),c==2){var u=d(i.bb,i),f=i.Ua;const I=!f;f=new it(f||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Cn(f,"https"),Rs(f),I?yd(f.toString(),u):_d(f.toString(),u)}else Ie(2);i.I=0,i.l&&i.l.pa(c),Ua(i),Va(i)}n.bb=function(i){i?(this.j.info("Successfully pinged google.com"),Ie(2)):(this.j.info("Failed to ping google.com"),Ie(1))};function Ua(i){if(i.I=0,i.ja=[],i.l){const c=ya(i.h);(c.length!=0||i.i.length!=0)&&(C(i.ja,c),C(i.ja,i.i),i.h.i.length=0,A(i.i),i.i.length=0),i.l.oa()}}function Ba(i,c,u){var f=u instanceof it?Le(u):new it(u);if(f.g!="")c&&(f.g=c+"."+f.g),kn(f,f.u);else{var I=a.location;f=I.protocol,c=c?c+"."+I.hostname:I.hostname,I=+I.port;const x=new it(null);f&&Cn(x,f),c&&(x.g=c),I&&kn(x,I),u&&(x.h=u),f=x}return u=i.G,c=i.wa,u&&c&&J(f,u,c),J(f,"VER",i.ka),Fn(i,f),f}function za(i,c,u){if(c&&!i.L)throw Error("Can't create secondary domain capable XhrIo object.");return c=i.Aa&&!i.ma?new ee(new ni({ab:u})):new ee(i.ma),c.Fa(i.L),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ja(){}n=ja.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ds(){}Ds.prototype.g=function(i,c){return new Se(i,c)};function Se(i,c){me.call(this),this.g=new ka(c),this.l=i,this.h=c&&c.messageUrlParams||null,i=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(i?i["X-Client-Protocol"]="webchannel":i={"X-Client-Protocol":"webchannel"}),this.g.o=i,i=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(i?i["X-WebChannel-Content-Type"]=c.messageContentType:i={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.sa&&(i?i["X-WebChannel-Client-Profile"]=c.sa:i={"X-WebChannel-Client-Profile":c.sa}),this.g.U=i,(i=c&&c.Qb)&&!g(i)&&(this.g.u=i),this.A=c&&c.supportsCrossDomainXhr||!1,this.v=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!g(c)&&(this.g.G=c,i=this.h,i!==null&&c in i&&(i=this.h,c in i&&delete i[c])),this.j=new Yt(this)}_(Se,me),Se.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Se.prototype.close=function(){ri(this.g)},Se.prototype.o=function(i){var c=this.g;if(typeof i=="string"){var u={};u.__data__=i,i=u}else this.v&&(u={},u.__data__=Hr(i),i=u);c.i.push(new ld(c.Ya++,i)),c.I==3&&ks(c)},Se.prototype.N=function(){this.g.l=null,delete this.j,ri(this.g),delete this.g,Se.Z.N.call(this)};function qa(i){Wr.call(this),i.__headers__&&(this.headers=i.__headers__,this.statusCode=i.__status__,delete i.__headers__,delete i.__status__);var c=i.__sm__;if(c){e:{for(const u in c){i=u;break e}i=void 0}(this.i=i)&&(i=this.i,c=c!==null&&i in c?c[i]:void 0),this.data=c}else this.data=i}_(qa,Wr);function $a(){Gr.call(this),this.status=1}_($a,Gr);function Yt(i){this.g=i}_(Yt,ja),Yt.prototype.ra=function(){we(this.g,"a")},Yt.prototype.qa=function(i){we(this.g,new qa(i))},Yt.prototype.pa=function(i){we(this.g,new $a)},Yt.prototype.oa=function(){we(this.g,"b")},Ds.prototype.createWebChannel=Ds.prototype.g,Se.prototype.send=Se.prototype.o,Se.prototype.open=Se.prototype.m,Se.prototype.close=Se.prototype.close,yu=function(){return new Ds},gu=function(){return Ts()},mu=Vt,Ci={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},xs.NO_ERROR=0,xs.TIMEOUT=8,xs.HTTP_ERROR=6,Hs=xs,oa.COMPLETE="complete",pu=oa,ta.EventType=Tn,Tn.OPEN="a",Tn.CLOSE="b",Tn.ERROR="c",Tn.MESSAGE="d",me.prototype.listen=me.prototype.J,zn=ta,ee.prototype.listenOnce=ee.prototype.K,ee.prototype.getLastError=ee.prototype.Ha,ee.prototype.getLastErrorCode=ee.prototype.ya,ee.prototype.getStatus=ee.prototype.ca,ee.prototype.getResponseJson=ee.prototype.La,ee.prototype.getResponseText=ee.prototype.la,ee.prototype.send=ee.prototype.ea,ee.prototype.setWithCredentials=ee.prototype.Fa,fu=ee}).apply(typeof Ls<"u"?Ls:typeof self<"u"?self:typeof window<"u"?window:{});const wc="@firebase/firestore",Ic="4.9.3";class ye{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ye.UNAUTHENTICATED=new ye(null),ye.GOOGLE_CREDENTIALS=new ye("google-credentials-uid"),ye.FIRST_PARTY=new ye("first-party-uid"),ye.MOCK_USER=new ye("mock-user");let vn="12.7.0";const $t=new Gi("@firebase/firestore");function Zt(){return $t.logLevel}function V(n,...e){if($t.logLevel<=q.DEBUG){const t=e.map(oo);$t.debug(`Firestore (${vn}): ${n}`,...t)}}function tt(n,...e){if($t.logLevel<=q.ERROR){const t=e.map(oo);$t.error(`Firestore (${vn}): ${n}`,...t)}}function ln(n,...e){if($t.logLevel<=q.WARN){const t=e.map(oo);$t.warn(`Firestore (${vn}): ${n}`,...t)}}function oo(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function F(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,_u(n,s,t)}function _u(n,e,t){let s=`FIRESTORE (${vn}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw tt(s),new Error(s)}function K(n,e,t,s){let r="Unexpected state";typeof t=="string"?r=t:s=t,n||_u(e,r,s)}function B(n,e){return n}const S={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class N extends st{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class vt{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class vu{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Rg{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ye.UNAUTHENTICATED)))}shutdown(){}}class Sg{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Pg{constructor(e){this.t=e,this.currentUser=ye.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){K(this.o===void 0,42304);let s=this.i;const r=h=>this.i!==s?(s=this.i,t(h)):Promise.resolve();let o=new vt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new vt,e.enqueueRetryable((()=>r(this.currentUser)))};const a=()=>{const h=o;e.enqueueRetryable((async()=>{await h.promise,await r(this.currentUser)}))},l=h=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((h=>l(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?l(h):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new vt)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(K(typeof s.accessToken=="string",31837,{l:s}),new vu(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return K(e===null||typeof e=="string",2055,{h:e}),new ye(e)}}class Cg{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=ye.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class kg{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new Cg(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ye.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Tc{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Vg{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Pe(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){K(this.o===void 0,3512);const s=o=>{o.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,V("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>s(o)))};const r=o=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>r(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?r(o):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Tc(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(K(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Tc(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Dg(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}class ao{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=Dg(40);for(let o=0;o<r.length;++o)s.length<20&&r[o]<t&&(s+=e.charAt(r[o]%62))}return s}}function $(n,e){return n<e?-1:n>e?1:0}function ki(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const r=n.charAt(s),o=e.charAt(s);if(r!==o)return mi(r)===mi(o)?$(r,o):mi(r)?1:-1}return $(n.length,e.length)}const Ng=55296,Og=57343;function mi(n){const e=n.charCodeAt(0);return e>=Ng&&e<=Og}function un(n,e,t){return n.length===e.length&&n.every(((s,r)=>t(s,e[r])))}const xc="__name__";class Ue{constructor(e,t,s){t===void 0?t=0:t>e.length&&F(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&F(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Ue.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ue?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const o=Ue.compareSegments(e.get(r),t.get(r));if(o!==0)return o}return $(e.length,t.length)}static compareSegments(e,t){const s=Ue.isNumericId(e),r=Ue.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?Ue.extractNumericId(e).compare(Ue.extractNumericId(t)):ki(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _t.fromString(e.substring(4,e.length-2))}}class Y extends Ue{construct(e,t,s){return new Y(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new N(S.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((r=>r.length>0)))}return new Y(t)}static emptyPath(){return new Y([])}}const Lg=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fe extends Ue{construct(e,t,s){return new fe(e,t,s)}static isValidIdentifier(e){return Lg.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fe.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===xc}static keyField(){return new fe([xc])}static fromServerFormat(e){const t=[];let s="",r=0;const o=()=>{if(s.length===0)throw new N(S.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let a=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new N(S.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[r+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new N(S.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=h,r+=2}else l==="`"?(a=!a,r++):l!=="."||a?(s+=l,r++):(o(),r++)}if(o(),a)throw new N(S.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fe(t)}static emptyPath(){return new fe([])}}class L{constructor(e){this.path=e}static fromPath(e){return new L(Y.fromString(e))}static fromName(e){return new L(Y.fromString(e).popFirst(5))}static empty(){return new L(Y.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Y.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Y.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new L(new Y(e.slice()))}}function Mg(n,e,t){if(!t)throw new N(S.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Fg(n,e,t,s){if(e===!0&&s===!0)throw new N(S.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Ac(n){if(!L.isDocumentKey(n))throw new N(S.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function bu(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function co(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":F(12329,{type:typeof n})}function Ht(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new N(S.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=co(n);throw new N(S.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function se(n,e){const t={typeString:n};return e&&(t.value=e),t}function ms(n,e){if(!bu(n))throw new N(S.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const r=e[s].typeString,o="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const a=n[s];if(r&&typeof a!==r){t=`JSON field '${s}' must be a ${r}.`;break}if(o!==void 0&&a!==o.value){t=`Expected '${s}' field to equal '${o.value}'`;break}}if(t)throw new N(S.INVALID_ARGUMENT,t);return!0}const Rc=-62135596800,Sc=1e6;class X{static now(){return X.fromMillis(Date.now())}static fromDate(e){return X.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*Sc);return new X(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new N(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new N(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Rc)throw new N(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new N(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Sc}_compareTo(e){return this.seconds===e.seconds?$(this.nanoseconds,e.nanoseconds):$(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:X._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ms(e,X._jsonSchema))return new X(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Rc;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}X._jsonSchemaVersion="firestore/timestamp/1.0",X._jsonSchema={type:se("string",X._jsonSchemaVersion),seconds:se("number"),nanoseconds:se("number")};class U{static fromTimestamp(e){return new U(e)}static min(){return new U(new X(0,0))}static max(){return new U(new X(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ns=-1;function Ug(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=U.fromTimestamp(s===1e9?new X(t+1,0):new X(t,s));return new bt(r,L.empty(),e)}function Bg(n){return new bt(n.readTime,n.key,ns)}class bt{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new bt(U.min(),L.empty(),ns)}static max(){return new bt(U.max(),L.empty(),ns)}}function zg(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(n.documentKey,e.documentKey),t!==0?t:$(n.largestBatchId,e.largestBatchId))}const jg="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class qg{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function bn(n){if(n.code!==S.FAILED_PRECONDITION||n.message!==jg)throw n;V("LocalStore","Unexpectedly lost primary lease")}class R{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&F(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new R(((s,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(s,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(s,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof R?t:R.resolve(t)}catch(t){return R.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):R.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):R.reject(t)}static resolve(e){return new R(((t,s)=>{t(e)}))}static reject(e){return new R(((t,s)=>{s(e)}))}static waitFor(e){return new R(((t,s)=>{let r=0,o=0,a=!1;e.forEach((l=>{++r,l.next((()=>{++o,a&&o===r&&t()}),(h=>s(h)))})),a=!0,o===r&&t()}))}static or(e){let t=R.resolve(!1);for(const s of e)t=t.next((r=>r?R.resolve(r):s()));return t}static forEach(e,t){const s=[];return e.forEach(((r,o)=>{s.push(t.call(this,r,o))})),this.waitFor(s)}static mapArray(e,t){return new R(((s,r)=>{const o=e.length,a=new Array(o);let l=0;for(let h=0;h<o;h++){const d=h;t(e[d]).next((p=>{a[d]=p,++l,l===o&&s(a)}),(p=>r(p)))}}))}static doWhile(e,t){return new R(((s,r)=>{const o=()=>{e()===!0?t().next((()=>{o()}),r):s()};o()}))}}function $g(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function En(n){return n.name==="IndexedDbTransactionError"}class br{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}br.ce=-1;const lo=-1;function Er(n){return n==null}function ir(n){return n===0&&1/n==-1/0}function Hg(n){return typeof n=="number"&&Number.isInteger(n)&&!ir(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Eu="";function Wg(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Pc(e)),e=Gg(n.get(t),e);return Pc(e)}function Gg(n,e){let t=e;const s=n.length;for(let r=0;r<s;r++){const o=n.charAt(r);switch(o){case"\0":t+="";break;case Eu:t+="";break;default:t+=o}}return t}function Pc(n){return n+Eu+""}function Cc(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Pt(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function wu(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Z{constructor(e,t){this.comparator=e,this.root=t||de.EMPTY}insert(e,t){return new Z(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,de.BLACK,null,null))}remove(e){return new Z(this.comparator,this.root.remove(e,this.comparator).copy(null,null,de.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ms(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ms(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ms(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ms(this.root,e,this.comparator,!0)}}class Ms{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?s(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class de{constructor(e,t,s,r,o){this.key=e,this.value=t,this.color=s??de.RED,this.left=r??de.EMPTY,this.right=o??de.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,o){return new de(e??this.key,t??this.value,s??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const o=s(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,s),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return de.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return de.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,de.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,de.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw F(43730,{key:this.key,value:this.value});if(this.right.isRed())throw F(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw F(27949);return e+(this.isRed()?0:1)}}de.EMPTY=null,de.RED=!0,de.BLACK=!1;de.EMPTY=new class{constructor(){this.size=0}get key(){throw F(57766)}get value(){throw F(16141)}get color(){throw F(16727)}get left(){throw F(29726)}get right(){throw F(36894)}copy(e,t,s,r,o){return this}insert(e,t,s){return new de(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ae{constructor(e){this.comparator=e,this.data=new Z(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new kc(this.data.getIterator())}getIteratorFrom(e){return new kc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof ae)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,o=s.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new ae(this.comparator);return t.data=e,t}}class kc{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ce{constructor(e){this.fields=e,e.sort(fe.comparator)}static empty(){return new Ce([])}unionWith(e){let t=new ae(fe.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Ce(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return un(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}class Iu extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class pe{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Iu("Invalid base64 string: "+o):o}})(e);return new pe(t)}static fromUint8Array(e){const t=(function(r){let o="";for(let a=0;a<r.length;++a)o+=String.fromCharCode(r[a]);return o})(e);return new pe(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pe.EMPTY_BYTE_STRING=new pe("");const Kg=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Et(n){if(K(!!n,39018),typeof n=="string"){let e=0;const t=Kg.exec(n);if(K(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:te(n.seconds),nanos:te(n.nanos)}}function te(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wt(n){return typeof n=="string"?pe.fromBase64String(n):pe.fromUint8Array(n)}const Tu="server_timestamp",xu="__type__",Au="__previous_value__",Ru="__local_write_time__";function uo(n){return(n?.mapValue?.fields||{})[xu]?.stringValue===Tu}function wr(n){const e=n.mapValue.fields[Au];return uo(e)?wr(e):e}function ss(n){const e=Et(n.mapValue.fields[Ru].timestampValue);return new X(e.seconds,e.nanos)}class Qg{constructor(e,t,s,r,o,a,l,h,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=p}}const or="(default)";class rs{constructor(e,t){this.projectId=e,this.database=t||or}static empty(){return new rs("","")}get isDefaultDatabase(){return this.database===or}isEqual(e){return e instanceof rs&&e.projectId===this.projectId&&e.database===this.database}}const Su="__type__",Jg="__max__",Fs={mapValue:{}},Pu="__vector__",ar="value";function It(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?uo(n)?4:Yg(n)?9007199254740991:Xg(n)?10:11:F(28295,{value:n})}function We(n,e){if(n===e)return!0;const t=It(n);if(t!==It(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ss(n).isEqual(ss(e));case 3:return(function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;const a=Et(r.timestampValue),l=Et(o.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,o){return wt(r.bytesValue).isEqual(wt(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,o){return te(r.geoPointValue.latitude)===te(o.geoPointValue.latitude)&&te(r.geoPointValue.longitude)===te(o.geoPointValue.longitude)})(n,e);case 2:return(function(r,o){if("integerValue"in r&&"integerValue"in o)return te(r.integerValue)===te(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){const a=te(r.doubleValue),l=te(o.doubleValue);return a===l?ir(a)===ir(l):isNaN(a)&&isNaN(l)}return!1})(n,e);case 9:return un(n.arrayValue.values||[],e.arrayValue.values||[],We);case 10:case 11:return(function(r,o){const a=r.mapValue.fields||{},l=o.mapValue.fields||{};if(Cc(a)!==Cc(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(l[h]===void 0||!We(a[h],l[h])))return!1;return!0})(n,e);default:return F(52216,{left:n})}}function is(n,e){return(n.values||[]).find((t=>We(t,e)))!==void 0}function hn(n,e){if(n===e)return 0;const t=It(n),s=It(e);if(t!==s)return $(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return $(n.booleanValue,e.booleanValue);case 2:return(function(o,a){const l=te(o.integerValue||o.doubleValue),h=te(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1})(n,e);case 3:return Vc(n.timestampValue,e.timestampValue);case 4:return Vc(ss(n),ss(e));case 5:return ki(n.stringValue,e.stringValue);case 6:return(function(o,a){const l=wt(o),h=wt(a);return l.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(o,a){const l=o.split("/"),h=a.split("/");for(let d=0;d<l.length&&d<h.length;d++){const p=$(l[d],h[d]);if(p!==0)return p}return $(l.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,a){const l=$(te(o.latitude),te(a.latitude));return l!==0?l:$(te(o.longitude),te(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Dc(n.arrayValue,e.arrayValue);case 10:return(function(o,a){const l=o.fields||{},h=a.fields||{},d=l[ar]?.arrayValue,p=h[ar]?.arrayValue,_=$(d?.values?.length||0,p?.values?.length||0);return _!==0?_:Dc(d,p)})(n.mapValue,e.mapValue);case 11:return(function(o,a){if(o===Fs.mapValue&&a===Fs.mapValue)return 0;if(o===Fs.mapValue)return 1;if(a===Fs.mapValue)return-1;const l=o.fields||{},h=Object.keys(l),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let _=0;_<h.length&&_<p.length;++_){const E=ki(h[_],p[_]);if(E!==0)return E;const A=hn(l[h[_]],d[p[_]]);if(A!==0)return A}return $(h.length,p.length)})(n.mapValue,e.mapValue);default:throw F(23264,{he:t})}}function Vc(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return $(n,e);const t=Et(n),s=Et(e),r=$(t.seconds,s.seconds);return r!==0?r:$(t.nanos,s.nanos)}function Dc(n,e){const t=n.values||[],s=e.values||[];for(let r=0;r<t.length&&r<s.length;++r){const o=hn(t[r],s[r]);if(o)return o}return $(t.length,s.length)}function dn(n){return Vi(n)}function Vi(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Et(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return wt(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return L.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",r=!0;for(const o of t.values||[])r?r=!1:s+=",",s+=Vi(o);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let r="{",o=!0;for(const a of s)o?o=!1:r+=",",r+=`${a}:${Vi(t.fields[a])}`;return r+"}"})(n.mapValue):F(61005,{value:n})}function Ws(n){switch(It(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wr(n);return e?16+Ws(e):16;case 5:return 2*n.stringValue.length;case 6:return wt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((r,o)=>r+Ws(o)),0)})(n.arrayValue);case 10:case 11:return(function(s){let r=0;return Pt(s.fields,((o,a)=>{r+=o.length+Ws(a)})),r})(n.mapValue);default:throw F(13486,{value:n})}}function Di(n){return!!n&&"integerValue"in n}function ho(n){return!!n&&"arrayValue"in n}function Nc(n){return!!n&&"nullValue"in n}function Oc(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Gs(n){return!!n&&"mapValue"in n}function Xg(n){return(n?.mapValue?.fields||{})[Su]?.stringValue===Pu}function Kn(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Pt(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Kn(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Kn(n.arrayValue.values[t]);return e}return{...n}}function Yg(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Jg}class Re{constructor(e){this.value=e}static empty(){return new Re({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Gs(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kn(t)}setAll(e){let t=fe.emptyPath(),s={},r=[];e.forEach(((a,l)=>{if(!t.isImmediateParentOf(l)){const h=this.getFieldsMap(t);this.applyChanges(h,s,r),s={},r=[],t=l.popLast()}a?s[l.lastSegment()]=Kn(a):r.push(l.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,s,r)}delete(e){const t=this.field(e.popLast());Gs(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return We(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];Gs(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){Pt(t,((r,o)=>e[r]=o));for(const r of s)delete e[r]}clone(){return new Re(Kn(this.value))}}function Cu(n){const e=[];return Pt(n.fields,((t,s)=>{const r=new fe([t]);if(Gs(s)){const o=Cu(s.mapValue).fields;if(o.length===0)e.push(r);else for(const a of o)e.push(r.child(a))}else e.push(r)})),new Ce(e)}class _e{constructor(e,t,s,r,o,a,l){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=o,this.data=a,this.documentState=l}static newInvalidDocument(e){return new _e(e,0,U.min(),U.min(),U.min(),Re.empty(),0)}static newFoundDocument(e,t,s,r){return new _e(e,1,t,U.min(),s,r,0)}static newNoDocument(e,t){return new _e(e,2,t,U.min(),U.min(),Re.empty(),0)}static newUnknownDocument(e,t){return new _e(e,3,t,U.min(),U.min(),Re.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(U.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Re.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Re.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=U.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof _e&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class cr{constructor(e,t){this.position=e,this.inclusive=t}}function Lc(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const o=e[r],a=n.position[r];if(o.field.isKeyField()?s=L.comparator(L.fromName(a.referenceValue),t.key):s=hn(a,t.data.field(o.field)),o.dir==="desc"&&(s*=-1),s!==0)break}return s}function Mc(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!We(n.position[t],e.position[t]))return!1;return!0}class lr{constructor(e,t="asc"){this.field=e,this.dir=t}}function Zg(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class ku{}class ie extends ku{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new ty(e,t,s):t==="array-contains"?new ry(e,s):t==="in"?new iy(e,s):t==="not-in"?new oy(e,s):t==="array-contains-any"?new ay(e,s):new ie(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new ny(e,s):new sy(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(hn(t,this.value)):t!==null&&It(this.value)===It(t)&&this.matchesComparison(hn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return F(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ge extends ku{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ge(e,t)}matches(e){return Vu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Vu(n){return n.op==="and"}function Du(n){return ey(n)&&Vu(n)}function ey(n){for(const e of n.filters)if(e instanceof Ge)return!1;return!0}function Ni(n){if(n instanceof ie)return n.field.canonicalString()+n.op.toString()+dn(n.value);if(Du(n))return n.filters.map((e=>Ni(e))).join(",");{const e=n.filters.map((t=>Ni(t))).join(",");return`${n.op}(${e})`}}function Nu(n,e){return n instanceof ie?(function(s,r){return r instanceof ie&&s.op===r.op&&s.field.isEqual(r.field)&&We(s.value,r.value)})(n,e):n instanceof Ge?(function(s,r){return r instanceof Ge&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce(((o,a,l)=>o&&Nu(a,r.filters[l])),!0):!1})(n,e):void F(19439)}function Ou(n){return n instanceof ie?(function(t){return`${t.field.canonicalString()} ${t.op} ${dn(t.value)}`})(n):n instanceof Ge?(function(t){return t.op.toString()+" {"+t.getFilters().map(Ou).join(" ,")+"}"})(n):"Filter"}class ty extends ie{constructor(e,t,s){super(e,t,s),this.key=L.fromName(s.referenceValue)}matches(e){const t=L.comparator(e.key,this.key);return this.matchesComparison(t)}}class ny extends ie{constructor(e,t){super(e,"in",t),this.keys=Lu("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class sy extends ie{constructor(e,t){super(e,"not-in",t),this.keys=Lu("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Lu(n,e){return(e.arrayValue?.values||[]).map((t=>L.fromName(t.referenceValue)))}class ry extends ie{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ho(t)&&is(t.arrayValue,this.value)}}class iy extends ie{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&is(this.value.arrayValue,t)}}class oy extends ie{constructor(e,t){super(e,"not-in",t)}matches(e){if(is(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!is(this.value.arrayValue,t)}}class ay extends ie{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ho(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>is(this.value.arrayValue,s)))}}class cy{constructor(e,t=null,s=[],r=[],o=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=o,this.startAt=a,this.endAt=l,this.Te=null}}function Fc(n,e=null,t=[],s=[],r=null,o=null,a=null){return new cy(n,e,t,s,r,o,a)}function fo(n){const e=B(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Ni(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(o){return o.field.canonicalString()+o.dir})(s))).join(","),Er(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>dn(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>dn(s))).join(",")),e.Te=t}return e.Te}function po(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Zg(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Nu(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Mc(n.startAt,e.startAt)&&Mc(n.endAt,e.endAt)}function Oi(n){return L.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Ir{constructor(e,t=null,s=[],r=[],o=null,a="F",l=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=o,this.limitType=a,this.startAt=l,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ly(n,e,t,s,r,o,a,l){return new Ir(n,e,t,s,r,o,a,l)}function mo(n){return new Ir(n)}function Uc(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function uy(n){return n.collectionGroup!==null}function Qn(n){const e=B(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new ae(fe.comparator);return a.filters.forEach((h=>{h.getFlattenedFilters().forEach((d=>{d.isInequality()&&(l=l.add(d.field))}))})),l})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new lr(o,s))})),t.has(fe.keyField().canonicalString())||e.Ie.push(new lr(fe.keyField(),s))}return e.Ie}function ze(n){const e=B(n);return e.Ee||(e.Ee=hy(e,Qn(n))),e.Ee}function hy(n,e){if(n.limitType==="F")return Fc(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const o=r.dir==="desc"?"asc":"desc";return new lr(r.field,o)}));const t=n.endAt?new cr(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new cr(n.startAt.position,n.startAt.inclusive):null;return Fc(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Li(n,e,t){return new Ir(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Tr(n,e){return po(ze(n),ze(e))&&n.limitType===e.limitType}function Mu(n){return`${fo(ze(n))}|lt:${n.limitType}`}function en(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((r=>Ou(r))).join(", ")}]`),Er(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((r=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(r))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((r=>dn(r))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((r=>dn(r))).join(",")),`Target(${s})`})(ze(n))}; limitType=${n.limitType})`}function xr(n,e){return e.isFoundDocument()&&(function(s,r){const o=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(o):L.isDocumentKey(s.path)?s.path.isEqual(o):s.path.isImmediateParentOf(o)})(n,e)&&(function(s,r){for(const o of Qn(s))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(s,r){for(const o of s.filters)if(!o.matches(r))return!1;return!0})(n,e)&&(function(s,r){return!(s.startAt&&!(function(a,l,h){const d=Lc(a,l,h);return a.inclusive?d<=0:d<0})(s.startAt,Qn(s),r)||s.endAt&&!(function(a,l,h){const d=Lc(a,l,h);return a.inclusive?d>=0:d>0})(s.endAt,Qn(s),r))})(n,e)}function dy(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Fu(n){return(e,t)=>{let s=!1;for(const r of Qn(n)){const o=fy(r,e,t);if(o!==0)return o;s=s||r.field.isKeyField()}return 0}}function fy(n,e,t){const s=n.field.isKeyField()?L.comparator(e.key,t.key):(function(o,a,l){const h=a.data.field(o),d=l.data.field(o);return h!==null&&d!==null?hn(h,d):F(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return F(19790,{direction:n.dir})}}class Gt{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,o]of s)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Pt(this.inner,((t,s)=>{for(const[r,o]of s)e(r,o)}))}isEmpty(){return wu(this.inner)}size(){return this.innerSize}}const py=new Z(L.comparator);function nt(){return py}const Uu=new Z(L.comparator);function jn(...n){let e=Uu;for(const t of n)e=e.insert(t.key,t);return e}function Bu(n){let e=Uu;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function Ut(){return Jn()}function zu(){return Jn()}function Jn(){return new Gt((n=>n.toString()),((n,e)=>n.isEqual(e)))}const my=new Z(L.comparator),gy=new ae(L.comparator);function H(...n){let e=gy;for(const t of n)e=e.add(t);return e}const yy=new ae($);function _y(){return yy}function go(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ir(e)?"-0":e}}function ju(n){return{integerValue:""+n}}function vy(n,e){return Hg(e)?ju(e):go(n,e)}class Ar{constructor(){this._=void 0}}function by(n,e,t){return n instanceof os?(function(r,o){const a={fields:{[xu]:{stringValue:Tu},[Ru]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&uo(o)&&(o=wr(o)),o&&(a.fields[Au]=o),{mapValue:a}})(t,e):n instanceof as?$u(n,e):n instanceof cs?Hu(n,e):(function(r,o){const a=qu(r,o),l=Bc(a)+Bc(r.Ae);return Di(a)&&Di(r.Ae)?ju(l):go(r.serializer,l)})(n,e)}function Ey(n,e,t){return n instanceof as?$u(n,e):n instanceof cs?Hu(n,e):t}function qu(n,e){return n instanceof ur?(function(s){return Di(s)||(function(o){return!!o&&"doubleValue"in o})(s)})(e)?e:{integerValue:0}:null}class os extends Ar{}class as extends Ar{constructor(e){super(),this.elements=e}}function $u(n,e){const t=Wu(e);for(const s of n.elements)t.some((r=>We(r,s)))||t.push(s);return{arrayValue:{values:t}}}class cs extends Ar{constructor(e){super(),this.elements=e}}function Hu(n,e){let t=Wu(e);for(const s of n.elements)t=t.filter((r=>!We(r,s)));return{arrayValue:{values:t}}}class ur extends Ar{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Bc(n){return te(n.integerValue||n.doubleValue)}function Wu(n){return ho(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class wy{constructor(e,t){this.field=e,this.transform=t}}function Iy(n,e){return n.field.isEqual(e.field)&&(function(s,r){return s instanceof as&&r instanceof as||s instanceof cs&&r instanceof cs?un(s.elements,r.elements,We):s instanceof ur&&r instanceof ur?We(s.Ae,r.Ae):s instanceof os&&r instanceof os})(n.transform,e.transform)}class Ty{constructor(e,t){this.version=e,this.transformResults=t}}class je{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new je}static exists(e){return new je(void 0,e)}static updateTime(e){return new je(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ks(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Rr{}function Gu(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Qu(n.key,je.none()):new gs(n.key,n.data,je.none());{const t=n.data,s=Re.empty();let r=new ae(fe.comparator);for(let o of e.fields)if(!r.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?s.delete(o):s.set(o,a),r=r.add(o)}return new Ct(n.key,s,new Ce(r.toArray()),je.none())}}function xy(n,e,t){n instanceof gs?(function(r,o,a){const l=r.value.clone(),h=jc(r.fieldTransforms,o,a.transformResults);l.setAll(h),o.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Ct?(function(r,o,a){if(!Ks(r.precondition,o))return void o.convertToUnknownDocument(a.version);const l=jc(r.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(Ku(r)),h.setAll(l),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()})(n,e,t):(function(r,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Xn(n,e,t,s){return n instanceof gs?(function(o,a,l,h){if(!Ks(o.precondition,a))return l;const d=o.value.clone(),p=qc(o.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null})(n,e,t,s):n instanceof Ct?(function(o,a,l,h){if(!Ks(o.precondition,a))return l;const d=qc(o.fieldTransforms,h,a),p=a.data;return p.setAll(Ku(o)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((_=>_.field)))})(n,e,t,s):(function(o,a,l){return Ks(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l})(n,e,t)}function Ay(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),o=qu(s.transform,r||null);o!=null&&(t===null&&(t=Re.empty()),t.set(s.field,o))}return t||null}function zc(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&un(s,r,((o,a)=>Iy(o,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class gs extends Rr{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ct extends Rr{constructor(e,t,s,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Ku(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function jc(n,e,t){const s=new Map;K(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const o=n[r],a=o.transform,l=e.data.field(o.field);s.set(o.field,Ey(a,l,t[r]))}return s}function qc(n,e,t){const s=new Map;for(const r of n){const o=r.transform,a=t.data.field(r.field);s.set(r.field,by(o,a,e))}return s}class Qu extends Rr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ry extends Rr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Sy{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const o=this.mutations[r];o.key.isEqual(e.key)&&xy(o,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Xn(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Xn(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=zu();return this.mutations.forEach((r=>{const o=e.get(r.key),a=o.overlayedDocument;let l=this.applyToLocalView(a,o.mutatedFields);l=t.has(r.key)?null:l;const h=Gu(a,l);h!==null&&s.set(r.key,h),a.isValidDocument()||a.convertToNoDocument(U.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),H())}isEqual(e){return this.batchId===e.batchId&&un(this.mutations,e.mutations,((t,s)=>zc(t,s)))&&un(this.baseMutations,e.baseMutations,((t,s)=>zc(t,s)))}}class yo{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){K(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=(function(){return my})();const o=e.mutations;for(let a=0;a<o.length;a++)r=r.insert(o[a].key,s[a].version);return new yo(e,t,s,r)}}class Py{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Cy{constructor(e,t){this.count=e,this.unchangedNames=t}}var ne,G;function ky(n){switch(n){case S.OK:return F(64938);case S.CANCELLED:case S.UNKNOWN:case S.DEADLINE_EXCEEDED:case S.RESOURCE_EXHAUSTED:case S.INTERNAL:case S.UNAVAILABLE:case S.UNAUTHENTICATED:return!1;case S.INVALID_ARGUMENT:case S.NOT_FOUND:case S.ALREADY_EXISTS:case S.PERMISSION_DENIED:case S.FAILED_PRECONDITION:case S.ABORTED:case S.OUT_OF_RANGE:case S.UNIMPLEMENTED:case S.DATA_LOSS:return!0;default:return F(15467,{code:n})}}function Ju(n){if(n===void 0)return tt("GRPC error has no .code"),S.UNKNOWN;switch(n){case ne.OK:return S.OK;case ne.CANCELLED:return S.CANCELLED;case ne.UNKNOWN:return S.UNKNOWN;case ne.DEADLINE_EXCEEDED:return S.DEADLINE_EXCEEDED;case ne.RESOURCE_EXHAUSTED:return S.RESOURCE_EXHAUSTED;case ne.INTERNAL:return S.INTERNAL;case ne.UNAVAILABLE:return S.UNAVAILABLE;case ne.UNAUTHENTICATED:return S.UNAUTHENTICATED;case ne.INVALID_ARGUMENT:return S.INVALID_ARGUMENT;case ne.NOT_FOUND:return S.NOT_FOUND;case ne.ALREADY_EXISTS:return S.ALREADY_EXISTS;case ne.PERMISSION_DENIED:return S.PERMISSION_DENIED;case ne.FAILED_PRECONDITION:return S.FAILED_PRECONDITION;case ne.ABORTED:return S.ABORTED;case ne.OUT_OF_RANGE:return S.OUT_OF_RANGE;case ne.UNIMPLEMENTED:return S.UNIMPLEMENTED;case ne.DATA_LOSS:return S.DATA_LOSS;default:return F(39323,{code:n})}}(G=ne||(ne={}))[G.OK=0]="OK",G[G.CANCELLED=1]="CANCELLED",G[G.UNKNOWN=2]="UNKNOWN",G[G.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",G[G.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",G[G.NOT_FOUND=5]="NOT_FOUND",G[G.ALREADY_EXISTS=6]="ALREADY_EXISTS",G[G.PERMISSION_DENIED=7]="PERMISSION_DENIED",G[G.UNAUTHENTICATED=16]="UNAUTHENTICATED",G[G.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",G[G.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",G[G.ABORTED=10]="ABORTED",G[G.OUT_OF_RANGE=11]="OUT_OF_RANGE",G[G.UNIMPLEMENTED=12]="UNIMPLEMENTED",G[G.INTERNAL=13]="INTERNAL",G[G.UNAVAILABLE=14]="UNAVAILABLE",G[G.DATA_LOSS=15]="DATA_LOSS";function Vy(){return new TextEncoder}const Dy=new _t([4294967295,4294967295],0);function $c(n){const e=Vy().encode(n),t=new du;return t.update(e),new Uint8Array(t.digest())}function Hc(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new _t([t,s],0),new _t([r,o],0)]}class _o{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new qn(`Invalid padding: ${t}`);if(s<0)throw new qn(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new qn(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new qn(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=_t.fromNumber(this.ge)}ye(e,t,s){let r=e.add(t.multiply(_t.fromNumber(s)));return r.compare(Dy)===1&&(r=new _t([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=$c(e),[s,r]=Hc(t);for(let o=0;o<this.hashCount;o++){const a=this.ye(s,r,o);if(!this.we(a))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new _o(o,r,t);return s.forEach((l=>a.insert(l))),a}insert(e){if(this.ge===0)return;const t=$c(e),[s,r]=Hc(t);for(let o=0;o<this.hashCount;o++){const a=this.ye(s,r,o);this.Se(a)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class qn extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Sr{constructor(e,t,s,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,ys.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Sr(U.min(),r,new Z($),nt(),H())}}class ys{constructor(e,t,s,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new ys(s,t,H(),H(),H())}}class Qs{constructor(e,t,s,r){this.be=e,this.removedTargetIds=t,this.key=s,this.De=r}}class Xu{constructor(e,t){this.targetId=e,this.Ce=t}}class Yu{constructor(e,t,s=pe.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class Wc{constructor(){this.ve=0,this.Fe=Gc(),this.Me=pe.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=H(),t=H(),s=H();return this.Fe.forEach(((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:F(38017,{changeType:o})}})),new ys(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=Gc()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,K(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Ny{constructor(e){this.Ge=e,this.ze=new Map,this.je=nt(),this.Je=Us(),this.He=Us(),this.Ye=new Z($)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:F(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,s=e.Ce.count,r=this.ot(t);if(r){const o=r.target;if(Oi(o))if(s===0){const a=new L(o.path);this.et(t,a,_e.newNoDocument(a,U.min()))}else K(s===1,20013,{expectedCount:s});else{const a=this._t(t);if(a!==s){const l=this.ut(e),h=l?this.ct(l,e,a):1;if(h!==0){this.it(t);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:o=0}=t;let a,l;try{a=wt(s).toUint8Array()}catch(h){if(h instanceof Iu)return ln("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{l=new _o(a,r,o)}catch(h){return ln(h instanceof qn?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return l.ge===0?null:l}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let r=0;return s.forEach((o=>{const a=this.Ge.ht(),l=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.et(t,o,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((o,a)=>{const l=this.ot(a);if(l){if(o.current&&Oi(l.target)){const h=new L(l.target.path);this.It(h).has(a)||this.Et(a,h)||this.et(a,h,_e.newNoDocument(h,e))}o.Be&&(t.set(a,o.ke()),o.qe())}}));let s=H();this.He.forEach(((o,a)=>{let l=!0;a.forEachWhile((h=>{const d=this.ot(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)})),l&&(s=s.add(o))})),this.je.forEach(((o,a)=>a.setReadTime(e)));const r=new Sr(e,t,this.Ye,this.je,s);return this.je=nt(),this.Je=Us(),this.He=Us(),this.Ye=new Z($),r}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Wc,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new ae($),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new ae($),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Wc),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Us(){return new Z(L.comparator)}function Gc(){return new Z(L.comparator)}const Oy={asc:"ASCENDING",desc:"DESCENDING"},Ly={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},My={and:"AND",or:"OR"};class Fy{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Mi(n,e){return n.useProto3Json||Er(e)?e:{value:e}}function hr(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Zu(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Uy(n,e){return hr(n,e.toTimestamp())}function qe(n){return K(!!n,49232),U.fromTimestamp((function(t){const s=Et(t);return new X(s.seconds,s.nanos)})(n))}function vo(n,e){return Fi(n,e).canonicalString()}function Fi(n,e){const t=(function(r){return new Y(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function eh(n){const e=Y.fromString(n);return K(ih(e),10190,{key:e.toString()}),e}function Ui(n,e){return vo(n.databaseId,e.path)}function gi(n,e){const t=eh(e);if(t.get(1)!==n.databaseId.projectId)throw new N(S.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new N(S.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new L(nh(t))}function th(n,e){return vo(n.databaseId,e)}function By(n){const e=eh(n);return e.length===4?Y.emptyPath():nh(e)}function Bi(n){return new Y(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function nh(n){return K(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Kc(n,e,t){return{name:Ui(n,e),fields:t.value.mapValue.fields}}function zy(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:F(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=(function(d,p){return d.useProto3Json?(K(p===void 0||typeof p=="string",58123),pe.fromBase64String(p||"")):(K(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),pe.fromUint8Array(p||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&(function(d){const p=d.code===void 0?S.UNKNOWN:Ju(d.code);return new N(p,d.message||"")})(a);t=new Yu(s,r,o,l||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=gi(n,s.document.name),o=qe(s.document.updateTime),a=s.document.createTime?qe(s.document.createTime):U.min(),l=new Re({mapValue:{fields:s.document.fields}}),h=_e.newFoundDocument(r,o,a,l),d=s.targetIds||[],p=s.removedTargetIds||[];t=new Qs(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=gi(n,s.document),o=s.readTime?qe(s.readTime):U.min(),a=_e.newNoDocument(r,o),l=s.removedTargetIds||[];t=new Qs([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=gi(n,s.document),o=s.removedTargetIds||[];t=new Qs([],o,r,null)}else{if(!("filter"in e))return F(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:o}=s,a=new Cy(r,o),l=s.targetId;t=new Xu(l,a)}}return t}function jy(n,e){let t;if(e instanceof gs)t={update:Kc(n,e.key,e.value)};else if(e instanceof Qu)t={delete:Ui(n,e.key)};else if(e instanceof Ct)t={update:Kc(n,e.key,e.data),updateMask:Xy(e.fieldMask)};else{if(!(e instanceof Ry))return F(16599,{Vt:e.type});t={verify:Ui(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(o,a){const l=a.transform;if(l instanceof os)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof as)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof cs)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ur)return{fieldPath:a.field.canonicalString(),increment:l.Ae};throw F(20930,{transform:a.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(r,o){return o.updateTime!==void 0?{updateTime:Uy(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:F(27497)})(n,e.precondition)),t}function qy(n,e){return n&&n.length>0?(K(e!==void 0,14353),n.map((t=>(function(r,o){let a=r.updateTime?qe(r.updateTime):qe(o);return a.isEqual(U.min())&&(a=qe(o)),new Ty(a,r.transformResults||[])})(t,e)))):[]}function $y(n,e){return{documents:[th(n,e.path)]}}function Hy(n,e){const t={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=th(n,r);const o=(function(d){if(d.length!==0)return rh(Ge.create(d,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const a=(function(d){if(d.length!==0)return d.map((p=>(function(E){return{field:tn(E.field),direction:Ky(E.dir)}})(p)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=Mi(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:r}}function Wy(n){let e=By(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){K(s===1,65062);const p=t.from[0];p.allDescendants?r=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=(function(_){const E=sh(_);return E instanceof Ge&&Du(E)?E.getFilters():[E]})(t.where));let a=[];t.orderBy&&(a=(function(_){return _.map((E=>(function(C){return new lr(nn(C.field),(function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(C.direction))})(E)))})(t.orderBy));let l=null;t.limit&&(l=(function(_){let E;return E=typeof _=="object"?_.value:_,Er(E)?null:E})(t.limit));let h=null;t.startAt&&(h=(function(_){const E=!!_.before,A=_.values||[];return new cr(A,E)})(t.startAt));let d=null;return t.endAt&&(d=(function(_){const E=!_.before,A=_.values||[];return new cr(A,E)})(t.endAt)),ly(e,r,a,o,l,"F",h,d)}function Gy(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return F(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function sh(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=nn(t.unaryFilter.field);return ie.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=nn(t.unaryFilter.field);return ie.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=nn(t.unaryFilter.field);return ie.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=nn(t.unaryFilter.field);return ie.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return F(61313);default:return F(60726)}})(n):n.fieldFilter!==void 0?(function(t){return ie.create(nn(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return F(58110);default:return F(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ge.create(t.compositeFilter.filters.map((s=>sh(s))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return F(1026)}})(t.compositeFilter.op))})(n):F(30097,{filter:n})}function Ky(n){return Oy[n]}function Qy(n){return Ly[n]}function Jy(n){return My[n]}function tn(n){return{fieldPath:n.canonicalString()}}function nn(n){return fe.fromServerFormat(n.fieldPath)}function rh(n){return n instanceof ie?(function(t){if(t.op==="=="){if(Oc(t.value))return{unaryFilter:{field:tn(t.field),op:"IS_NAN"}};if(Nc(t.value))return{unaryFilter:{field:tn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Oc(t.value))return{unaryFilter:{field:tn(t.field),op:"IS_NOT_NAN"}};if(Nc(t.value))return{unaryFilter:{field:tn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:tn(t.field),op:Qy(t.op),value:t.value}}})(n):n instanceof Ge?(function(t){const s=t.getFilters().map((r=>rh(r)));return s.length===1?s[0]:{compositeFilter:{op:Jy(t.op),filters:s}}})(n):F(54877,{filter:n})}function Xy(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function ih(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class pt{constructor(e,t,s,r,o=U.min(),a=U.min(),l=pe.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=h}withSequenceNumber(e){return new pt(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new pt(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new pt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new pt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Yy{constructor(e){this.yt=e}}function Zy(n){const e=Wy({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Li(e,e.limit,"L"):e}class e_{constructor(){this.Cn=new t_}addToCollectionParentIndex(e,t){return this.Cn.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(bt.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(bt.min())}updateCollectionGroup(e,t,s){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}}class t_{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new ae(Y.comparator),o=!r.has(s);return this.index[t]=r.add(s),o}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new ae(Y.comparator)).toArray()}}const Qc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},oh=41943040;class Ae{static withCacheSize(e){return new Ae(e,Ae.DEFAULT_COLLECTION_PERCENTILE,Ae.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}Ae.DEFAULT_COLLECTION_PERCENTILE=10,Ae.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ae.DEFAULT=new Ae(oh,Ae.DEFAULT_COLLECTION_PERCENTILE,Ae.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ae.DISABLED=new Ae(-1,0,0);class fn{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new fn(0)}static cr(){return new fn(-1)}}const Jc="LruGarbageCollector",n_=1048576;function Xc([n,e],[t,s]){const r=$(n,t);return r===0?$(e,s):r}class s_{constructor(e){this.Ir=e,this.buffer=new ae(Xc),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();Xc(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class r_{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){V(Jc,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){En(t)?V(Jc,"Ignoring IndexedDB error during garbage collection: ",t):await bn(t)}await this.Vr(3e5)}))}}class i_{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return R.resolve(br.ce);const s=new s_(t);return this.mr.forEachTarget(e,(r=>s.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>s.Ar(r))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(Qc)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Qc):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,r,o,a,l,h,d;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),r=this.params.maximumSequenceNumbersToCollect):r=_,a=Date.now(),this.nthSequenceNumber(e,r)))).next((_=>(s=_,l=Date.now(),this.removeTargets(e,s,t)))).next((_=>(o=_,h=Date.now(),this.removeOrphanedDocuments(e,s)))).next((_=>(d=Date.now(),Zt()<=q.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${r} in `+(l-a)+`ms
	Removed ${o} targets in `+(h-l)+`ms
	Removed ${_} documents in `+(d-h)+`ms
Total Duration: ${d-p}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:_}))))}}function o_(n,e){return new i_(n,e)}class a_{constructor(){this.changes=new Gt((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,_e.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?R.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class c_{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class l_{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(s=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(s!==null&&Xn(s.mutation,r,Ce.empty(),X.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,H()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=H()){const r=Ut();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,s).next((o=>{let a=jn();return o.forEach(((l,h)=>{a=a.insert(l,h.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const s=Ut();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,H())))}populateOverlays(e,t,s){const r=[];return s.forEach((o=>{t.has(o)||r.push(o)})),this.documentOverlayCache.getOverlays(e,r).next((o=>{o.forEach(((a,l)=>{t.set(a,l)}))}))}computeViews(e,t,s,r){let o=nt();const a=Jn(),l=(function(){return Jn()})();return t.forEach(((h,d)=>{const p=s.get(d.key);r.has(d.key)&&(p===void 0||p.mutation instanceof Ct)?o=o.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),Xn(p.mutation,d,p.mutation.getFieldMask(),X.now())):a.set(d.key,Ce.empty())})),this.recalculateAndSaveOverlays(e,o).next((h=>(h.forEach(((d,p)=>a.set(d,p))),t.forEach(((d,p)=>l.set(d,new c_(p,a.get(d)??null)))),l)))}recalculateAndSaveOverlays(e,t){const s=Jn();let r=new Z(((a,l)=>a-l)),o=H();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const l of a)l.keys().forEach((h=>{const d=t.get(h);if(d===null)return;let p=s.get(h)||Ce.empty();p=l.applyToLocalView(d,p),s.set(h,p);const _=(r.get(l.batchId)||H()).add(h);r=r.insert(l.batchId,_)}))})).next((()=>{const a=[],l=r.getReverseIterator();for(;l.hasNext();){const h=l.getNext(),d=h.key,p=h.value,_=zu();p.forEach((E=>{if(!o.has(E)){const A=Gu(t.get(E),s.get(E));A!==null&&_.set(E,A),o=o.add(E)}})),a.push(this.documentOverlayCache.saveOverlays(e,d,_))}return R.waitFor(a)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,r){return(function(a){return L.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):uy(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next((o=>{const a=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-o.size):R.resolve(Ut());let l=ns,h=o;return a.next((d=>R.forEach(d,((p,_)=>(l<_.largestBatchId&&(l=_.largestBatchId),o.get(p)?R.resolve():this.remoteDocumentCache.getEntry(e,p).next((E=>{h=h.insert(p,E)}))))).next((()=>this.populateOverlays(e,d,o))).next((()=>this.computeViews(e,h,d,H()))).next((p=>({batchId:l,changes:Bu(p)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next((s=>{let r=jn();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const o=t.collectionGroup;let a=jn();return this.indexManager.getCollectionParents(e,o).next((l=>R.forEach(l,(h=>{const d=(function(_,E){return new Ir(E,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,s,r).next((p=>{p.forEach(((_,E)=>{a=a.insert(_,E)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,s,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,o,r)))).next((a=>{o.forEach(((h,d)=>{const p=d.getKey();a.get(p)===null&&(a=a.insert(p,_e.newInvalidDocument(p)))}));let l=jn();return a.forEach(((h,d)=>{const p=o.get(h);p!==void 0&&Xn(p.mutation,d,Ce.empty(),X.now()),xr(t,d)&&(l=l.insert(h,d))})),l}))}}class u_{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return R.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:qe(r.createTime)}})(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:Zy(r.bundledQuery),readTime:qe(r.readTime)}})(t)),R.resolve()}}class h_{constructor(){this.overlays=new Z(L.comparator),this.qr=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Ut();return R.forEach(t,(r=>this.getOverlay(e,r).next((o=>{o!==null&&s.set(r,o)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((r,o)=>{this.St(e,t,o)})),R.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(s)),R.resolve()}getOverlaysForCollection(e,t,s){const r=Ut(),o=t.length+1,a=new L(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const h=l.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>s&&r.set(h.getKey(),h)}return R.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let o=new Z(((d,p)=>d-p));const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>s){let p=o.get(d.largestBatchId);p===null&&(p=Ut(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const l=Ut(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((d,p)=>l.set(d,p))),!(l.size()>=r)););return R.resolve(l)}St(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const a=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(s.key,new Py(t,s));let o=this.qr.get(t);o===void 0&&(o=H(),this.qr.set(t,o)),this.qr.set(t,o.add(s.key))}}class d_{constructor(){this.sessionToken=pe.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}}class bo{constructor(){this.Qr=new ae(he.$r),this.Ur=new ae(he.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new he(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Gr(new he(e,t))}zr(e,t){e.forEach((s=>this.removeReference(s,t)))}jr(e){const t=new L(new Y([])),s=new he(t,e),r=new he(t,e+1),o=[];return this.Ur.forEachInRange([s,r],(a=>{this.Gr(a),o.push(a.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new L(new Y([])),s=new he(t,e),r=new he(t,e+1);let o=H();return this.Ur.forEachInRange([s,r],(a=>{o=o.add(a.key)})),o}containsKey(e){const t=new he(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class he{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return L.comparator(e.key,t.key)||$(e.Yr,t.Yr)}static Kr(e,t){return $(e.Yr,t.Yr)||L.comparator(e.key,t.key)}}class f_{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ae(he.$r)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Sy(o,t,s,r);this.mutationQueue.push(a);for(const l of r)this.Zr=this.Zr.add(new he(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.ei(s),o=r<0?0:r;return R.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?lo:this.tr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new he(t,0),r=new he(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([s,r],(a=>{const l=this.Xr(a.Yr);o.push(l)})),R.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new ae($);return t.forEach((r=>{const o=new he(r,0),a=new he(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],(l=>{s=s.add(l.Yr)}))})),R.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let o=s;L.isDocumentKey(o)||(o=o.child(""));const a=new he(new L(o),0);let l=new ae($);return this.Zr.forEachWhile((h=>{const d=h.key.path;return!!s.isPrefixOf(d)&&(d.length===r&&(l=l.add(h.Yr)),!0)}),a),R.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((s=>{const r=this.Xr(s);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){K(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return R.forEach(t.mutations,(r=>{const o=new he(r.key,t.batchId);return s=s.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,t){const s=new he(t,0),r=this.Zr.firstAfterOrEqual(s);return R.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class p_{constructor(e){this.ri=e,this.docs=(function(){return new Z(L.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),o=r?r.size:0,a=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return R.resolve(s?s.document.mutableCopy():_e.newInvalidDocument(t))}getEntries(e,t){let s=nt();return t.forEach((r=>{const o=this.docs.get(r);s=s.insert(r,o?o.document.mutableCopy():_e.newInvalidDocument(r))})),R.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let o=nt();const a=t.path,l=new L(a.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){const{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||zg(Bg(p),s)<=0||(r.has(p.key)||xr(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return R.resolve(o)}getAllFromCollectionGroup(e,t,s,r){F(9500)}ii(e,t){return R.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new m_(this)}getSize(e){return R.resolve(this.size)}}class m_ extends a_{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)})),R.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class g_{constructor(e){this.persistence=e,this.si=new Gt((t=>fo(t)),po),this.lastRemoteSnapshotVersion=U.min(),this.highestTargetId=0,this.oi=0,this._i=new bo,this.targetCount=0,this.ai=fn.ur()}forEachTarget(e,t){return this.si.forEach(((s,r)=>t(r))),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),R.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new fn(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.Pr(t),R.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,s){let r=0;const o=[];return this.si.forEach(((a,l)=>{l.sequenceNumber<=t&&s.get(l.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),R.waitFor(o).next((()=>r))}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return R.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),R.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const r=this.persistence.referenceDelegate,o=[];return r&&t.forEach((a=>{o.push(r.markPotentiallyOrphaned(e,a))})),R.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),R.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return R.resolve(s)}containsKey(e,t){return R.resolve(this._i.containsKey(t))}}class ah{constructor(e,t){this.ui={},this.overlays={},this.ci=new br(0),this.li=!1,this.li=!0,this.hi=new d_,this.referenceDelegate=e(this),this.Pi=new g_(this),this.indexManager=new e_,this.remoteDocumentCache=(function(r){return new p_(r)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new Yy(t),this.Ii=new u_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new h_,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new f_(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){V("MemoryPersistence","Starting transaction:",e);const r=new y_(this.ci.next());return this.referenceDelegate.Ei(),s(r).next((o=>this.referenceDelegate.di(r).next((()=>o)))).toPromise().then((o=>(r.raiseOnCommittedEvent(),o)))}Ai(e,t){return R.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,t))))}}class y_ extends qg{constructor(e){super(),this.currentSequenceNumber=e}}class Eo{constructor(e){this.persistence=e,this.Ri=new bo,this.Vi=null}static mi(e){return new Eo(e)}get fi(){if(this.Vi)return this.Vi;throw F(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),R.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),R.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((o=>this.fi.add(o.toString())))})).next((()=>s.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.fi,(s=>{const r=L.fromPath(s);return this.gi(e,r).next((o=>{o||t.removeEntry(r,U.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return R.or([()=>R.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class dr{constructor(e,t){this.persistence=e,this.pi=new Gt((s=>Wg(s.path)),((s,r)=>s.isEqual(r))),this.garbageCollector=o_(this,t)}static mi(e,t){return new dr(e,t)}Ei(){}di(e){return R.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((r=>s+r))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}pr(e,t){return R.forEach(this.pi,((s,r)=>this.br(e,s,r).next((o=>o?R.resolve():t(r)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.ii(e,(a=>this.br(e,a,t).next((l=>{l||(s++,o.removeEntry(a,U.min()))})))).next((()=>o.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),R.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),R.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),R.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),R.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ws(e.data.value)),t}br(e,t,s){return R.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return R.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class wo{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=r}static As(e,t){let s=H(),r=H();for(const o of t.docChanges)switch(o.type){case 0:s=s.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new wo(e,t.fromCache,s,r)}}class __{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class v_{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Hd()?8:$g(ve())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,r){const o={result:null};return this.ys(e,t).next((a=>{o.result=a})).next((()=>{if(!o.result)return this.ws(e,t,r,s).next((a=>{o.result=a}))})).next((()=>{if(o.result)return;const a=new __;return this.Ss(e,t,a).next((l=>{if(o.result=l,this.Vs)return this.bs(e,t,a,l.size)}))})).next((()=>o.result))}bs(e,t,s,r){return s.documentReadCount<this.fs?(Zt()<=q.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",en(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),R.resolve()):(Zt()<=q.DEBUG&&V("QueryEngine","Query:",en(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Zt()<=q.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",en(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ze(t))):R.resolve())}ys(e,t){if(Uc(t))return R.resolve(null);let s=ze(t);return this.indexManager.getIndexType(e,s).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=Li(t,null,"F"),s=ze(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((o=>{const a=H(...o);return this.ps.getDocuments(e,a).next((l=>this.indexManager.getMinOffset(e,s).next((h=>{const d=this.Ds(t,l);return this.Cs(t,d,a,h.readTime)?this.ys(e,Li(t,null,"F")):this.vs(e,d,t,h)}))))})))))}ws(e,t,s,r){return Uc(t)||r.isEqual(U.min())?R.resolve(null):this.ps.getDocuments(e,s).next((o=>{const a=this.Ds(t,o);return this.Cs(t,a,s,r)?R.resolve(null):(Zt()<=q.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),en(t)),this.vs(e,a,t,Ug(r,ns)).next((l=>l)))}))}Ds(e,t){let s=new ae(Fu(e));return t.forEach(((r,o)=>{xr(e,o)&&(s=s.add(o))})),s}Cs(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}Ss(e,t,s){return Zt()<=q.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",en(t)),this.ps.getDocumentsMatchingQuery(e,t,bt.min(),s)}vs(e,t,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next((o=>(t.forEach((a=>{o=o.insert(a.key,a)})),o)))}}const Io="LocalStore",b_=3e8;class E_{constructor(e,t,s,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Z($),this.xs=new Gt((o=>fo(o)),po),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new l_(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function w_(n,e,t,s){return new E_(n,e,t,s)}async function ch(n,e){const t=B(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next((o=>(r=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(s)))).next((o=>{const a=[],l=[];let h=H();for(const d of r){a.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}for(const d of o){l.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(s,h).next((d=>({Ls:d,removedBatchIds:a,addedBatchIds:l})))}))}))}function I_(n,e){const t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const r=e.batch.keys(),o=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,h,d,p){const _=d.batch,E=_.keys();let A=R.resolve();return E.forEach((C=>{A=A.next((()=>p.getEntry(h,C))).next((D=>{const k=d.docVersions.get(C);K(k!==null,48541),D.version.compareTo(k)<0&&(_.applyToRemoteDocument(D,d),D.isValidDocument()&&(D.setReadTime(d.commitVersion),p.addEntry(D)))}))})),A.next((()=>l.mutationQueue.removeMutationBatch(h,_)))})(t,s,e,o).next((()=>o.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(l){let h=H();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(h=h.add(l.batch.mutations[d].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(s,r)))}))}function lh(n){const e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function T_(n,e){const t=B(n),s=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const l=[];e.targetChanges.forEach(((p,_)=>{const E=r.get(_);if(!E)return;l.push(t.Pi.removeMatchingKeys(o,p.removedDocuments,_).next((()=>t.Pi.addMatchingKeys(o,p.addedDocuments,_))));let A=E.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(_)!==null?A=A.withResumeToken(pe.EMPTY_BYTE_STRING,U.min()).withLastLimboFreeSnapshotVersion(U.min()):p.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(p.resumeToken,s)),r=r.insert(_,A),(function(D,k,O){return D.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=b_?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0})(E,A,p)&&l.push(t.Pi.updateTargetData(o,A))}));let h=nt(),d=H();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))})),l.push(x_(o,a,e.documentUpdates).next((p=>{h=p.ks,d=p.qs}))),!s.isEqual(U.min())){const p=t.Pi.getLastRemoteSnapshotVersion(o).next((_=>t.Pi.setTargetsMetadata(o,o.currentSequenceNumber,s)));l.push(p)}return R.waitFor(l).next((()=>a.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,h,d))).next((()=>h))})).then((o=>(t.Ms=r,o)))}function x_(n,e,t){let s=H(),r=H();return t.forEach((o=>s=s.add(o))),e.getEntries(n,s).next((o=>{let a=nt();return t.forEach(((l,h)=>{const d=o.get(l);h.isFoundDocument()!==d.isFoundDocument()&&(r=r.add(l)),h.isNoDocument()&&h.version.isEqual(U.min())?(e.removeEntry(l,h.readTime),a=a.insert(l,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(l,h)):V(Io,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",h.version)})),{ks:a,qs:r}}))}function A_(n,e){const t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=lo),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function R_(n,e){const t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let r;return t.Pi.getTargetData(s,e).next((o=>o?(r=o,R.resolve(r)):t.Pi.allocateTargetId(s).next((a=>(r=new pt(e,a,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,r).next((()=>r)))))))})).then((s=>{const r=t.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s}))}async function zi(n,e,t){const s=B(n),r=s.Ms.get(e),o=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",o,(a=>s.persistence.referenceDelegate.removeTarget(a,r)))}catch(a){if(!En(a))throw a;V(Io,`Failed to update sequence numbers for target ${e}: ${a}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function Yc(n,e,t){const s=B(n);let r=U.min(),o=H();return s.persistence.runTransaction("Execute query","readwrite",(a=>(function(h,d,p){const _=B(h),E=_.xs.get(p);return E!==void 0?R.resolve(_.Ms.get(E)):_.Pi.getTargetData(d,p)})(s,a,ze(e)).next((l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(a,l.targetId).next((h=>{o=h}))})).next((()=>s.Fs.getDocumentsMatchingQuery(a,e,t?r:U.min(),t?o:H()))).next((l=>(S_(s,dy(e),l),{documents:l,Qs:o})))))}function S_(n,e,t){let s=n.Os.get(e)||U.min();t.forEach(((r,o)=>{o.readTime.compareTo(s)>0&&(s=o.readTime)})),n.Os.set(e,s)}class Zc{constructor(){this.activeTargetIds=_y()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class P_{constructor(){this.Mo=new Zc,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Zc,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class C_{Oo(e){}shutdown(){}}const el="ConnectivityMonitor";class tl{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){V(el,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){V(el,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Bs=null;function ji(){return Bs===null?Bs=(function(){return 268435456+Math.round(2147483648*Math.random())})():Bs++,"0x"+Bs.toString(16)}const yi="RestConnection",k_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class V_{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===or?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,t,s,r,o){const a=ji(),l=this.zo(e,t.toUriEncodedString());V(yi,`Sending RPC '${e}' ${a}:`,l,s);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,r,o);const{host:d}=new URL(l),p=mn(d);return this.Jo(e,l,h,s,p).then((_=>(V(yi,`Received RPC '${e}' ${a}: `,_),_)),(_=>{throw ln(yi,`RPC '${e}' ${a} failed with error: `,_,"url: ",l,"request:",s),_}))}Ho(e,t,s,r,o,a){return this.Go(e,t,s,r,o)}jo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+vn})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,o)=>e[o]=r)),s&&s.headers.forEach(((r,o)=>e[o]=r))}zo(e,t){const s=k_[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}class D_{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ge="WebChannelConnection";class N_ extends V_{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,r,o){const a=ji();return new Promise(((l,h)=>{const d=new fu;d.setWithCredentials(!0),d.listenOnce(pu.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Hs.NO_ERROR:const _=d.getResponseJson();V(ge,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(_)),l(_);break;case Hs.TIMEOUT:V(ge,`RPC '${e}' ${a} timed out`),h(new N(S.DEADLINE_EXCEEDED,"Request time out"));break;case Hs.HTTP_ERROR:const E=d.getStatus();if(V(ge,`RPC '${e}' ${a} failed with status:`,E,"response text:",d.getResponseText()),E>0){let A=d.getResponseJson();Array.isArray(A)&&(A=A[0]);const C=A?.error;if(C&&C.status&&C.message){const D=(function(O){const z=O.toLowerCase().replace(/_/g,"-");return Object.values(S).indexOf(z)>=0?z:S.UNKNOWN})(C.status);h(new N(D,C.message))}else h(new N(S.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new N(S.UNAVAILABLE,"Connection failed."));break;default:F(9055,{l_:e,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{V(ge,`RPC '${e}' ${a} completed.`)}}));const p=JSON.stringify(r);V(ge,`RPC '${e}' ${a} sending request:`,r),d.send(t,"POST",p,s,15)}))}T_(e,t,s){const r=ji(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=yu(),l=gu(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,t,s),h.encodeInitMessageHeaders=!0;const p=o.join("");V(ge,`Creating RPC '${e}' stream ${r}: ${p}`,h);const _=a.createWebChannel(p,h);this.I_(_);let E=!1,A=!1;const C=new D_({Yo:k=>{A?V(ge,`Not sending because RPC '${e}' stream ${r} is closed:`,k):(E||(V(ge,`Opening RPC '${e}' stream ${r} transport.`),_.open(),E=!0),V(ge,`RPC '${e}' stream ${r} sending:`,k),_.send(k))},Zo:()=>_.close()}),D=(k,O,z)=>{k.listen(O,(W=>{try{z(W)}catch(Ee){setTimeout((()=>{throw Ee}),0)}}))};return D(_,zn.EventType.OPEN,(()=>{A||(V(ge,`RPC '${e}' stream ${r} transport opened.`),C.o_())})),D(_,zn.EventType.CLOSE,(()=>{A||(A=!0,V(ge,`RPC '${e}' stream ${r} transport closed`),C.a_(),this.E_(_))})),D(_,zn.EventType.ERROR,(k=>{A||(A=!0,ln(ge,`RPC '${e}' stream ${r} transport errored. Name:`,k.name,"Message:",k.message),C.a_(new N(S.UNAVAILABLE,"The operation could not be completed")))})),D(_,zn.EventType.MESSAGE,(k=>{if(!A){const O=k.data[0];K(!!O,16349);const z=O,W=z?.error||z[0]?.error;if(W){V(ge,`RPC '${e}' stream ${r} received error:`,W);const Ee=W.status;let Te=(function(m){const y=ne[m];if(y!==void 0)return Ju(y)})(Ee),ce=W.message;Te===void 0&&(Te=S.INTERNAL,ce="Unknown error status: "+Ee+" with message "+W.message),A=!0,C.a_(new N(Te,ce)),_.close()}else V(ge,`RPC '${e}' stream ${r} received:`,O),C.u_(O)}})),D(l,mu.STAT_EVENT,(k=>{k.stat===Ci.PROXY?V(ge,`RPC '${e}' stream ${r} detected buffering proxy`):k.stat===Ci.NOPROXY&&V(ge,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{C.__()}),0),C}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function _i(){return typeof document<"u"?document:null}function Pr(n){return new Fy(n,!0)}class uh{constructor(e,t,s=1e3,r=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=r,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-s);r>0&&V("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const nl="PersistentStream";class hh{constructor(e,t,s,r,o,a,l,h){this.Mi=e,this.S_=s,this.b_=r,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new uh(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===S.RESOURCE_EXHAUSTED?(tt(t.toString()),tt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===S.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,r])=>{this.D_===t&&this.G_(s,r)}),(s=>{e((()=>{const r=new N(S.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)}))}))}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{s((()=>this.z_(r)))})),this.stream.onMessage((r=>{s((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return V(nl,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(V(nl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class O_ extends hh{constructor(e,t,s,r,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,a),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=zy(this.serializer,e),s=(function(o){if(!("targetChange"in o))return U.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?U.min():a.readTime?qe(a.readTime):U.min()})(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=Bi(this.serializer),t.addTarget=(function(o,a){let l;const h=a.target;if(l=Oi(h)?{documents:$y(o,h)}:{query:Hy(o,h).ft},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=Zu(o,a.resumeToken);const d=Mi(o,a.expectedCount);d!==null&&(l.expectedCount=d)}else if(a.snapshotVersion.compareTo(U.min())>0){l.readTime=hr(o,a.snapshotVersion.toTimestamp());const d=Mi(o,a.expectedCount);d!==null&&(l.expectedCount=d)}return l})(this.serializer,e);const s=Gy(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=Bi(this.serializer),t.removeTarget=e,this.q_(t)}}class L_ extends hh{constructor(e,t,s,r,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return K(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,K(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){K(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=qy(e.writeResults,e.commitTime),s=qe(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=Bi(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>jy(this.serializer,s)))};this.q_(t)}}class M_{}class F_ extends M_{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new N(S.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Go(e,Fi(t,s),r,o,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new N(S.UNKNOWN,o.toString())}))}Ho(e,t,s,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Ho(e,Fi(t,s),r,a,l,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new N(S.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class U_{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(tt(t),this.aa=!1):V("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Wt="RemoteStore";class B_{constructor(e,t,s,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((a=>{s.enqueueAndForget((async()=>{Kt(this)&&(V(Wt,"Restarting streams for network reachability change."),await(async function(h){const d=B(h);d.Ea.add(4),await _s(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Cr(d)})(this))}))})),this.Ra=new U_(s,r)}}async function Cr(n){if(Kt(n))for(const e of n.da)await e(!0)}async function _s(n){for(const e of n.da)await e(!1)}function dh(n,e){const t=B(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Ro(t)?Ao(t):wn(t).O_()&&xo(t,e))}function To(n,e){const t=B(n),s=wn(t);t.Ia.delete(e),s.O_()&&fh(t,e),t.Ia.size===0&&(s.O_()?s.L_():Kt(t)&&t.Ra.set("Unknown"))}function xo(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(U.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}wn(n).Y_(e)}function fh(n,e){n.Va.Ue(e),wn(n).Z_(e)}function Ao(n){n.Va=new Ny({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),wn(n).start(),n.Ra.ua()}function Ro(n){return Kt(n)&&!wn(n).x_()&&n.Ia.size>0}function Kt(n){return B(n).Ea.size===0}function ph(n){n.Va=void 0}async function z_(n){n.Ra.set("Online")}async function j_(n){n.Ia.forEach(((e,t)=>{xo(n,e)}))}async function q_(n,e){ph(n),Ro(n)?(n.Ra.ha(e),Ao(n)):n.Ra.set("Unknown")}async function $_(n,e,t){if(n.Ra.set("Online"),e instanceof Yu&&e.state===2&&e.cause)try{await(async function(r,o){const a=o.cause;for(const l of o.targetIds)r.Ia.has(l)&&(await r.remoteSyncer.rejectListen(l,a),r.Ia.delete(l),r.Va.removeTarget(l))})(n,e)}catch(s){V(Wt,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await fr(n,s)}else if(e instanceof Qs?n.Va.Ze(e):e instanceof Xu?n.Va.st(e):n.Va.tt(e),!t.isEqual(U.min()))try{const s=await lh(n.localStore);t.compareTo(s)>=0&&await(function(o,a){const l=o.Va.Tt(a);return l.targetChanges.forEach(((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const p=o.Ia.get(d);p&&o.Ia.set(d,p.withResumeToken(h.resumeToken,a))}})),l.targetMismatches.forEach(((h,d)=>{const p=o.Ia.get(h);if(!p)return;o.Ia.set(h,p.withResumeToken(pe.EMPTY_BYTE_STRING,p.snapshotVersion)),fh(o,h);const _=new pt(p.target,h,d,p.sequenceNumber);xo(o,_)})),o.remoteSyncer.applyRemoteEvent(l)})(n,t)}catch(s){V(Wt,"Failed to raise snapshot:",s),await fr(n,s)}}async function fr(n,e,t){if(!En(e))throw e;n.Ea.add(1),await _s(n),n.Ra.set("Offline"),t||(t=()=>lh(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{V(Wt,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Cr(n)}))}function mh(n,e){return e().catch((t=>fr(n,t,e)))}async function kr(n){const e=B(n),t=Tt(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:lo;for(;H_(e);)try{const r=await A_(e.localStore,s);if(r===null){e.Ta.length===0&&t.L_();break}s=r.batchId,W_(e,r)}catch(r){await fr(e,r)}gh(e)&&yh(e)}function H_(n){return Kt(n)&&n.Ta.length<10}function W_(n,e){n.Ta.push(e);const t=Tt(n);t.O_()&&t.X_&&t.ea(e.mutations)}function gh(n){return Kt(n)&&!Tt(n).x_()&&n.Ta.length>0}function yh(n){Tt(n).start()}async function G_(n){Tt(n).ra()}async function K_(n){const e=Tt(n);for(const t of n.Ta)e.ea(t.mutations)}async function Q_(n,e,t){const s=n.Ta.shift(),r=yo.from(s,e,t);await mh(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await kr(n)}async function J_(n,e){e&&Tt(n).X_&&await(async function(s,r){if((function(a){return ky(a)&&a!==S.ABORTED})(r.code)){const o=s.Ta.shift();Tt(s).B_(),await mh(s,(()=>s.remoteSyncer.rejectFailedWrite(o.batchId,r))),await kr(s)}})(n,e),gh(n)&&yh(n)}async function sl(n,e){const t=B(n);t.asyncQueue.verifyOperationInProgress(),V(Wt,"RemoteStore received new credentials");const s=Kt(t);t.Ea.add(3),await _s(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Cr(t)}async function X_(n,e){const t=B(n);e?(t.Ea.delete(2),await Cr(t)):e||(t.Ea.add(2),await _s(t),t.Ra.set("Unknown"))}function wn(n){return n.ma||(n.ma=(function(t,s,r){const o=B(t);return o.sa(),new O_(s,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Xo:z_.bind(null,n),t_:j_.bind(null,n),r_:q_.bind(null,n),H_:$_.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Ro(n)?Ao(n):n.Ra.set("Unknown")):(await n.ma.stop(),ph(n))}))),n.ma}function Tt(n){return n.fa||(n.fa=(function(t,s,r){const o=B(t);return o.sa(),new L_(s,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:G_.bind(null,n),r_:J_.bind(null,n),ta:K_.bind(null,n),na:Q_.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await kr(n)):(await n.fa.stop(),n.Ta.length>0&&(V(Wt,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class So{constructor(e,t,s,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=o,this.deferred=new vt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,o){const a=Date.now()+s,l=new So(e,t,a,r,o);return l.start(s),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new N(S.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Po(n,e){if(tt("AsyncQueue",`${e}: ${n}`),En(n))return new N(S.UNAVAILABLE,`${e}: ${n}`);throw n}class an{static emptySet(e){return new an(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||L.comparator(t.key,s.key):(t,s)=>L.comparator(t.key,s.key),this.keyedMap=jn(),this.sortedSet=new Z(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof an)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,o=s.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new an;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}class rl{constructor(){this.ga=new Z(L.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):F(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class pn{constructor(e,t,s,r,o,a,l,h,d){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,s,r,o){const a=[];return t.forEach((l=>{a.push({type:0,doc:l})})),new pn(e,t,an.emptySet(t),a,s,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Tr(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}class Y_{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Z_{constructor(){this.queries=il(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const r=B(t),o=r.queries;r.queries=il(),o.forEach(((a,l)=>{for(const h of l.Sa)h.onError(s)}))})(this,new N(S.ABORTED,"Firestore shutting down"))}}function il(){return new Gt((n=>Mu(n)),Tr)}async function ev(n,e){const t=B(n);let s=3;const r=e.query;let o=t.queries.get(r);o?!o.ba()&&e.Da()&&(s=2):(o=new Y_,s=e.Da()?0:1);try{switch(s){case 0:o.wa=await t.onListen(r,!0);break;case 1:o.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(a){const l=Po(a,`Initialization of query '${en(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,o),o.Sa.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&Co(t)}async function tv(n,e){const t=B(n),s=e.query;let r=3;const o=t.queries.get(s);if(o){const a=o.Sa.indexOf(e);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?r=e.Da()?0:1:!o.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function nv(n,e){const t=B(n);let s=!1;for(const r of e){const o=r.query,a=t.queries.get(o);if(a){for(const l of a.Sa)l.Fa(r)&&(s=!0);a.wa=r}}s&&Co(t)}function sv(n,e,t){const s=B(n),r=s.queries.get(e);if(r)for(const o of r.Sa)o.onError(t);s.queries.delete(e)}function Co(n){n.Ca.forEach((e=>{e.next()}))}var qi,ol;(ol=qi||(qi={})).Ma="default",ol.Cache="cache";class rv{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new pn(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=pn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==qi.Cache}}class _h{constructor(e){this.key=e}}class vh{constructor(e){this.key=e}}class iv{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=H(),this.mutatedKeys=H(),this.eu=Fu(e),this.tu=new an(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new rl,r=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,a=r,l=!1;const h=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,d=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((p,_)=>{const E=r.get(p),A=xr(this.query,_)?_:null,C=!!E&&this.mutatedKeys.has(E.key),D=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let k=!1;E&&A?E.data.isEqual(A.data)?C!==D&&(s.track({type:3,doc:A}),k=!0):this.su(E,A)||(s.track({type:2,doc:A}),k=!0,(h&&this.eu(A,h)>0||d&&this.eu(A,d)<0)&&(l=!0)):!E&&A?(s.track({type:0,doc:A}),k=!0):E&&!A&&(s.track({type:1,doc:E}),k=!0,(h||d)&&(l=!0)),k&&(A?(a=a.add(A),o=D?o.add(p):o.delete(p)):(a=a.delete(p),o=o.delete(p)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),o=o.delete(p.key),s.track({type:1,doc:p})}return{tu:a,iu:s,Cs:l,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((p,_)=>(function(A,C){const D=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return F(20277,{Rt:k})}};return D(A)-D(C)})(p.type,_.type)||this.eu(p.doc,_.doc))),this.ou(s),r=r??!1;const l=t&&!r?this._u():[],h=this.Xa.size===0&&this.current&&!r?1:0,d=h!==this.Za;return this.Za=h,a.length!==0||d?{snapshot:new pn(this.query,e.tu,o,a,e.mutatedKeys,h===0,d,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new rl,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=H(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const t=[];return e.forEach((s=>{this.Xa.has(s)||t.push(new vh(s))})),this.Xa.forEach((s=>{e.has(s)||t.push(new _h(s))})),t}cu(e){this.Ya=e.Qs,this.Xa=H();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return pn.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ko="SyncEngine";class ov{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class av{constructor(e){this.key=e,this.hu=!1}}class cv{constructor(e,t,s,r,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Gt((l=>Mu(l)),Tr),this.Iu=new Map,this.Eu=new Set,this.du=new Z(L.comparator),this.Au=new Map,this.Ru=new bo,this.Vu={},this.mu=new Map,this.fu=fn.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function lv(n,e,t=!0){const s=xh(n);let r;const o=s.Tu.get(e);return o?(s.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.lu()):r=await bh(s,e,t,!0),r}async function uv(n,e){const t=xh(n);await bh(t,e,!0,!1)}async function bh(n,e,t,s){const r=await R_(n.localStore,ze(e)),o=r.targetId,a=n.sharedClientState.addLocalQueryTarget(o,t);let l;return s&&(l=await hv(n,e,o,a==="current",r.resumeToken)),n.isPrimaryClient&&t&&dh(n.remoteStore,r),l}async function hv(n,e,t,s,r){n.pu=(_,E,A)=>(async function(D,k,O,z){let W=k.view.ru(O);W.Cs&&(W=await Yc(D.localStore,k.query,!1).then((({documents:b})=>k.view.ru(b,W))));const Ee=z&&z.targetChanges.get(k.targetId),Te=z&&z.targetMismatches.get(k.targetId)!=null,ce=k.view.applyChanges(W,D.isPrimaryClient,Ee,Te);return cl(D,k.targetId,ce.au),ce.snapshot})(n,_,E,A);const o=await Yc(n.localStore,e,!0),a=new iv(e,o.Qs),l=a.ru(o.documents),h=ys.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),d=a.applyChanges(l,n.isPrimaryClient,h);cl(n,t,d.au);const p=new ov(e,t,a);return n.Tu.set(e,p),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function dv(n,e,t){const s=B(n),r=s.Tu.get(e),o=s.Iu.get(r.targetId);if(o.length>1)return s.Iu.set(r.targetId,o.filter((a=>!Tr(a,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await zi(s.localStore,r.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(r.targetId),t&&To(s.remoteStore,r.targetId),$i(s,r.targetId)})).catch(bn)):($i(s,r.targetId),await zi(s.localStore,r.targetId,!0))}async function fv(n,e){const t=B(n),s=t.Tu.get(e),r=t.Iu.get(s.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),To(t.remoteStore,s.targetId))}async function pv(n,e,t){const s=Ev(n);try{const r=await(function(a,l){const h=B(a),d=X.now(),p=l.reduce(((A,C)=>A.add(C.key)),H());let _,E;return h.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let C=nt(),D=H();return h.Ns.getEntries(A,p).next((k=>{C=k,C.forEach(((O,z)=>{z.isValidDocument()||(D=D.add(O))}))})).next((()=>h.localDocuments.getOverlayedDocuments(A,C))).next((k=>{_=k;const O=[];for(const z of l){const W=Ay(z,_.get(z.key).overlayedDocument);W!=null&&O.push(new Ct(z.key,W,Cu(W.value.mapValue),je.exists(!0)))}return h.mutationQueue.addMutationBatch(A,d,O,l)})).next((k=>{E=k;const O=k.applyToLocalDocumentSet(_,D);return h.documentOverlayCache.saveOverlays(A,k.batchId,O)}))})).then((()=>({batchId:E.batchId,changes:Bu(_)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),(function(a,l,h){let d=a.Vu[a.currentUser.toKey()];d||(d=new Z($)),d=d.insert(l,h),a.Vu[a.currentUser.toKey()]=d})(s,r.batchId,t),await vs(s,r.changes),await kr(s.remoteStore)}catch(r){const o=Po(r,"Failed to persist write");t.reject(o)}}async function Eh(n,e){const t=B(n);try{const s=await T_(t.localStore,e);e.targetChanges.forEach(((r,o)=>{const a=t.Au.get(o);a&&(K(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?a.hu=!0:r.modifiedDocuments.size>0?K(a.hu,14607):r.removedDocuments.size>0&&(K(a.hu,42227),a.hu=!1))})),await vs(t,s,e)}catch(s){await bn(s)}}function al(n,e,t){const s=B(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.Tu.forEach(((o,a)=>{const l=a.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(a,l){const h=B(a);h.onlineState=l;let d=!1;h.queries.forEach(((p,_)=>{for(const E of _.Sa)E.va(l)&&(d=!0)})),d&&Co(h)})(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function mv(n,e,t){const s=B(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.Au.get(e),o=r&&r.key;if(o){let a=new Z(L.comparator);a=a.insert(o,_e.newNoDocument(o,U.min()));const l=H().add(o),h=new Sr(U.min(),new Map,new Z($),a,l);await Eh(s,h),s.du=s.du.remove(o),s.Au.delete(e),Vo(s)}else await zi(s.localStore,e,!1).then((()=>$i(s,e,t))).catch(bn)}async function gv(n,e){const t=B(n),s=e.batch.batchId;try{const r=await I_(t.localStore,e);Ih(t,s,null),wh(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await vs(t,r)}catch(r){await bn(r)}}async function yv(n,e,t){const s=B(n);try{const r=await(function(a,l){const h=B(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let p;return h.mutationQueue.lookupMutationBatch(d,l).next((_=>(K(_!==null,37113),p=_.keys(),h.mutationQueue.removeMutationBatch(d,_)))).next((()=>h.mutationQueue.performConsistencyCheck(d))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,l))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p))).next((()=>h.localDocuments.getDocuments(d,p)))}))})(s.localStore,e);Ih(s,e,t),wh(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await vs(s,r)}catch(r){await bn(r)}}function wh(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Ih(n,e,t){const s=B(n);let r=s.Vu[s.currentUser.toKey()];if(r){const o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function $i(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((s=>{n.Ru.containsKey(s)||Th(n,s)}))}function Th(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(To(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Vo(n))}function cl(n,e,t){for(const s of t)s instanceof _h?(n.Ru.addReference(s.key,e),_v(n,s)):s instanceof vh?(V(ko,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||Th(n,s.key)):F(19791,{wu:s})}function _v(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(V(ko,"New document in limbo: "+t),n.Eu.add(s),Vo(n))}function Vo(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new L(Y.fromString(e)),s=n.fu.next();n.Au.set(s,new av(t)),n.du=n.du.insert(t,s),dh(n.remoteStore,new pt(ze(mo(t.path)),s,"TargetPurposeLimboResolution",br.ce))}}async function vs(n,e,t){const s=B(n),r=[],o=[],a=[];s.Tu.isEmpty()||(s.Tu.forEach(((l,h)=>{a.push(s.pu(h,e,t).then((d=>{if((d||t)&&s.isPrimaryClient){const p=d?!d.fromCache:t?.targetChanges.get(h.targetId)?.current;s.sharedClientState.updateQueryState(h.targetId,p?"current":"not-current")}if(d){r.push(d);const p=wo.As(h.targetId,d);o.push(p)}})))})),await Promise.all(a),s.Pu.H_(r),await(async function(h,d){const p=B(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>R.forEach(d,(E=>R.forEach(E.Es,(A=>p.persistence.referenceDelegate.addReference(_,E.targetId,A))).next((()=>R.forEach(E.ds,(A=>p.persistence.referenceDelegate.removeReference(_,E.targetId,A)))))))))}catch(_){if(!En(_))throw _;V(Io,"Failed to update sequence numbers: "+_)}for(const _ of d){const E=_.targetId;if(!_.fromCache){const A=p.Ms.get(E),C=A.snapshotVersion,D=A.withLastLimboFreeSnapshotVersion(C);p.Ms=p.Ms.insert(E,D)}}})(s.localStore,o))}async function vv(n,e){const t=B(n);if(!t.currentUser.isEqual(e)){V(ko,"User change. New user:",e.toKey());const s=await ch(t.localStore,e);t.currentUser=e,(function(o,a){o.mu.forEach((l=>{l.forEach((h=>{h.reject(new N(S.CANCELLED,a))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await vs(t,s.Ls)}}function bv(n,e){const t=B(n),s=t.Au.get(e);if(s&&s.hu)return H().add(s.key);{let r=H();const o=t.Iu.get(e);if(!o)return r;for(const a of o){const l=t.Tu.get(a);r=r.unionWith(l.view.nu)}return r}}function xh(n){const e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Eh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=bv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=mv.bind(null,e),e.Pu.H_=nv.bind(null,e.eventManager),e.Pu.yu=sv.bind(null,e.eventManager),e}function Ev(n){const e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gv.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=yv.bind(null,e),e}class pr{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Pr(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return w_(this.persistence,new v_,e.initialUser,this.serializer)}Cu(e){return new ah(Eo.mi,this.serializer)}Du(e){return new P_}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}pr.provider={build:()=>new pr};class wv extends pr{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){K(this.persistence.referenceDelegate instanceof dr,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new r_(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ae.withCacheSize(this.cacheSizeBytes):Ae.DEFAULT;return new ah((s=>dr.mi(s,t)),this.serializer)}}class Hi{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>al(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=vv.bind(null,this.syncEngine),await X_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Z_})()}createDatastore(e){const t=Pr(e.databaseInfo.databaseId),s=(function(o){return new N_(o)})(e.databaseInfo);return(function(o,a,l,h){return new F_(o,a,l,h)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,r,o,a,l){return new B_(s,r,o,a,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>al(this.syncEngine,t,0)),(function(){return tl.v()?new tl:new C_})())}createSyncEngine(e,t){return(function(r,o,a,l,h,d,p){const _=new cv(r,o,a,l,h,d);return p&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const s=B(t);V(Wt,"RemoteStore shutting down."),s.Ea.add(5),await _s(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Hi.provider={build:()=>new Hi};class Iv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):tt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const xt="FirestoreClient";class Tv{constructor(e,t,s,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=ye.UNAUTHENTICATED,this.clientId=ao.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(s,(async a=>{V(xt,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(s,(a=>(V(xt,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Po(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function vi(n,e){n.asyncQueue.verifyOperationInProgress(),V(xt,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async r=>{s.isEqual(r)||(await ch(e.localStore,r),s=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function ll(n,e){n.asyncQueue.verifyOperationInProgress();const t=await xv(n);V(xt,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>sl(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,r)=>sl(e.remoteStore,r))),n._onlineComponents=e}async function xv(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V(xt,"Using user provided OfflineComponentProvider");try{await vi(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===S.FAILED_PRECONDITION||r.code===S.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;ln("Error using user provided cache. Falling back to memory cache: "+t),await vi(n,new pr)}}else V(xt,"Using default OfflineComponentProvider"),await vi(n,new wv(void 0));return n._offlineComponents}async function Ah(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(V(xt,"Using user provided OnlineComponentProvider"),await ll(n,n._uninitializedComponentsProvider._online)):(V(xt,"Using default OnlineComponentProvider"),await ll(n,new Hi))),n._onlineComponents}function Av(n){return Ah(n).then((e=>e.syncEngine))}async function Rv(n){const e=await Ah(n),t=e.eventManager;return t.onListen=lv.bind(null,e.syncEngine),t.onUnlisten=dv.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=uv.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=fv.bind(null,e.syncEngine),t}function Sv(n,e,t={}){const s=new vt;return n.asyncQueue.enqueueAndForget((async()=>(function(o,a,l,h,d){const p=new Iv({next:E=>{p.Nu(),a.enqueueAndForget((()=>tv(o,_)));const A=E.docs.has(l);!A&&E.fromCache?d.reject(new N(S.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&E.fromCache&&h&&h.source==="server"?d.reject(new N(S.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(E)},error:E=>d.reject(E)}),_=new rv(mo(l.path),p,{includeMetadataChanges:!0,qa:!0});return ev(o,_)})(await Rv(n),n.asyncQueue,e,t,s))),s.promise}function Rh(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const ul=new Map;const Sh="firestore.googleapis.com",hl=!0;class dl{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new N(S.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Sh,this.ssl=hl}else this.host=e.host,this.ssl=e.ssl??hl;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=oh;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<n_)throw new N(S.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Fg("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Rh(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new N(S.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new N(S.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new N(S.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,r){return s.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Do{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new N(S.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new N(S.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dl(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new Rg;switch(s.type){case"firstParty":return new kg(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new N(S.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=ul.get(t);s&&(V("ComponentProvider","Removing Datastore"),ul.delete(t),s.terminate())})(this),Promise.resolve()}}function Pv(n,e,t,s={}){n=Ht(n,Do);const r=mn(e),o=n._getSettings(),a={...o,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(Tl(`https://${l}`),xl("Firestore",!0)),o.host!==Sh&&o.host!==l&&ln("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...o,host:l,ssl:r,emulatorOptions:s};if(!zt(h,a)&&(n._setSettings(h),s.mockUserToken)){let d,p;if(typeof s.mockUserToken=="string")d=s.mockUserToken,p=ye.MOCK_USER;else{d=Ld(s.mockUserToken,n._app?.options.projectId);const _=s.mockUserToken.sub||s.mockUserToken.user_id;if(!_)throw new N(S.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new ye(_)}n._authCredentials=new Sg(new vu(d,p))}}class No{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new No(this.firestore,e,this._query)}}class oe{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ls(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new oe(this.firestore,e,this._key)}toJSON(){return{type:oe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(ms(t,oe._jsonSchema))return new oe(e,s||null,new L(Y.fromString(t.referencePath)))}}oe._jsonSchemaVersion="firestore/documentReference/1.0",oe._jsonSchema={type:se("string",oe._jsonSchemaVersion),referencePath:se("string")};class ls extends No{constructor(e,t,s){super(e,t,mo(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new oe(this.firestore,null,new L(e))}withConverter(e){return new ls(this.firestore,e,this._path)}}function Ph(n,e,...t){if(n=be(n),arguments.length===1&&(e=ao.newId()),Mg("doc","path",e),n instanceof Do){const s=Y.fromString(e,...t);return Ac(s),new oe(n,null,new L(s))}{if(!(n instanceof oe||n instanceof ls))throw new N(S.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Y.fromString(e,...t));return Ac(s),new oe(n.firestore,n instanceof ls?n.converter:null,new L(s))}}const fl="AsyncQueue";class pl{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new uh(this,"async_queue_retry"),this._c=()=>{const s=_i();s&&V(fl,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=_i();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=_i();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new vt;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!En(e))throw e;V(fl,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,tt("INTERNAL UNHANDLED ERROR: ",ml(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=So.createAndSchedule(this,e,t,s,(o=>this.hc(o)));return this.tc.push(r),r}uc(){this.nc&&F(47125,{Pc:ml(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function ml(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Vr extends Do{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new pl,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new pl(e),this._firestoreClient=void 0,await e}}}function Cv(n,e){const t=typeof n=="object"?n:Pl(),s=typeof n=="string"?n:or,r=Qi(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const o=Nd("firestore");o&&Pv(r,...o)}return r}function Ch(n){if(n._terminated)throw new N(S.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||kv(n),n._firestoreClient}function kv(n){const e=n._freezeSettings(),t=(function(r,o,a,l){return new Qg(r,o,a,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Rh(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Tv(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const o=r?._online.build();return{_offline:r?._offline.build(o),_online:o}})(n._componentsProvider))}class ke{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ke(pe.fromBase64String(e))}catch(t){throw new N(S.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ke(pe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ke._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ms(e,ke._jsonSchema))return ke.fromBase64String(e.bytes)}}ke._jsonSchemaVersion="firestore/bytes/1.0",ke._jsonSchema={type:se("string",ke._jsonSchemaVersion),bytes:se("string")};class Dr{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new N(S.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Nr{constructor(e){this._methodName=e}}class $e{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new N(S.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new N(S.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return $(this._lat,e._lat)||$(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:$e._jsonSchemaVersion}}static fromJSON(e){if(ms(e,$e._jsonSchema))return new $e(e.latitude,e.longitude)}}$e._jsonSchemaVersion="firestore/geoPoint/1.0",$e._jsonSchema={type:se("string",$e._jsonSchemaVersion),latitude:se("number"),longitude:se("number")};class He{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,r){if(s.length!==r.length)return!1;for(let o=0;o<s.length;++o)if(s[o]!==r[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:He._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ms(e,He._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new He(e.vectorValues);throw new N(S.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}He._jsonSchemaVersion="firestore/vectorValue/1.0",He._jsonSchema={type:se("string",He._jsonSchemaVersion),vectorValues:se("object")};const Vv=/^__.*__$/;class Dv{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new Ct(e,this.data,this.fieldMask,t,this.fieldTransforms):new gs(e,this.data,t,this.fieldTransforms)}}class kh{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new Ct(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Vh(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw F(40011,{Ac:n})}}class Oo{constructor(e,t,s,r,o,a){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Oo({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return mr(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Vh(this.Ac)&&Vv.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Nv{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Pr(e)}Cc(e,t,s,r=!1){return new Oo({Ac:e,methodName:t,Dc:s,path:fe.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Dh(n){const e=n._freezeSettings(),t=Pr(n._databaseId);return new Nv(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ov(n,e,t,s,r,o={}){const a=n.Cc(o.merge||o.mergeFields?2:0,e,t,r);Mo("Data must be an object, but it was:",a,s);const l=Nh(s,a);let h,d;if(o.merge)h=new Ce(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){const p=[];for(const _ of o.mergeFields){const E=Wi(e,_,t);if(!a.contains(E))throw new N(S.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);Lh(p,E)||p.push(E)}h=new Ce(p),d=a.fieldTransforms.filter((_=>h.covers(_.field)))}else h=null,d=a.fieldTransforms;return new Dv(new Re(l),h,d)}class Or extends Nr{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Or}}class Lo extends Nr{_toFieldTransform(e){return new wy(e.path,new os)}isEqual(e){return e instanceof Lo}}function Lv(n,e,t,s){const r=n.Cc(1,e,t);Mo("Data must be an object, but it was:",r,s);const o=[],a=Re.empty();Pt(s,((h,d)=>{const p=Fo(e,h,t);d=be(d);const _=r.yc(p);if(d instanceof Or)o.push(p);else{const E=Lr(d,_);E!=null&&(o.push(p),a.set(p,E))}}));const l=new Ce(o);return new kh(a,l,r.fieldTransforms)}function Mv(n,e,t,s,r,o){const a=n.Cc(1,e,t),l=[Wi(e,s,t)],h=[r];if(o.length%2!=0)throw new N(S.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<o.length;E+=2)l.push(Wi(e,o[E])),h.push(o[E+1]);const d=[],p=Re.empty();for(let E=l.length-1;E>=0;--E)if(!Lh(d,l[E])){const A=l[E];let C=h[E];C=be(C);const D=a.yc(A);if(C instanceof Or)d.push(A);else{const k=Lr(C,D);k!=null&&(d.push(A),p.set(A,k))}}const _=new Ce(d);return new kh(p,_,a.fieldTransforms)}function Lr(n,e){if(Oh(n=be(n)))return Mo("Unsupported field value:",e,n),Nh(n,e);if(n instanceof Nr)return(function(s,r){if(!Vh(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const o=s._toFieldTransform(r);o&&r.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,r){const o=[];let a=0;for(const l of s){let h=Lr(l,r.wc(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}})(n,e)}return(function(s,r){if((s=be(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return vy(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const o=X.fromDate(s);return{timestampValue:hr(r.serializer,o)}}if(s instanceof X){const o=new X(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:hr(r.serializer,o)}}if(s instanceof $e)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ke)return{bytesValue:Zu(r.serializer,s._byteString)};if(s instanceof oe){const o=r.databaseId,a=s.firestore._databaseId;if(!a.isEqual(o))throw r.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:vo(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof He)return(function(a,l){return{mapValue:{fields:{[Su]:{stringValue:Pu},[ar]:{arrayValue:{values:a.toArray().map((d=>{if(typeof d!="number")throw l.Sc("VectorValues must only contain numeric values.");return go(l.serializer,d)}))}}}}}})(s,r);throw r.Sc(`Unsupported field value: ${co(s)}`)})(n,e)}function Nh(n,e){const t={};return wu(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Pt(n,((s,r)=>{const o=Lr(r,e.mc(s));o!=null&&(t[s]=o)})),{mapValue:{fields:t}}}function Oh(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof X||n instanceof $e||n instanceof ke||n instanceof oe||n instanceof Nr||n instanceof He)}function Mo(n,e,t){if(!Oh(t)||!bu(t)){const s=co(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function Wi(n,e,t){if((e=be(e))instanceof Dr)return e._internalPath;if(typeof e=="string")return Fo(n,e);throw mr("Field path arguments must be of type string or ",n,!1,void 0,t)}const Fv=new RegExp("[~\\*/\\[\\]]");function Fo(n,e,t){if(e.search(Fv)>=0)throw mr(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Dr(...e.split("."))._internalPath}catch{throw mr(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function mr(n,e,t,s,r){const o=s&&!s.isEmpty(),a=r!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${s}`),a&&(h+=` in document ${r}`),h+=")"),new N(S.INVALID_ARGUMENT,l+n+h)}function Lh(n,e){return n.some((t=>t.isEqual(e)))}class Mh{constructor(e,t,s,r,o){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new oe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Uv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Fh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Uv extends Mh{data(){return super.data()}}function Fh(n,e){return typeof e=="string"?Fo(n,e):e instanceof Dr?e._internalPath:e._delegate._internalPath}class Bv{convertValue(e,t="none"){switch(It(e)){case 0:return null;case 1:return e.booleanValue;case 2:return te(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(wt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw F(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Pt(e,((r,o)=>{s[r]=this.convertValue(o,t)})),s}convertVectorValue(e){const t=e.fields?.[ar].arrayValue?.values?.map((s=>te(s.doubleValue)));return new He(t)}convertGeoPoint(e){return new $e(te(e.latitude),te(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=wr(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(ss(e));default:return null}}convertTimestamp(e){const t=Et(e);return new X(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Y.fromString(e);K(ih(s),9688,{name:e});const r=new rs(s.get(1),s.get(3)),o=new L(s.popFirst(5));return r.isEqual(t)||tt(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}function zv(n,e,t){let s;return s=n?n.toFirestore(e):e,s}class $n{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Bt extends Mh{constructor(e,t,s,r,o,a){super(e,t,s,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Js(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Fh("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new N(S.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Bt._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Bt._jsonSchemaVersion="firestore/documentSnapshot/1.0",Bt._jsonSchema={type:se("string",Bt._jsonSchemaVersion),bundleSource:se("string","DocumentSnapshot"),bundleName:se("string"),bundle:se("string")};class Js extends Bt{data(e={}){return super.data(e)}}class Yn{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new $n(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new Js(this._firestore,this._userDataWriter,s.key,s,new $n(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new N(S.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,o){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map((l=>{const h=new Js(r._firestore,r._userDataWriter,l.doc.key,l.doc,new $n(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}}))}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>o||l.type!==3)).map((l=>{const h=new Js(r._firestore,r._userDataWriter,l.doc.key,l.doc,new $n(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let d=-1,p=-1;return l.type!==0&&(d=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:jv(l.type),doc:h,oldIndex:d,newIndex:p}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new N(S.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Yn._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ao.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],r=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),s.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),r.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function jv(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return F(61501,{type:n})}}function Uh(n){n=Ht(n,oe);const e=Ht(n.firestore,Vr);return Sv(Ch(e),n._key).then((t=>Wv(e,n,t)))}Yn._jsonSchemaVersion="firestore/querySnapshot/1.0",Yn._jsonSchema={type:se("string",Yn._jsonSchemaVersion),bundleSource:se("string","QuerySnapshot"),bundleName:se("string"),bundle:se("string")};class qv extends Bv{constructor(e){super(),this.firestore=e}convertBytes(e){return new ke(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new oe(this.firestore,null,t)}}function $v(n,e,t){n=Ht(n,oe);const s=Ht(n.firestore,Vr),r=zv(n.converter,e);return Bh(s,[Ov(Dh(s),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,je.none())])}function Hv(n,e,t,...s){n=Ht(n,oe);const r=Ht(n.firestore,Vr),o=Dh(r);let a;return a=typeof(e=be(e))=="string"||e instanceof Dr?Mv(o,"updateDoc",n._key,e,t,s):Lv(o,"updateDoc",n._key,e),Bh(r,[a.toMutation(n._key,je.exists(!0))])}function Bh(n,e){return(function(s,r){const o=new vt;return s.asyncQueue.enqueueAndForget((async()=>pv(await Av(s),r,o))),o.promise})(Ch(n),e)}function Wv(n,e,t){const s=t.docs.get(e._key),r=new qv(n);return new Bt(n,r,e._key,s,new $n(t.hasPendingWrites,t.fromCache),e.converter)}function bi(){return new Lo("serverTimestamp")}(function(e,t=!0){(function(r){vn=r})(gn),cn(new jt("firestore",((s,{instanceIdentifier:r,options:o})=>{const a=s.getProvider("app").getImmediate(),l=new Vr(new Pg(s.getProvider("auth-internal")),new Vg(a,s.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new N(S.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new rs(d.options.projectId,p)})(a,r),a);return o={useFetchStreams:t,...o},l._setSettings(o),l}),"PUBLIC").setMultipleInstances(!0)),yt(wc,Ic,e),yt(wc,Ic,"esm2020")})();const Gv={apiKey:"",authDomain:"",projectId:"",storageBucket:"",messagingSenderId:"",appId:"",measurementId:""},zh=Sl(Gv),Qt=xg(zh),Uo=Cv(zh),Kv=new Ke,Bo=new Gn("apple.com");Bo.addScope("email");Bo.addScope("name");async function zo(n,e,t,s){const r=Ph(Uo,"users",n);(await Uh(r)).exists()?await Hv(r,{updatedAt:bi()}):await $v(r,{uid:n,email:e,name:t,provider:s,plan:"FREE",role:"USER",createdAt:bi(),updatedAt:bi()})}async function Mr(n){try{const e=Ph(Uo,"users",n),t=await Uh(e);return t.exists()?t.data():null}catch(e){return console.error("   :",e),null}}async function jh(n,e,t){const r=(await um(Qt,e,t)).user;return await zo(r.uid,e,n,"email"),console.log("  :",e),r}async function qh(n,e){const t=await hm(Qt,n,e);return console.log("  :",t.user.email),t.user}async function jo(){const e=(await uu(Qt,Kv)).user;return await zo(e.uid,e.email||"",e.displayName||"Google ","google"),console.log("Google  :",e.email),e}async function qo(){const e=(await uu(Qt,Bo)).user;return await zo(e.uid,e.email||"",e.displayName||"Apple ","apple"),console.log("Apple  :",e.uid),e}async function Qv(){await mm(Qt),console.log(" ")}function $h(n){return pm(Qt,n)}const Jv=Object.freeze(Object.defineProperty({__proto__:null,auth:Qt,db:Uo,getUserData:Mr,logOut:Qv,onAuthChange:$h,signInWithApple:qo,signInWithEmail:qh,signInWithGoogle:jo,signUpWithEmail:jh},Symbol.toStringTag,{value:"Module"})),Xv="modulepreload",Yv=function(n){return"/"+n},gl={},Zv=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let d=function(p){return Promise.all(p.map(_=>Promise.resolve(_).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};var a=d;document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),h=l?.nonce||l?.getAttribute("nonce");r=d(t.map(p=>{if(p=Yv(p),p in gl)return;gl[p]=!0;const _=p.endsWith(".css"),E=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${E}`))return;const A=document.createElement("link");if(A.rel=_?"stylesheet":Xv,_||(A.as="script"),A.crossOrigin="",A.href=p,h&&A.setAttribute("nonce",h),document.head.appendChild(A),_)return new Promise((C,D)=>{A.addEventListener("load",C),A.addEventListener("error",()=>D(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(l){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l}return r.then(l=>{for(const h of l||[])h.status==="rejected"&&o(h.reason);return e().catch(o)})};function eb(){const n=Ne.getState(),{isLoggedIn:e,userData:t}=n,s=e&&t&&(t.plan==="PRO"||t.plan==="B2B");return`
    <header class="fixed top-0 left-0 right-0 bg-zito-black text-white z-50">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!--  -->
                <div class="flex items-center">
                    <a href="/" data-link class="flex items-center">
                        <img src="/images/zito_logo_2.png" alt="Zito" class="h-8" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <span class="text-2xl font-bold italic hidden">Zito</span>
                    </a>
                </div>

                <!--   -  -->
                <div class="hidden md:flex items-center space-x-1">
                    <!--   -->
                    <div class="relative group">
                        <button class="flex items-center px-4 py-2 text-sm font-medium text-white hover:text-gray-300">
                            
                            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div class="absolute left-0 mt-0 w-32 bg-white rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
                            <a href="/plan/free" data-link class="block px-4 py-3 text-sm text-gray-700 hover:bg-gray-100"></a>
                            <a href="/plan/pro" data-link class="block px-4 py-3 text-sm text-gray-700 hover:bg-gray-100">PRO</a>
                            <a href="/plan/b2b" data-link class="block px-4 py-3 text-sm text-gray-700 hover:bg-gray-100">B2B</a>
                        </div>
                    </div>

                    <a href="/inquiry" data-link class="px-4 py-2 text-sm font-medium text-white hover:text-gray-300"></a>
                    <a href="/store" data-link class="px-4 py-2 text-sm font-medium text-white hover:text-gray-300 underline"></a>
                </div>

                <!-- /    -->
                <div class="hidden md:flex items-center space-x-4">
                    ${e?`
                        ${s?`
                            <a href="/dashboard" data-link class="px-4 py-2 text-sm font-medium text-white hover:text-gray-300"></a>
                        `:""}
                        <button id="logout-btn" class="px-4 py-2 text-sm font-medium text-white hover:text-gray-300"></button>
                    `:`
                        <a href="/login" data-link class="px-4 py-2 text-sm font-medium text-white hover:text-gray-300"></a>
                        <a href="/signup" data-link class="px-4 py-2 text-sm font-medium bg-white text-zito-black rounded-lg hover:bg-gray-200"></a>
                    `}
                </div>

                <!--    -->
                <div class="md:hidden">
                    <button id="mobile-menu-btn" class="p-2 text-white">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <!--   -->
            <div id="mobile-menu" class="hidden md:hidden pb-4">
                <div class="space-y-1">
                    <a href="/plan/free" data-link class="block px-4 py-2 text-white hover:bg-gray-800 rounded"></a>
                    <a href="/plan/pro" data-link class="block px-4 py-2 text-white hover:bg-gray-800 rounded">PRO</a>
                    <a href="/plan/b2b" data-link class="block px-4 py-2 text-white hover:bg-gray-800 rounded">B2B</a>
                    <a href="/inquiry" data-link class="block px-4 py-2 text-white hover:bg-gray-800 rounded"></a>
                    <a href="/store" data-link class="block px-4 py-2 text-white hover:bg-gray-800 rounded underline"></a>
                    <div class="border-t border-gray-700 my-2"></div>
                    ${e?`
                        ${s?`
                            <a href="/dashboard" data-link class="block px-4 py-2 text-white hover:bg-gray-800 rounded"></a>
                        `:""}
                        <button id="mobile-logout-btn" class="block w-full text-left px-4 py-2 text-white hover:bg-gray-800 rounded"></button>
                    `:`
                        <a href="/login" data-link class="block px-4 py-2 text-white hover:bg-gray-800 rounded"></a>
                        <a href="/signup" data-link class="block px-4 py-2 text-white hover:bg-gray-800 rounded"></a>
                    `}
                </div>
            </div>
        </nav>
    </header>
    `}function tb(){const n=document.getElementById("mobile-menu-btn"),e=document.getElementById("mobile-menu");n?.addEventListener("click",()=>{e?.classList.toggle("hidden")});const t=document.getElementById("logout-btn"),s=document.getElementById("mobile-logout-btn"),r=async()=>{const{logOut:o}=await Zv(async()=>{const{logOut:a}=await Promise.resolve().then(()=>Jv);return{logOut:a}},void 0);try{await o(),Ne.setState({user:null,userData:null,isLoggedIn:!1}),window.location.href="/"}catch(a){console.error(" :",a)}};t?.addEventListener("click",r),s?.addEventListener("click",r)}function nb(){return`
    <footer class="bg-zito-black text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <!--    -->
                <div class="col-span-1 md:col-span-2">
                    <img src="/images/zito_logo_2.png" alt="Zito" class="h-8 mb-4" onerror="this.outerHTML='<span class=\\'text-2xl font-bold italic\\'>Zito</span>'">
                    <p class="text-gray-400 text-sm">
                           .<br>
                        QR, NFC,    .
                    </p>
                </div>

                <!--  -->
                <div>
                    <h3 class="font-semibold mb-4"></h3>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="/plan/free" data-link class="hover:text-white"> </a></li>
                        <li><a href="/plan/pro" data-link class="hover:text-white">PRO </a></li>
                        <li><a href="/plan/b2b" data-link class="hover:text-white">B2B </a></li>
                        <li><a href="/store" data-link class="hover:text-white"></a></li>
                    </ul>
                </div>

                <!--  -->
                <div>
                    <h3 class="font-semibold mb-4"></h3>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="/inquiry" data-link class="hover:text-white"></a></li>
                        <li><a href="#" class="hover:text-white">  </a></li>
                        <li><a href="#" class="hover:text-white"></a></li>
                        <li><a href="#" class="hover:text-white"></a></li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-gray-800 mt-8 pt-8 text-center text-sm text-gray-400">
                <p>&copy; ${new Date().getFullYear()} Zito. All rights reserved.</p>
            </div>
        </div>
    </footer>
    `}function sb(){return`
    <main class="pt-16">
        <!--   -->
        <section class="bg-gradient-to-b from-gray-50 to-white py-20">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <h1 class="text-4xl md:text-5xl font-bold text-zito-black mb-6">
                         <br>
                         
                    </h1>
                    <p class="text-lg text-zito-gray mb-8 max-w-2xl mx-auto">
                        QR , NFC ,    <br>
                            .
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <a href="/signup" data-link class="px-8 py-4 bg-zito-black text-white font-semibold rounded-xl hover:bg-gray-800 transition">
                             
                        </a>
                        <a href="/plan/free" data-link class="px-8 py-4 border-2 border-zito-black text-zito-black font-semibold rounded-xl hover:bg-gray-100 transition">
                             
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!--   -->
        <section class="py-20">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl font-bold text-center mb-12"> Zito?</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="text-center p-6">
                        <div class="w-16 h-16 bg-zito-black rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-qrcode text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-2"> </h3>
                        <p class="text-zito-gray">QR, NFC,    .    !</p>
                    </div>
                    <div class="text-center p-6">
                        <div class="w-16 h-16 bg-zito-black rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-chart-line text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-2"> </h3>
                        <p class="text-zito-gray">      .</p>
                    </div>
                    <div class="text-center p-6">
                        <div class="w-16 h-16 bg-zito-black rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-building text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-2"> </h3>
                        <p class="text-zito-gray">      .</p>
                    </div>
                </div>
            </div>
        </section>

        <!--   -->
        <section class="bg-gray-50 py-20">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl font-bold text-center mb-12">   </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!--   -->
                    <div class="bg-white rounded-2xl p-8 shadow-lg">
                        <h3 class="text-xl font-semibold mb-2"></h3>
                        <p class="text-3xl font-bold mb-4">0<span class="text-lg font-normal text-zito-gray">/</span></p>
                        <ul class="space-y-3 mb-6 text-sm">
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> 1 </li>
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i>QR//NFC  </li>
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i>  </li>
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> </li>
                        </ul>
                        <a href="/plan/free" data-link class="block text-center py-3 border-2 border-zito-black text-zito-black font-semibold rounded-xl hover:bg-gray-100 transition">
                             
                        </a>
                    </div>

                    <!-- PRO  -->
                    <div class="bg-zito-black text-white rounded-2xl p-8 shadow-lg relative">
                        <div class="absolute top-0 right-0 bg-yellow-400 text-black text-xs font-bold px-3 py-1 rounded-bl-xl rounded-tr-xl"></div>
                        <h3 class="text-xl font-semibold mb-2">PRO</h3>
                        <p class="text-3xl font-bold mb-4">2,900<span class="text-lg font-normal text-gray-400">/</span></p>
                        <ul class="space-y-3 mb-6 text-sm">
                            <li class="flex items-center"><i class="fas fa-check text-green-400 mr-2"></i>  5</li>
                            <li class="flex items-center"><i class="fas fa-check text-green-400 mr-2"></i>/ </li>
                            <li class="flex items-center"><i class="fas fa-check text-green-400 mr-2"></i>  &  </li>
                            <li class="flex items-center"><i class="fas fa-check text-green-400 mr-2"></i>  </li>
                            <li class="flex items-center"><i class="fas fa-check text-green-400 mr-2"></i> </li>
                        </ul>
                        <a href="/plan/pro" data-link class="block text-center py-3 bg-white text-zito-black font-semibold rounded-xl hover:bg-gray-200 transition">
                             
                        </a>
                    </div>

                    <!-- B2B  -->
                    <div class="bg-white rounded-2xl p-8 shadow-lg">
                        <h3 class="text-xl font-semibold mb-2">B2B</h3>
                        <p class="text-3xl font-bold mb-4"><span class="text-lg font-normal text-zito-gray"> </span></p>
                        <ul class="space-y-3 mb-6 text-sm">
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i>  </li>
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i>   </li>
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> </li>
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i>CRM </li>
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> </li>
                        </ul>
                        <a href="/inquiry" data-link class="block text-center py-3 border-2 border-zito-black text-zito-black font-semibold rounded-xl hover:bg-gray-100 transition">
                             
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA  -->
        <section class="py-20">
            <div class="max-w-4xl mx-auto px-4 text-center">
                <h2 class="text-3xl font-bold mb-4">  </h2>
                <p class="text-zito-gray mb-8">     .</p>
                <a href="/signup" data-link class="inline-block px-8 py-4 bg-zito-black text-white font-semibold rounded-xl hover:bg-gray-800 transition">
                     
                </a>
            </div>
        </section>
    </main>
    `}function rb(){return`
    <main class="pt-16 min-h-screen bg-gray-50 flex items-center justify-center">
        <div class="bg-white rounded-2xl shadow-lg p-8 w-full max-w-md mx-4">
            <!--  -->
            <div class="text-center mb-8">
                <img src="/images/zito_logo_2.png" alt="Zito" class="h-12 mx-auto mb-4" onerror="this.outerHTML='<span class=\\'text-3xl font-bold italic\\'>Zito</span>'">
                <h1 class="text-2xl font-bold text-zito-black">  .</h1>
                <p class="text-zito-gray mt-2">   .</p>
            </div>

            <!--   -->
            <form id="login-form" class="space-y-4">
                <div>
                    <input 
                        type="email" 
                        id="login-email" 
                        placeholder="  "
                        class="w-full px-4 py-4 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition"
                        required
                    >
                </div>
                <div>
                    <input 
                        type="password" 
                        id="login-password" 
                        placeholder=""
                        class="w-full px-4 py-4 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition"
                        required
                    >
                </div>
                <button 
                    type="submit" 
                    id="login-submit-btn"
                    class="w-full py-4 bg-zito-black text-white font-semibold rounded-xl hover:bg-gray-800 transition flex items-center justify-center"
                >
                    <span id="login-btn-text"></span>
                    <div id="login-spinner" class="spinner ml-2 hidden"></div>
                </button>
            </form>

            <!--   -->
            <div id="login-error" class="hidden mt-4 p-3 bg-red-100 text-red-700 rounded-xl text-sm"></div>

            <!--    -->
            <div class="flex items-center my-6">
                <div class="flex-1 border-t border-gray-300"></div>
                <span class="px-4 text-sm text-zito-gray">SNS </span>
                <div class="flex-1 border-t border-gray-300"></div>
            </div>

            <!--    -->
            <div class="flex justify-center space-x-4">
                <!-- Apple  -->
                <button 
                    id="apple-login-btn"
                    class="w-14 h-14 bg-black rounded-full flex items-center justify-center hover:bg-gray-800 transition"
                    title="Apple "
                >
                    <i class="fab fa-apple text-white text-2xl"></i>
                </button>

                <!-- Google  -->
                <button 
                    id="google-login-btn"
                    class="w-14 h-14 bg-white border border-gray-200 rounded-full flex items-center justify-center hover:bg-gray-50 transition"
                    title="Google "
                >
                    <svg class="w-6 h-6" viewBox="0 0 24 24">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                </button>
            </div>

            <!--   -->
            <div class="text-center mt-8">
                <a href="/signup" data-link class="text-zito-black font-medium underline hover:text-gray-600">
                    
                </a>
            </div>
        </div>
    </main>
    `}function ib(){const n=document.getElementById("login-form"),e=document.getElementById("login-email"),t=document.getElementById("login-password"),s=document.getElementById("login-submit-btn"),r=document.getElementById("login-btn-text"),o=document.getElementById("login-spinner"),a=document.getElementById("login-error"),l=document.getElementById("google-login-btn"),h=document.getElementById("apple-login-btn"),d=A=>{a.textContent=A,a.classList.remove("hidden")},p=()=>{a.classList.add("hidden")},_=A=>{A?(r.textContent=" ...",o.classList.remove("hidden"),s.disabled=!0):(r.textContent="",o.classList.add("hidden"),s.disabled=!1)},E=async A=>{const C=await Mr(A.uid);Ne.setState({user:A,userData:C,isLoggedIn:!0,isLoading:!1}),ue.navigate("/")};n?.addEventListener("submit",async A=>{A.preventDefault(),p(),_(!0);try{const C=await qh(e.value,t.value);await E(C)}catch(C){console.error(" :",C);let D=" .";C.code==="auth/user-not-found"?D="  .":C.code==="auth/wrong-password"?D="  .":C.code==="auth/invalid-email"?D="   .":C.code==="auth/too-many-requests"&&(D="   .    ."),d(D)}finally{_(!1)}}),l?.addEventListener("click",async()=>{p();try{const A=await jo();await E(A)}catch(A){console.error("Google  :",A),A.code!=="auth/popup-closed-by-user"&&d("Google  .")}}),h?.addEventListener("click",async()=>{p();try{const A=await qo();await E(A)}catch(A){console.error("Apple  :",A),A.code!=="auth/popup-closed-by-user"&&d("Apple  .")}})}function ob(){return`
    <main class="pt-16 min-h-screen bg-gray-50 flex items-center justify-center py-12">
        <div class="bg-white rounded-2xl shadow-lg p-8 w-full max-w-md mx-4">
            <!--  -->
            <div class="text-center mb-8">
                <img src="/images/zito_logo_2.png" alt="Zito" class="h-12 mx-auto mb-4" onerror="this.outerHTML='<span class=\\'text-3xl font-bold italic\\'>Zito</span>'">
                <h1 class="text-2xl font-bold text-zito-black"></h1>
                <p class="text-zito-gray mt-2">   .</p>
            </div>

            <!--   -->
            <form id="signup-form" class="space-y-4">
                <div>
                    <input 
                        type="text" 
                        id="signup-name" 
                        placeholder=""
                        class="w-full px-4 py-4 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition"
                        required
                    >
                </div>
                <div>
                    <input 
                        type="email" 
                        id="signup-email" 
                        placeholder=""
                        class="w-full px-4 py-4 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition"
                        required
                    >
                </div>
                <div>
                    <input 
                        type="password" 
                        id="signup-password" 
                        placeholder=" (6 )"
                        class="w-full px-4 py-4 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition"
                        required
                        minlength="6"
                    >
                </div>
                <div>
                    <input 
                        type="password" 
                        id="signup-password-confirm" 
                        placeholder=" "
                        class="w-full px-4 py-4 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition"
                        required
                    >
                </div>
                <button 
                    type="submit" 
                    id="signup-submit-btn"
                    class="w-full py-4 bg-zito-black text-white font-semibold rounded-xl hover:bg-gray-800 transition flex items-center justify-center"
                >
                    <span id="signup-btn-text"></span>
                    <div id="signup-spinner" class="spinner ml-2 hidden"></div>
                </button>
            </form>

            <!--   -->
            <div id="signup-error" class="hidden mt-4 p-3 bg-red-100 text-red-700 rounded-xl text-sm"></div>

            <!--   -->
            <div id="signup-success" class="hidden mt-4 p-3 bg-green-100 text-green-700 rounded-xl text-sm"></div>

            <!--    -->
            <div class="flex items-center my-6">
                <div class="flex-1 border-t border-gray-300"></div>
                <span class="px-4 text-sm text-zito-gray">SNS </span>
                <div class="flex-1 border-t border-gray-300"></div>
            </div>

            <!--    -->
            <div class="flex justify-center space-x-4">
                <!-- Apple  -->
                <button 
                    id="apple-signup-btn"
                    class="w-14 h-14 bg-black rounded-full flex items-center justify-center hover:bg-gray-800 transition"
                    title="Apple "
                >
                    <i class="fab fa-apple text-white text-2xl"></i>
                </button>

                <!-- Google  -->
                <button 
                    id="google-signup-btn"
                    class="w-14 h-14 bg-white border border-gray-200 rounded-full flex items-center justify-center hover:bg-gray-50 transition"
                    title="Google "
                >
                    <svg class="w-6 h-6" viewBox="0 0 24 24">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                </button>
            </div>

            <!--   -->
            <div class="text-center mt-8">
                <span class="text-zito-gray">  ? </span>
                <a href="/login" data-link class="text-zito-black font-medium underline hover:text-gray-600">
                    
                </a>
            </div>
        </div>
    </main>
    `}function ab(){const n=document.getElementById("signup-form"),e=document.getElementById("signup-name"),t=document.getElementById("signup-email"),s=document.getElementById("signup-password"),r=document.getElementById("signup-password-confirm"),o=document.getElementById("signup-submit-btn"),a=document.getElementById("signup-btn-text"),l=document.getElementById("signup-spinner"),h=document.getElementById("signup-error"),d=document.getElementById("signup-success"),p=document.getElementById("google-signup-btn"),_=document.getElementById("apple-signup-btn"),E=O=>{h.textContent=O,h.classList.remove("hidden"),d.classList.add("hidden")},A=O=>{d.textContent=O,d.classList.remove("hidden"),h.classList.add("hidden")},C=()=>{h.classList.add("hidden"),d.classList.add("hidden")},D=O=>{O?(a.textContent=" ...",l.classList.remove("hidden"),o.disabled=!0):(a.textContent="",l.classList.add("hidden"),o.disabled=!1)},k=async O=>{const z=await Mr(O.uid);Ne.setState({user:O,userData:z,isLoggedIn:!0,isLoading:!1}),ue.navigate("/")};n?.addEventListener("submit",async O=>{if(O.preventDefault(),C(),!e.value.trim()){E(" .");return}if(!t.value.includes("@")){E("   .");return}if(s.value.length<6){E(" 6  .");return}if(s.value!==r.value){E("  .");return}D(!0);try{const z=await jh(e.value.trim(),t.value.trim(),s.value);A(" !"),setTimeout(()=>k(z),1e3)}catch(z){console.error(" :",z);let W=" .";z.code==="auth/email-already-in-use"?W="   .":z.code==="auth/invalid-email"?W="   .":z.code==="auth/weak-password"&&(W="  ."),E(W)}finally{D(!1)}}),p?.addEventListener("click",async()=>{C();try{const O=await jo();await k(O)}catch(O){console.error("Google  :",O),O.code!=="auth/popup-closed-by-user"&&E("Google  .")}}),_?.addEventListener("click",async()=>{C();try{const O=await qo();await k(O)}catch(O){console.error("Apple  :",O),O.code!=="auth/popup-closed-by-user"&&E("Apple  .")}})}function cb(){return`
    <main class="pt-16 min-h-screen">
        <!--  -->
        <section class="bg-gradient-to-b from-gray-50 to-white py-16">
            <div class="max-w-4xl mx-auto px-4 text-center">
                <span class="inline-block px-4 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium mb-4"> </span>
                <h1 class="text-4xl font-bold text-zito-black mb-4">  </h1>
                <p class="text-lg text-zito-gray mb-8">
                          .<br>
                       .
                </p>
                <div class="text-5xl font-bold text-zito-black mb-2">0</div>
                <p class="text-zito-gray"> </p>
            </div>
        </section>

        <!--   -->
        <section class="py-16">
            <div class="max-w-4xl mx-auto px-4">
                <h2 class="text-2xl font-bold text-center mb-12">   </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-id-card text-green-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1"> 1 </h3>
                            <p class="text-sm text-zito-gray"> , /, SNS ,  </p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-share-alt text-blue-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1"> </h3>
                            <p class="text-sm text-zito-gray">QR , , NFC()  </p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-chart-bar text-purple-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1"> </h3>
                            <p class="text-sm text-zito-gray">     </p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-address-book text-orange-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1"> </h3>
                            <p class="text-sm text-zito-gray">    </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!--   -->
        <section class="bg-gray-50 py-16">
            <div class="max-w-4xl mx-auto px-4">
                <h2 class="text-2xl font-bold text-center mb-8">Slice </h2>
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <p class="text-zito-gray mb-4">
                        Slice       (,   )      ,
                        <strong>" "   </strong>.
                    </p>
                    <p class="text-zito-black font-medium">
                        Zito <span class="text-green-600">"      "</span> .
                    </p>
                </div>
            </div>
        </section>

        <!-- CTA -->
        <section class="py-16">
            <div class="max-w-4xl mx-auto px-4 text-center">
                <h2 class="text-2xl font-bold mb-4">  </h2>
                <p class="text-zito-gray mb-8">     .</p>
                <a href="/signup" data-link class="inline-block px-8 py-4 bg-zito-black text-white font-semibold rounded-xl hover:bg-gray-800 transition">
                     
                </a>
            </div>
        </section>
    </main>
    `}function lb(){return`
    <main class="pt-16 min-h-screen">
        <!--  -->
        <section class="bg-gradient-to-b from-zito-black to-gray-800 py-16 text-white">
            <div class="max-w-4xl mx-auto px-4 text-center">
                <span class="inline-block px-4 py-1 bg-yellow-400 text-black rounded-full text-sm font-medium mb-4">PRO </span>
                <h1 class="text-4xl font-bold mb-4">  </h1>
                <p class="text-lg text-gray-300 mb-8">
                     ,  ,  .<br>
                    Slice     .
                </p>
                <div class="flex items-baseline justify-center gap-2 mb-2">
                    <span class="text-5xl font-bold">2,900</span>
                    <span class="text-gray-400">/</span>
                </div>
                <p class="text-gray-400 mb-4">   32,000/ ( 2 )</p>
                <a href="/signup" data-link class="inline-block px-8 py-4 bg-white text-zito-black font-semibold rounded-xl hover:bg-gray-200 transition">
                    PRO 
                </a>
            </div>
        </section>

        <!--   -->
        <section class="py-16">
            <div class="max-w-4xl mx-auto px-4">
                <h2 class="text-2xl font-bold text-center mb-12">PRO   </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-clone text-indigo-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1">  ( 5)</h3>
                            <p class="text-sm text-zito-gray">, ,     </p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-pink-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-palette text-pink-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1"> &  </h3>
                            <p class="text-sm text-zito-gray"> ,  , </p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-users text-green-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1"> </h3>
                            <p class="text-sm text-zito-gray">   , (, )</p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-bell text-yellow-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1"> </h3>
                            <p class="text-sm text-zito-gray">3   ,   </p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-chart-line text-blue-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1"> </h3>
                            <p class="text-sm text-zito-gray">  ,    </p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-ban text-red-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1"> </h3>
                            <p class="text-sm text-zito-gray">    </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!--   -->
        <section class="bg-gray-50 py-16">
            <div class="max-w-4xl mx-auto px-4">
                <h2 class="text-2xl font-bold text-center mb-8">Slice  50% </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white rounded-xl p-6 shadow-sm border-2 border-gray-200">
                        <h3 class="font-semibold text-zito-gray mb-4">Slice PRO</h3>
                        <div class="text-3xl font-bold text-zito-gray mb-2">~5,000<span class="text-lg font-normal">/</span></div>
                        <p class="text-sm text-zito-gray">  60,000</p>
                    </div>
                    <div class="bg-zito-black text-white rounded-xl p-6 shadow-sm">
                        <h3 class="font-semibold mb-4">Zito PRO</h3>
                        <div class="text-3xl font-bold mb-2">2,900<span class="text-lg font-normal">/</span></div>
                        <p class="text-sm text-gray-400"> 32,000 ( 47% )</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA -->
        <section class="py-16">
            <div class="max-w-4xl mx-auto px-4 text-center">
                <h2 class="text-2xl font-bold mb-4">  </h2>
                <p class="text-zito-gray mb-8">PRO     .</p>
                <a href="/signup" data-link class="inline-block px-8 py-4 bg-zito-black text-white font-semibold rounded-xl hover:bg-gray-800 transition">
                    PRO 
                </a>
            </div>
        </section>
    </main>
    `}function ub(){return`
    <main class="pt-16 min-h-screen">
        <!--  -->
        <section class="bg-gradient-to-b from-gray-900 to-gray-800 py-16 text-white">
            <div class="max-w-4xl mx-auto px-4 text-center">
                <span class="inline-block px-4 py-1 bg-blue-500 text-white rounded-full text-sm font-medium mb-4">B2B </span>
                <h1 class="text-4xl font-bold mb-4">   </h1>
                <p class="text-lg text-gray-300 mb-8">
                     ,    ,<br>
                    CRM   
                </p>
                <div class="flex items-baseline justify-center gap-2 mb-2">
                    <span class="text-4xl font-bold"> </span>
                </div>
                <p class="text-gray-400 mb-4">      </p>
                <a href="/inquiry" data-link class="inline-block px-8 py-4 bg-blue-500 text-white font-semibold rounded-xl hover:bg-blue-600 transition">
                     
                </a>
            </div>
        </section>

        <!--   -->
        <section class="py-16">
            <div class="max-w-4xl mx-auto px-4">
                <h2 class="text-2xl font-bold text-center mb-12">B2B   </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-building text-blue-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1">  </h3>
                            <p class="text-sm text-zito-gray">,  ,   </p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-users-cog text-green-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1">   </h3>
                            <p class="text-sm text-zito-gray">   </p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-globe text-purple-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1"> </h3>
                            <p class="text-sm text-zito-gray">card.company.com/  </p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-chart-pie text-orange-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1">/ </h3>
                            <p class="text-sm text-zito-gray">  ,   ,   </p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-pink-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-plug text-pink-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1">CRM </h3>
                            <p class="text-sm text-zito-gray">HubSpot, Notion DB, Google Sheets </p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-xl shadow-sm border border-gray-100">
                        <div class="w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-funnel-dollar text-indigo-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-1"> </h3>
                            <p class="text-sm text-zito-gray">    </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!--   -->
        <section class="bg-gray-50 py-16">
            <div class="max-w-4xl mx-auto px-4">
                <h2 class="text-2xl font-bold text-center mb-8">    </h2>
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <p class="text-zito-gray mb-4">
                        Slice       NFC     .
                          /   ,     CRM     .
                    </p>
                    <p class="text-zito-black font-medium">
                        Zito B2B <span class="text-blue-600">"    "</span> ,
                             .
                    </p>
                </div>
            </div>
        </section>

        <!-- CTA -->
        <section class="py-16">
            <div class="max-w-4xl mx-auto px-4 text-center">
                <h2 class="text-2xl font-bold mb-4">   </h2>
                <p class="text-zito-gray mb-8">       .</p>
                <a href="/inquiry" data-link class="inline-block px-8 py-4 bg-zito-black text-white font-semibold rounded-xl hover:bg-gray-800 transition">
                     
                </a>
            </div>
        </section>
    </main>
    `}function hb(){return`
    <main class="pt-16 min-h-screen bg-gray-50">
        <div class="max-w-4xl mx-auto px-4 py-16">
            <div class="text-center mb-12">
                <h1 class="text-3xl font-bold text-zito-black mb-4"> </h1>
                <p class="text-zito-gray">B2B    .<br>  .</p>
            </div>

            <div class="bg-white rounded-2xl shadow-lg p-8">
                <form id="inquiry-form" class="space-y-6">
                    <!--   -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-zito-black mb-2"> *</label>
                            <input 
                                type="text" 
                                id="inquiry-company" 
                                placeholder=" "
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition"
                                required
                            >
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-zito-black mb-2">  *</label>
                            <select 
                                id="inquiry-size" 
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition"
                                required
                            >
                                <option value=""></option>
                                <option value="1-10">1-10</option>
                                <option value="11-50">11-50</option>
                                <option value="51-200">51-200</option>
                                <option value="201-500">201-500</option>
                                <option value="500+">500 </option>
                            </select>
                        </div>
                    </div>

                    <!--   -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-zito-black mb-2">  *</label>
                            <input 
                                type="text" 
                                id="inquiry-name" 
                                placeholder=" "
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition"
                                required
                            >
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-zito-black mb-2"></label>
                            <input 
                                type="text" 
                                id="inquiry-position" 
                                placeholder=" "
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition"
                            >
                        </div>
                    </div>

                    <!--  -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-zito-black mb-2"> *</label>
                            <input 
                                type="email" 
                                id="inquiry-email" 
                                placeholder=" "
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition"
                                required
                            >
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-zito-black mb-2"></label>
                            <input 
                                type="tel" 
                                id="inquiry-phone" 
                                placeholder=" "
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition"
                            >
                        </div>
                    </div>

                    <!--   -->
                    <div>
                        <label class="block text-sm font-medium text-zito-black mb-2">   (  )</label>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                            <label class="flex items-center p-3 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition">
                                <input type="checkbox" name="features" value="branding" class="mr-2">
                                <span class="text-sm"> </span>
                            </label>
                            <label class="flex items-center p-3 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition">
                                <input type="checkbox" name="features" value="batch" class="mr-2">
                                <span class="text-sm">   </span>
                            </label>
                            <label class="flex items-center p-3 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition">
                                <input type="checkbox" name="features" value="domain" class="mr-2">
                                <span class="text-sm"> </span>
                            </label>
                            <label class="flex items-center p-3 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition">
                                <input type="checkbox" name="features" value="dashboard" class="mr-2">
                                <span class="text-sm"> </span>
                            </label>
                            <label class="flex items-center p-3 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition">
                                <input type="checkbox" name="features" value="crm" class="mr-2">
                                <span class="text-sm">CRM </span>
                            </label>
                            <label class="flex items-center p-3 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition">
                                <input type="checkbox" name="features" value="nfc" class="mr-2">
                                <span class="text-sm">NFC </span>
                            </label>
                        </div>
                    </div>

                    <!--   -->
                    <div>
                        <label class="block text-sm font-medium text-zito-black mb-2"> </label>
                        <textarea 
                            id="inquiry-message" 
                            rows="4"
                            placeholder="   "
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:border-zito-black transition resize-none"
                        ></textarea>
                    </div>

                    <!--   -->
                    <button 
                        type="submit" 
                        id="inquiry-submit-btn"
                        class="w-full py-4 bg-zito-black text-white font-semibold rounded-xl hover:bg-gray-800 transition flex items-center justify-center"
                    >
                        <span id="inquiry-btn-text"></span>
                        <div id="inquiry-spinner" class="spinner ml-2 hidden"></div>
                    </button>
                </form>

                <!--  -->
                <div id="inquiry-success" class="hidden mt-4 p-4 bg-green-100 text-green-700 rounded-xl text-center">
                    <i class="fas fa-check-circle text-2xl mb-2"></i>
                    <p class="font-medium"> !</p>
                    <p class="text-sm">  .</p>
                </div>
                <div id="inquiry-error" class="hidden mt-4 p-3 bg-red-100 text-red-700 rounded-xl text-sm"></div>
            </div>

            <!--   -->
            <div class="mt-12 grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white rounded-xl p-6 text-center shadow-sm">
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-envelope text-blue-600"></i>
                    </div>
                    <h3 class="font-semibold mb-1"></h3>
                    <p class="text-sm text-zito-gray">b2b@zito.com</p>
                </div>
                <div class="bg-white rounded-xl p-6 text-center shadow-sm">
                    <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-phone text-green-600"></i>
                    </div>
                    <h3 class="font-semibold mb-1"></h3>
                    <p class="text-sm text-zito-gray">02-1234-5678</p>
                </div>
                <div class="bg-white rounded-xl p-6 text-center shadow-sm">
                    <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-clock text-purple-600"></i>
                    </div>
                    <h3 class="font-semibold mb-1"> </h3>
                    <p class="text-sm text-zito-gray"> 09:00 - 18:00</p>
                </div>
            </div>
        </div>
    </main>
    `}function db(){const n=document.getElementById("inquiry-form"),e=document.getElementById("inquiry-submit-btn"),t=document.getElementById("inquiry-btn-text"),s=document.getElementById("inquiry-spinner"),r=document.getElementById("inquiry-success"),o=document.getElementById("inquiry-error"),a=l=>{l?(t.textContent=" ...",s.classList.remove("hidden"),e.disabled=!0):(t.textContent="",s.classList.add("hidden"),e.disabled=!1)};n?.addEventListener("submit",async l=>{l.preventDefault(),a(!0),o.classList.add("hidden");const h={company:document.getElementById("inquiry-company").value,size:document.getElementById("inquiry-size").value,name:document.getElementById("inquiry-name").value,position:document.getElementById("inquiry-position").value,email:document.getElementById("inquiry-email").value,phone:document.getElementById("inquiry-phone").value,features:Array.from(document.querySelectorAll('input[name="features"]:checked')).map(d=>d.value),message:document.getElementById("inquiry-message").value};try{console.log(" :",h),await new Promise(d=>setTimeout(d,1e3)),n.classList.add("hidden"),r.classList.remove("hidden")}catch(d){console.error("  :",d),o.textContent="  .  .",o.classList.remove("hidden")}finally{a(!1)}})}function fb(){return`
    <main class="pt-16 min-h-screen">
        <!--  -->
        <section class="bg-gradient-to-b from-gray-50 to-white py-16">
            <div class="max-w-4xl mx-auto px-4 text-center">
                <h1 class="text-3xl font-bold text-zito-black mb-4">Zito </h1>
                <p class="text-lg text-zito-gray">NFC      </p>
            </div>
        </section>

        <!--   -->
        <section class="py-16">
            <div class="max-w-6xl mx-auto px-4">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- NFC  -  -->
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden group">
                        <div class="aspect-square bg-gray-100 flex items-center justify-center group-hover:bg-gray-200 transition">
                            <div class="w-48 h-32 bg-zito-black rounded-xl flex items-center justify-center shadow-lg">
                                <span class="text-white font-bold italic text-xl">Zito</span>
                            </div>
                        </div>
                        <div class="p-6">
                            <span class="text-xs text-blue-600 font-medium">NFC </span>
                            <h3 class="text-lg font-semibold mt-1 mb-2">Zito Card - </h3>
                            <p class="text-sm text-zito-gray mb-4">  ,   </p>
                            <div class="flex items-center justify-between">
                                <span class="text-xl font-bold">15,000</span>
                                <button class="px-4 py-2 bg-zito-black text-white text-sm font-medium rounded-lg hover:bg-gray-800 transition">
                                    
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- NFC  -  -->
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden group relative">
                        <div class="absolute top-4 right-4 bg-yellow-400 text-black text-xs font-bold px-2 py-1 rounded"></div>
                        <div class="aspect-square bg-gray-100 flex items-center justify-center group-hover:bg-gray-200 transition">
                            <div class="w-48 h-32 bg-gradient-to-br from-gray-700 to-gray-900 rounded-xl flex items-center justify-center shadow-lg">
                                <span class="text-white font-bold italic text-xl">Zito</span>
                            </div>
                        </div>
                        <div class="p-6">
                            <span class="text-xs text-blue-600 font-medium">NFC </span>
                            <h3 class="text-lg font-semibold mt-1 mb-2">Zito Card - </h3>
                            <p class="text-sm text-zito-gray mb-4"> ,  / </p>
                            <div class="flex items-center justify-between">
                                <span class="text-xl font-bold">35,000</span>
                                <button class="px-4 py-2 bg-zito-black text-white text-sm font-medium rounded-lg hover:bg-gray-800 transition">
                                    
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- NFC  -  -->
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden group">
                        <div class="aspect-square bg-gray-100 flex items-center justify-center group-hover:bg-gray-200 transition">
                            <div class="w-48 h-32 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-xl flex items-center justify-center shadow-lg">
                                <span class="text-white font-bold italic text-xl drop-shadow">Zito</span>
                            </div>
                        </div>
                        <div class="p-6">
                            <span class="text-xs text-blue-600 font-medium">NFC </span>
                            <h3 class="text-lg font-semibold mt-1 mb-2">Zito Card - </h3>
                            <p class="text-sm text-zito-gray mb-4">24K  , VIP </p>
                            <div class="flex items-center justify-between">
                                <span class="text-xl font-bold">59,000</span>
                                <button class="px-4 py-2 bg-zito-black text-white text-sm font-medium rounded-lg hover:bg-gray-800 transition">
                                    
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- NFC  -->
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden group">
                        <div class="aspect-square bg-gray-100 flex items-center justify-center group-hover:bg-gray-200 transition">
                            <div class="w-24 h-24 bg-white border-4 border-zito-black rounded-full flex items-center justify-center shadow">
                                <i class="fas fa-wifi text-zito-black text-2xl transform rotate-45"></i>
                            </div>
                        </div>
                        <div class="p-6">
                            <span class="text-xs text-green-600 font-medium">NFC </span>
                            <h3 class="text-lg font-semibold mt-1 mb-2">Zito Sticker (5)</h3>
                            <p class="text-sm text-zito-gray mb-4">   NFC </p>
                            <div class="flex items-center justify-between">
                                <span class="text-xl font-bold">12,000</span>
                                <button class="px-4 py-2 bg-zito-black text-white text-sm font-medium rounded-lg hover:bg-gray-800 transition">
                                    
                                </button>
                            </div>
                        </div>
                    </div>

                    <!--   -->
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden group">
                        <div class="aspect-square bg-gray-100 flex items-center justify-center group-hover:bg-gray-200 transition">
                            <div class="w-40 h-48 bg-zito-black rounded-xl flex items-end justify-center pb-8 shadow-lg">
                                <div class="w-32 h-20 bg-gray-300 rounded-lg"></div>
                            </div>
                        </div>
                        <div class="p-6">
                            <span class="text-xs text-purple-600 font-medium"></span>
                            <h3 class="text-lg font-semibold mt-1 mb-2">Zito  </h3>
                            <p class="text-sm text-zito-gray mb-4"> ,    </p>
                            <div class="flex items-center justify-between">
                                <span class="text-xl font-bold">25,000</span>
                                <button class="px-4 py-2 bg-zito-black text-white text-sm font-medium rounded-lg hover:bg-gray-800 transition">
                                    
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- B2B  -->
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden group">
                        <div class="aspect-square bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center group-hover:opacity-90 transition">
                            <div class="text-center text-white">
                                <i class="fas fa-building text-5xl mb-4"></i>
                                <p class="font-semibold">  </p>
                            </div>
                        </div>
                        <div class="p-6">
                            <span class="text-xs text-orange-600 font-medium">B2B</span>
                            <h3 class="text-lg font-semibold mt-1 mb-2">   </h3>
                            <p class="text-sm text-zito-gray mb-4">50     </p>
                            <div class="flex items-center justify-between">
                                <span class="text-xl font-bold"> </span>
                                <a href="/inquiry" data-link class="px-4 py-2 bg-zito-black text-white text-sm font-medium rounded-lg hover:bg-gray-800 transition">
                                    
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- NFC  -->
        <section class="bg-gray-50 py-16">
            <div class="max-w-4xl mx-auto px-4">
                <h2 class="text-2xl font-bold text-center mb-12">NFC  </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-zito-black rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-xl font-bold">1</span>
                        </div>
                        <h3 class="font-semibold mb-2"> </h3>
                        <p class="text-sm text-zito-gray">Zito  NFC    </p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-zito-black rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-xl font-bold">2</span>
                        </div>
                        <h3 class="font-semibold mb-2"></h3>
                        <p class="text-sm text-zito-gray">    </p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-zito-black rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-xl font-bold">3</span>
                        </div>
                        <h3 class="font-semibold mb-2"> </h3>
                        <p class="text-sm text-zito-gray">      </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- FAQ -->
        <section class="py-16">
            <div class="max-w-4xl mx-auto px-4">
                <h2 class="text-2xl font-bold text-center mb-12">  </h2>
                <div class="space-y-4">
                    <div class="bg-white rounded-xl p-6 shadow-sm">
                        <h3 class="font-semibold mb-2">NFC    ?</h3>
                        <p class="text-sm text-zito-gray">!            .</p>
                    </div>
                    <div class="bg-white rounded-xl p-6 shadow-sm">
                        <h3 class="font-semibold mb-2">  ?</h3>
                        <p class="text-sm text-zito-gray">      .   .</p>
                    </div>
                    <div class="bg-white rounded-xl p-6 shadow-sm">
                        <h3 class="font-semibold mb-2">     ?</h3>
                        <p class="text-sm text-zito-gray">!         .</p>
                    </div>
                    <div class="bg-white rounded-xl p-6 shadow-sm">
                        <h3 class="font-semibold mb-2">  ?</h3>
                        <p class="text-sm text-zito-gray">    3-5  .    5-7 .</p>
                    </div>
                </div>
            </div>
        </section>
    </main>
    `}function pb(){const n=Ne.getState(),{userData:e}=n;if(!e||e.plan!=="PRO"&&e.plan!=="B2B")return`
        <main class="pt-16 min-h-screen bg-gray-50 flex items-center justify-center">
            <div class="text-center px-4">
                <div class="w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-lock text-red-500 text-3xl"></i>
                </div>
                <h1 class="text-2xl font-bold text-zito-black mb-4">  </h1>
                <p class="text-zito-gray mb-8"> PRO  B2B     .</p>
                <a href="/plan/pro" data-link class="inline-block px-8 py-4 bg-zito-black text-white font-semibold rounded-xl hover:bg-gray-800 transition">
                    PRO  
                </a>
            </div>
        </main>
        `;const t=e.plan==="PRO",s=e.plan==="B2B";return`
    <main class="pt-16 min-h-screen bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 py-8">
            <!--  -->
            <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-8">
                <div>
                    <h1 class="text-2xl font-bold text-zito-black"></h1>
                    <p class="text-zito-gray">, ${e.name}!</p>
                </div>
                <div class="mt-4 md:mt-0">
                    <span class="inline-block px-4 py-2 ${s?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"} rounded-full text-sm font-medium">
                        ${e.plan} 
                    </span>
                </div>
            </div>

            <!--   -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                            <i class="fas fa-eye text-blue-600"></i>
                        </div>
                        <span class="text-green-500 text-sm font-medium">+12%</span>
                    </div>
                    <h3 class="text-2xl font-bold">1,234</h3>
                    <p class="text-sm text-zito-gray">  </p>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                            <i class="fas fa-exchange-alt text-green-600"></i>
                        </div>
                        <span class="text-green-500 text-sm font-medium">+8%</span>
                    </div>
                    <h3 class="text-2xl font-bold">56</h3>
                    <p class="text-sm text-zito-gray"> </p>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center">
                            <i class="fas fa-mouse-pointer text-purple-600"></i>
                        </div>
                        <span class="text-red-500 text-sm font-medium">-3%</span>
                    </div>
                    <h3 class="text-2xl font-bold">89</h3>
                    <p class="text-sm text-zito-gray"> </p>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center">
                            <i class="fas fa-address-book text-orange-600"></i>
                        </div>
                        <span class="text-green-500 text-sm font-medium">+5</span>
                    </div>
                    <h3 class="text-2xl font-bold">127</h3>
                    <p class="text-sm text-zito-gray"></p>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!--   -->
                <div class="lg:col-span-2 bg-white rounded-xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-lg font-semibold"> </h2>
                        ${t||s?`
                            <button class="px-4 py-2 bg-zito-black text-white text-sm font-medium rounded-lg hover:bg-gray-800 transition">
                                <i class="fas fa-plus mr-1"></i>  
                            </button>
                        `:""}
                    </div>
                    <div class="space-y-4">
                        <!--  1 -->
                        <div class="flex items-center p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition cursor-pointer">
                            <div class="w-16 h-16 bg-zito-black rounded-lg flex items-center justify-center mr-4">
                                <span class="text-white font-bold">Z</span>
                            </div>
                            <div class="flex-1">
                                <h3 class="font-semibold">${e.name}</h3>
                                <p class="text-sm text-zito-gray">${e.email}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-medium">243 </p>
                                <p class="text-xs text-zito-gray"> </p>
                            </div>
                        </div>
                        ${t||s?`
                            <!--  2 -->
                            <div class="flex items-center p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition cursor-pointer">
                                <div class="w-16 h-16 bg-blue-600 rounded-lg flex items-center justify-center mr-4">
                                    <span class="text-white font-bold">F</span>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold"> </h3>
                                    <p class="text-sm text-zito-gray"> </p>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm font-medium">87 </p>
                                    <p class="text-xs text-zito-gray"> </p>
                                </div>
                            </div>
                        `:""}
                    </div>
                </div>

                <!--   -->
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <h2 class="text-lg font-semibold mb-6"> </h2>
                    <div class="space-y-4">
                        <div class="flex items-center p-3 bg-yellow-50 rounded-lg">
                            <div class="w-10 h-10 bg-yellow-200 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-bell text-yellow-600"></i>
                            </div>
                            <div class="flex-1">
                                <p class="text-sm font-medium"> </p>
                                <p class="text-xs text-zito-gray">3   </p>
                            </div>
                        </div>
                        <div class="flex items-center p-3 bg-blue-50 rounded-lg">
                            <div class="w-10 h-10 bg-blue-200 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-user text-blue-600"></i>
                            </div>
                            <div class="flex-1">
                                <p class="text-sm font-medium">  </p>
                                <p class="text-xs text-zito-gray">  3</p>
                            </div>
                        </div>
                        <div class="flex items-center p-3 bg-green-50 rounded-lg">
                            <div class="w-10 h-10 bg-green-200 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-check text-green-600"></i>
                            </div>
                            <div class="flex-1">
                                <p class="text-sm font-medium">  </p>
                                <p class="text-xs text-zito-gray"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            ${s?`
            <!-- B2B   -->
            <div class="mt-6 bg-white rounded-xl p-6 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-lg font-semibold"> </h2>
                    <button class="px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg hover:bg-gray-50 transition">
                         
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-gray-200">
                                <th class="text-left py-3 px-4 text-sm font-medium text-zito-gray"></th>
                                <th class="text-left py-3 px-4 text-sm font-medium text-zito-gray"></th>
                                <th class="text-right py-3 px-4 text-sm font-medium text-zito-gray"> </th>
                                <th class="text-right py-3 px-4 text-sm font-medium text-zito-gray"></th>
                                <th class="text-right py-3 px-4 text-sm font-medium text-zito-gray"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-4">
                                    <div class="flex items-center">
                                        <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-2">
                                            <span class="text-blue-600 text-xs font-medium"></span>
                                        </div>
                                        <span class="font-medium"></span>
                                    </div>
                                </td>
                                <td class="py-3 px-4 text-sm text-zito-gray"></td>
                                <td class="py-3 px-4 text-right font-medium">523</td>
                                <td class="py-3 px-4 text-right font-medium">45</td>
                                <td class="py-3 px-4 text-right font-medium text-green-600">12</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-4">
                                    <div class="flex items-center">
                                        <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-2">
                                            <span class="text-purple-600 text-xs font-medium"></span>
                                        </div>
                                        <span class="font-medium"></span>
                                    </div>
                                </td>
                                <td class="py-3 px-4 text-sm text-zito-gray"></td>
                                <td class="py-3 px-4 text-right font-medium">312</td>
                                <td class="py-3 px-4 text-right font-medium">28</td>
                                <td class="py-3 px-4 text-right font-medium text-green-600">8</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="py-3 px-4">
                                    <div class="flex items-center">
                                        <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-2">
                                            <span class="text-green-600 text-xs font-medium"></span>
                                        </div>
                                        <span class="font-medium"></span>
                                    </div>
                                </td>
                                <td class="py-3 px-4 text-sm text-zito-gray"></td>
                                <td class="py-3 px-4 text-right font-medium">189</td>
                                <td class="py-3 px-4 text-right font-medium">15</td>
                                <td class="py-3 px-4 text-right font-medium text-green-600">3</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            `:""}
        </div>
    </main>
    `}const Hh=document.getElementById("app");function Fe(n,e){Hh.innerHTML=`
        ${eb()}
        <div class="page-transition">
            ${n}
        </div>
        ${nb()}
    `,tb(),e&&e()}function mb(){Hh.innerHTML=`
        <div class="min-h-screen flex items-center justify-center">
            <div class="text-center">
                <div class="spinner mx-auto mb-4" style="width: 40px; height: 40px;"></div>
                <p class="text-zito-gray"> ...</p>
            </div>
        </div>
    `}function gb(){ue.addRoute("/",()=>{Fe(sb())}),ue.addRoute("/login",()=>{if(Ne.getState().isLoggedIn){ue.navigate("/");return}Fe(rb(),ib)}),ue.addRoute("/signup",()=>{if(Ne.getState().isLoggedIn){ue.navigate("/");return}Fe(ob(),ab)}),ue.addRoute("/plan/free",()=>{Fe(cb())}),ue.addRoute("/plan/pro",()=>{Fe(lb())}),ue.addRoute("/plan/b2b",()=>{Fe(ub())}),ue.addRoute("/inquiry",()=>{Fe(hb(),db)}),ue.addRoute("/store",()=>{Fe(fb())}),ue.addRoute("/dashboard",()=>{if(!Ne.getState().isLoggedIn){ue.navigate("/login");return}Fe(pb())}),ue.setDefault(()=>{Fe(`
            <main class="pt-16 min-h-screen flex items-center justify-center">
                <div class="text-center">
                    <h1 class="text-6xl font-bold text-zito-black mb-4">404</h1>
                    <p class="text-xl text-zito-gray mb-8">   </p>
                    <a href="/" data-link class="inline-block px-6 py-3 bg-zito-black text-white font-semibold rounded-xl hover:bg-gray-800 transition">
                         
                    </a>
                </div>
            </main>
        `)})}function yb(){mb(),$h(async n=>{if(n){const e=await Mr(n.uid);Ne.setState({user:n,userData:e,isLoggedIn:!0,isLoading:!1})}else Ne.setState({user:null,userData:null,isLoggedIn:!1,isLoading:!1});ue.handleRoute()})}Ne.subscribe(n=>{n.isLoading||ue.handleRoute()});function yl(){gb(),yb(),ue.init()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",yl):yl();
